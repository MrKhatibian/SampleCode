// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.33/esri/copyright.txt for details.
//>>built
require({cache:{"esri/dijit/geoenrichment/promise/all":function(){define(["dojo/promise/all"],function(h){return h})},"esri/dijit/geoenrichment/when":function(){define(["dojo/when"],function(h){return h})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/_CommandSupport":function(){define("require dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when ../PlayerCommands ./supportClasses/GEUtil esri/dijit/geoenrichment/ReportPlayer/config".split(" "),function(h,
f,e,d,c,b,a,g){var k={};return f(null,{_commands:null,_commandIndex:0,_initCommandsPromise:null,constructor:function(){this._commands={}},_initCommands:function(){var l=this;if(this._initCommandsPromise)return c(this._initCommandsPromise);var p=new d;if(g.modules.exportCommands)h(["./commands/CreateHTMLCommand","./commands/CreatePDFCommand","./commands/CreateImageCommand","./commands/PrintReportCommand","./commands/CreatePlayerCommand"],function(g,c,l,d,e){k[b.HTML]=g;k[b.PDF]=c;k[b.IMAGE]=l;k[b.PRINT]=
d;k[b.DYNAMIC_HTML]=e;a.getInitPromise().then(p.resolve)});else return p.resolve();p.promise.then(function(){l._initCommandsPromise=!0});return this._initCommandsPromise=p.promise},registerCommand:function(a,b,g){function c(g){if(!g.isBrowserSupported||g.isBrowserSupported())l._commands[a]||(l._commands[a]={index:l._commandIndex++,id:a,label:b||g.label,command:g})}var l=this;if(g)c(g);else return this._initCommands().then(function(){var b=k[a];b&&c(new b)})},getCommands:function(){return this._initCommands().then(function(){var g=
[],k=this._commands[b.PDF],d;for(d in this._commands)g.push(this._commands[d]);g.sort(function(a,b){return a.index-b.index});return(d=this._getCurrentContext())&&d.geoenrichmentUrl&&k?c(a.hasCapability("FormatInfographics"),function(a){a||(g=g.filter(function(a){return a!==k}));return g}):c(g)}.bind(this))},getCommandById:function(a){return this._commands[a]&&this._commands[a].command},executeCommand:function(a,b,g,c){return this._initCommands().then(function(){g=e.mixin({printMapTaskUrl:this.printMapTaskUrl},
g);return this._commands[a]&&this._commands[a].command&&this._commands[a].command.execute(b,g||{},c)}.bind(this))},executeCommandOnData:function(a,b,g,c){return this._initCommands().then(function(){g=e.mixin({printMapTaskUrl:this.printMapTaskUrl},g);return this._commands[a]&&this._commands[a].command&&this._commands[a].command.executeOnData(this,b,g||{},c)}.bind(this))}})})},"esri/dijit/geoenrichment/Deferred":function(){define(["dojo/Deferred"],function(h){return h})},"esri/dijit/geoenrichment/ReportPlayer/PlayerCommands":function(){define([],
function(){var h={HTML:"createHTML",PDF:"createPDF",PRINT:"print",DYNAMIC_HTML:"createDynamicHTML",IMAGE:"createImage",EXCEL:"exportToExcel",isSupported:function(f){for(var e in h)if(h[e]===f)return!0;return!1}};return h})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/GEUtil":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all dojox/uuid/generateRandomUuid esri/kernel esri/request esri/urlUtils esri/dijit/geoenrichment/utils/requests/FileContent esri/dijit/geoenrichment/utils/requests/UniversalClient esri/dijit/geoenrichment/utils/UrlUtil ./stdGeographies/StdGeographiesModel".split(" "),
function(h,f,e,d,c,b,a,g,k,l,p,n,m){function q(b){return y?y:(b=b&&a.id.findCredential(b)||a.id.credentials[0])&&b.token}function r(a,b){var g=k.urlToObject(a);b=f.mixin({f:"json",token:q(a),langCode:dojo.locale},g.query||{},b);for(var c in b)a=b[c],a instanceof l||a&&"object"===typeof a&&(b[c]=JSON.stringify("function"===typeof a.toJson?a.toJson():a));return{url:g.path,taskParams:b}}function t(a){z||(z=new w(v));return!a||z.initialized?z:z.initialize()}var w=h(null,{url:null,_geInfo:null,_capabilities:null,
_supportedOperations:null,constructor:function(a){this._capabilities={};this._supportedOperations={};this.url=a},_initDfd:null,initialized:!1,initialize:function(){var a=this;if(this._initDfd)return this._initDfd.promise;this._initDfd=new e;p.requestPublicFirst(r(this.url).url+"/Geoenrichment",{content:{f:"json"},handleAs:"json"},{retryOnAnyError:!0}).then(function(b){a.initWithJson(b)});return this._initDfd.promise},initWithJson:function(a){this._geInfo=a;this._capabilities={};this._supportedOperations=
{};a.capabilities&&a.capabilities.forEach(function(a){this._capabilities[a.toLowerCase()]=!0},this);a.supportedOperations&&a.supportedOperations.forEach(function(a){this._supportedOperations[a.toLowerCase()]=!0},this);this._initDfd=this._initDfd||new e;this._initDfd.resolve();this.initialized=!0},hasCapability:function(a){return!!this._capabilities[a.toLowerCase()]},addCapability:function(a){this._capabilities[a.toLowerCase()]=!0},supportsOperation:function(a){return!!this._supportedOperations[a.toLowerCase()]},
enrich:function(a){a=r(this.url,a);a.taskParams.AddDerivativeVariables="all";return g({url:a.url+"/Geoenrichment/Enrich",content:a.taskParams,handleAs:"json"}).then(function(a){return a.results[0].value.FeatureSet||[]})},stdGeographyQuery:function(a){a=r(this.url,a);return g({url:a.url+"/StandardGeographyQuery/execute",content:a.taskParams,handleAs:"json"}).then(function(a){return a.results[0].value.features||[]})},getDataCollections:function(a,b,c){c=r(this.url,c);return g({url:c.url+"/Geoenrichment/DataCollections/"+
a+(b?"/"+b:""),content:c.taskParams,handleAs:"json"}).then(function(a){return a.DataCollections})},_contriesCache:{},getCountries:function(){var a=r(this.url);return g({url:a.url+"/Geoenrichment/Countries",content:a.taskParams,handleAs:"json"}).then(function(a){return a.countries})},getCountryInfo:function(a){var b=this;if(!this._contriesCache[a]){var k=r(this.url);this._contriesCache[a]=g({url:k.url+"/Geoenrichment/Countries/"+a,content:k.taskParams,handleAs:"json"}).then(function(g){var k=g.countries[0],
l={};return c(k.hierarchies.map(function(g){return d(b._getStdGeographyModel(a,g.ID),function(a){l[g.ID]=a})})).then(function(){return{country:k,geographiesModels:l}})})}return this._contriesCache[a]},_stdModelCache:null,_getStdGeographyModel:function(a,b){this._stdModelCache=this._stdModelCache||{};var c=a+b;if(!this._stdModelCache[c]){var k=r(this.url);this._stdModelCache[c]=g({url:k.url+"/Geoenrichment/StandardGeographyLevels/"+a+"/"+b,content:k.taskParams,handleAs:"json"}).then(function(g){return new m({countryID:a,
hierarchyID:b,levels:g.geographyLevels[0].hierarchies[0].levels})})}return this._stdModelCache[c]},formatReport:function(a){a=r(this.url,a);return p.request({url:a.url,urlSuffix:"Geoenrichment/FormatReport"},{handleAs:"bin",content:a.taskParams}).then(function(a){return a&&a.data&&"text/plain"===a.data.type?null:a})},getReports:function(a){var b=r(this.url);return g({url:b.url+"/Geoenrichment/reports/"+a,content:b.taskParams,handleAs:"json"}).then(function(a){return a.reports})},_tasksHash:{},createReport:function(a){var g=
r(this.url,a),c=b();this._tasksHash[c]={taskName:"createReport",taskParams:f.clone(a)};return p.request({url:g.url,urlSuffix:"Geoenrichment/createReport"},{handleAs:"xml"===a.format?"text":"bin",content:g.taskParams}).then(function(a){return{taskID:c,result:a}})},consumeCredits:function(a){if(a=this._tasksHash[a])return a=f.clone(a),delete a.taskParams.forStorage,this[a.taskName](a.taskParams)},_dataLayersCache:{},getLayerInfos:function(a){this._dataLayersCache[a]||(this._dataLayersCache[a]=this._getLayerInfos(a));
return this._dataLayersCache[a]},_getLayerInfos:function(a){var b=r(this.url);return g({url:b.url+"/Geoenrichment/DataLayers/"+a,content:b.taskParams,handleAs:"json"}).then(function(a){return a&&a.layers||[]}).otherwise(function(a){console.log(a);return[]})},getLayerInfo:function(a,b){var g=a+"_"+b;this._dataLayersCache[g]||(this._dataLayersCache[g]=this._getLayerInfo(a,b));return this._dataLayersCache[g]},_getLayerInfo:function(a,b){var c=r(this.url);return g({url:c.url+"/Geoenrichment/DataLayers/"+
a+"/"+b,content:c.taskParams,handleAs:"json"}).then(function(a){return a&&a.layer}).otherwise(function(a){console.log(a);return null})}}),u={},v,y,A=new e;u.setGeoenrichmentUrl=function(a,b){(v=a||v)&&n.registerCORS(v);y=b||y;!A.promise.isFulfilled()&&A.resolve()};u.canMakeRequests=function(){return!!v};u.getInitPromise=function(){return A.promise};u.GEClient=w;var z;u.getClient=function(){return t()};u.initialize=function(){return t(!0)};u.initWithJson=function(a,b){u.setGeoenrichmentUrl(a);t().initWithJson(b)};
u.enrich=function(a){return t().enrich(a)};u.stdGeographyQuery=function(a){return t().stdGeographyQuery(a)};u.getDataCollections=function(a,b,g){return t().getDataCollections(a,b,g)};u.formatReport=function(a){return t().formatReport(a)};u.createReport=function(a){return t().createReport(a)};u.consumeCredits=function(a){return t().consumeCredits(a)};u.getLayerInfos=function(a){return t().getLayerInfos(a)};u.hasCapability=function(a){return d(t(!0),function(){return z&&z.hasCapability(a)})};u.addCapability=
function(a){return t().addCapability(a)};u.supportsOperation=function(a){return d(t(!0),function(){return z&&z.supportsOperation(a)})};u.getCountryInfo=function(a){return t().getCountryInfo(a)};return u})},"dojox/uuid/generateRandomUuid":function(){define(["./_base"],function(){dojox.uuid.generateRandomUuid=function(){function h(){for(var b=Math.floor(Math.random()%1*Math.pow(2,32)).toString(16);8>b.length;)b="0"+b;return b}var f=h(),e=h(),e=e.substring(0,4)+"-4"+e.substring(5,8),d=h(),d="8"+d.substring(1,
4)+"-"+d.substring(4,8),c=h();return(f+"-"+e+"-"+d+c).toLowerCase()};return dojox.uuid.generateRandomUuid})},"dojox/uuid/_base":function(){define(["dojo/_base/kernel","dojo/_base/lang"],function(h){h.getObject("uuid",!0,dojox);dojox.uuid.NIL_UUID="00000000-0000-0000-0000-000000000000";dojox.uuid.version={UNKNOWN:0,TIME_BASED:1,DCE_SECURITY:2,NAME_BASED_MD5:3,RANDOM:4,NAME_BASED_SHA1:5};dojox.uuid.variant={NCS:"0",DCE:"10",MICROSOFT:"110",UNKNOWN:"111"};dojox.uuid.assert=function(f,e){if(!f)throw e||
(e="An assert statement failed.\nThe method dojox.uuid.assert() was called with a 'false' value.\n"),Error(e);};dojox.uuid.generateNilUuid=function(){return dojox.uuid.NIL_UUID};dojox.uuid.isValid=function(f){f=f.toString();var e=h.isString(f)&&36==f.length&&f==f.toLowerCase();if(e){f=f.split("-");var e=5==f.length&&8==f[0].length&&4==f[1].length&&4==f[2].length&&4==f[3].length&&12==f[4].length,d;for(d in f)var c=parseInt(f[d],16),e=e&&isFinite(c)}return e};dojox.uuid.getVariant=function(f){if(!dojox.uuid._ourVariantLookupTable){var e=
dojox.uuid.variant,d=[];d[0]=e.NCS;d[1]=e.NCS;d[2]=e.NCS;d[3]=e.NCS;d[4]=e.NCS;d[5]=e.NCS;d[6]=e.NCS;d[7]=e.NCS;d[8]=e.DCE;d[9]=e.DCE;d[10]=e.DCE;d[11]=e.DCE;d[12]=e.MICROSOFT;d[13]=e.MICROSOFT;d[14]=e.UNKNOWN;d[15]=e.UNKNOWN;dojox.uuid._ourVariantLookupTable=d}f=f.toString();f=f.charAt(19);f=parseInt(f,16);dojox.uuid.assert(0<=f&&16>=f);return dojox.uuid._ourVariantLookupTable[f]};dojox.uuid.getVersion=function(f){dojox.uuid.assert(dojox.uuid.getVariant(f)==dojox.uuid.variant.DCE,"dojox.uuid.getVersion() was not passed a DCE Variant UUID.");
f=f.toString();f=f.charAt(14);return parseInt(f,16)};dojox.uuid.getNode=function(f){dojox.uuid.assert(dojox.uuid.getVersion(f)==dojox.uuid.version.TIME_BASED,"dojox.uuid.getNode() was not passed a TIME_BASED UUID.");f=f.toString();return f.split("-")[4]};dojox.uuid.getTimestamp=function(f,e){dojox.uuid.assert(dojox.uuid.getVersion(f)==dojox.uuid.version.TIME_BASED,"dojox.uuid.getTimestamp() was not passed a TIME_BASED UUID.");f=f.toString();e||(e=null);switch(e){case "string":case String:return dojox.uuid.getTimestamp(f,
Date).toUTCString();case "hex":var d=f.split("-");f=d[0];e=d[1];d=d[2];d=d.slice(1);f=d+e+f;dojox.uuid.assert(15==f.length);return f;case null:case "date":case Date:return d=f.split("-"),f=parseInt(d[0],16),e=parseInt(d[1],16),d=(parseInt(d[2],16)&4095)<<16,d=4294967296*(d+e),d+=f,new Date(d/1E4-122192928E5);default:dojox.uuid.assert(!1,"dojox.uuid.getTimestamp was not passed a valid returnType: "+e)}};return dojox.uuid})},"esri/dijit/geoenrichment/utils/requests/FileContent":function(){define(["dojo/_base/declare",
"esri/dijit/geoenrichment/utils/DataUtil"],function(h,f){function e(c){return c?/^image\//.test(c)?"base64":/^text\//.test(c)?"text":/application\/json/.test(c)?"json":"bin":"bin"}var d=h(null,{data:null,filename:null,contentType:"application/octet-stream",contentTransferEncoding:"binary",constructor:function(c,b,a){this.data=c;b&&(this.contentType=b);a&&(this.contentTransferEncoding=a)},getBase64Data:function(){return this.data?"base64"==this.contentTransferEncoding?this.data:f.base64FromByteSource(this.data):
null},toString:function(){return this.filename||"\x3cunknown\x3e"}});d.fromArrayBuffer=function(c,b){return new d(f.binaryStringFromByteSource(c),b)};d.fromBlob=function(c,b){return f.arrayBufferFromBlob(c).then(function(a){return new d(f.binaryStringFromByteSource(a),b||c.type)})};d.fromFileData=function(c,b,a){a=a||f.getContentType(c);if("object"==typeof b&&window.ArrayBuffer&&(b instanceof ArrayBuffer||b.buffer instanceof ArrayBuffer))b=f.binaryStringFromByteSource(b.buffer||b);else{var g=e(a);
"json"==g&&"object"==typeof b&&(b=JSON.stringify(b));if("string"!=typeof b)throw Error("Wrong file data.");switch(g){case "base64":b=atob(b);break;case "text":case "json":b=unescape(encodeURIComponent(b))}}b=new d(b,a);b.filename=c;return b};d.getContentConversionType=e;return d})},"esri/dijit/geoenrichment/utils/DataUtil":function(){define(["esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when"],function(h,f){function e(a){return"string"==typeof a?{source:a,getLength:function(){return this.source.length},
getByte:function(a){return this.source.charCodeAt(a)&255}}:window.ArrayBuffer&&a instanceof ArrayBuffer?{source:new Uint8Array(a),getLength:function(){return this.source.byteLength},getByte:function(a){return this.source[a]}}:a}function d(a){for(var b=a.length,c=new Uint8Array(a.length),l=0;l<b;l++)c[l]=a.charCodeAt(l);return c}function c(a,b){a=new Uint8Array(a);b=Math.min(b,a.byteLength);for(var g="",c=0;c<b;c++)g+=String.fromCharCode(a[c]);return g}var b={arrayBufferFromBlob:function(a){var b=
new h,c=new FileReader;c.onloadend=function(){c.error?b.reject(c.error):b.resolve(c.result)};c.readAsArrayBuffer(a);return b.promise},arrayBuffersToBlob:function(a,b){return new Blob(a,{type:b||"application/octet-stream"})},binaryStringFromByteSource:function(a){if("string"==typeof a)return a;a=e(a);for(var b=a.getLength(),c=b%4,b=b-c,l="",d=0,f,m,q,r;d<b;)f=a.getByte(d++),m=a.getByte(d++),q=a.getByte(d++),r=a.getByte(d++),l+=String.fromCharCode(f,m,q,r);1==c?l+=String.fromCharCode(a.getByte(d)):
2==c?l+=String.fromCharCode(a.getByte(d),a.getByte(d+1)):3==c&&(l+=String.fromCharCode(a.getByte(d),a.getByte(d+1),a.getByte(d+2)));return l},base64FromByteSource:function(a){a=e(a);for(var b=a.getLength(),c=b%3,b=b-c,l,d,f,m,q="",r=0;r<b;r+=3)m=a.getByte(r)<<16|a.getByte(r+1)<<8|a.getByte(r+2),l=m>>18&63,d=m>>12&63,f=m>>6&63,m&=63,q+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[l]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[f]+
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[m];1==c?(m=a.getByte(r),q+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[m>>2&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[m<<4&63]+"\x3d\x3d"):2==c&&(m=a.getByte(r)<<8|a.getByte(r+1),q+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[m>>10&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[m>>4&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[m<<
2&63]+"\x3d");return q},base64FromJson:function(a){return btoa(unescape(encodeURIComponent("string"===typeof a?a:JSON.stringify(a))))}};b.binaryStringToByteArray=d;b.base64ToByteArray=function(a){return d(atob(a))};b.getFirstBytes=function(a,b){var g;if("string"==typeof a)g=a.substr(0,b);else if(window.ArrayBuffer&&a instanceof ArrayBuffer)g=c(a,b);else if(window.Blob&&a instanceof Blob){g=new h;var l=new FileReader;l.onloadend=function(){l.error?g.resolve(""):g.resolve(c(l.result,b))};l.readAsArrayBuffer(a.slice(0,
b))}return f(g||"")};b.isBase64=function(a){return a&&0==a.length%4&&/^[ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+\/]+$/.test(a.replace(/={0,2}$/,""))};b.getContentType=function(a){a=b.getFileExtension(a);if(null===a)return null;switch(a){case "png":return"image/png";case "jpg":case "jpeg":return"image/jpeg";case "gif":return"image/gif";case "json":return"application/json";case "txt":return"text/plain";case "xml":return"text/xml";default:return null}};b.getFileExtension=function(a){var b=
a.lastIndexOf(".")+1;return b?a.substr(b).toLowerCase():null};return b})},"esri/dijit/geoenrichment/utils/requests/UniversalClient":function(){define("dojo/_base/lang esri/dijit/geoenrichment/Deferred dojo/request/xhr dojo/io-query dojo/sniff esri/dijit/geoenrichment/when esri/kernel esri/config esri/lang esri/urlUtils ../UrlUtil ./BinaryData ./FileContent ./MultipartDataBuilder ./ErrorUtil".split(" "),function(h,f,e,d,c,b,a,g,k,l,p,n,m,q,r){function t(a,b){if(b)this.reject(b);else{b=a.xhr;var g=
b.getResponseHeader&&b.getResponseHeader("Content-Type");a.status=b.status;a.data=new n(b.response||b.responseBody||b.responseText,g);this.resolve(a)}}var w=0,u=c("safari"),v=function(a){"string"===typeof a?this.url=a:"object"===typeof a&&h.mixin(this,a)};v.prototype={url:null,preventCache:null,usePost:!1,timeout:0,multipartThreshold:0,useCommonAuth:!1,useProxy:!1,allowSSL:null,send:function(a,b){return this.sendUrlRequest(this.prepareUrlRequest(a,b),"UniversalClient.send")},prepareUrlRequest:function(b,
c){"string"===typeof b?b={urlSuffix:b}:b||(b={});c||(c={});var e=b.url||this.url;b=b.urlSuffix;e||(e=b,b=null);if(!e)throw Error("URL is missing.");var f=l.urlToObject(e),e=p.combine(f.path,b);b=f.query||{};"object"===typeof c.content&&(b=h.mixin(b,c.content));f=c.requireSSL;!0!==f&&!1===this.allowSSL&&(f=!1);!1!==f&&!0===this.allowSSL&&/^https/i.test(window.location.protocol)&&(f=!0);if(a.id){var n=a.id.findCredential(e);!n&&this.useCommonAuth&&(n="string"==typeof this.useCommonAuth?a.id.findCredential(this.useCommonAuth):
a.id.credentials[0]);n&&(b.token||!1===b.token||(b.token=n.token),n.ssl&&!1!==f&&(f=!0))}!0===f&&(e=p.toHttpsUrl(e));!1===b.token&&delete b.token;var r=c.handleAs||"json";"json"===r&&(b.f="json");var n=(c.sendAs||(c.usePost||this.usePost||b.token?"post":"get")).toLowerCase(),f="multipart"==n?!0:c.sendAs||c.sizeLimit?!1:null,t=0,v;for(v in b){var y=b[v];if(y instanceof m)f=!0;else{var A=0,z=v.length;"object"===typeof y?c.allowMultipleValues&&Array.isArray(y)?b[v]=y.map(function(a){a="object"===typeof a?
JSON.stringify(a):a;A+=z+a+2;return a}):(b[v]=JSON.stringify(y),A+=z+b[v].length+2):A=z+(y?y.length:0)+2;!f&&0<this.multipartThreshold&&(t+=A)}}!1!==f&&0<this.multipartThreshold&&t>this.multipartThreshold&&(f=!0);if(c.useProxy||!l.hasSameOrigin(e,window.location.href)&&this.useProxy&&!c.hasOwnProperty("useProxy")){var H=p.getProxyUrl();H&&(e=H+"?"+e)}else l.getProxyRule(e)&&(e=l.getProxyRule(e).proxyUrl+"?"+e);v=(v=c.hasOwnProperty("preventCache")?c.preventCache:this.preventCache)||null===v&&H||u?
"_ts\x3d"+(new Date).getTime()+w++:"";H={handleAs:r};if(r=Number(k.isDefined(c.timeout)?c.timeout:this.timeout))H.timeout=r;r="get"!==n||f;n=f?null:d.objectToQuery(b);r||(r=n.length+e.length+v.length+1>=g.defaults.io.postLength);H.method=r?"POST":"GET";H.headers={"X-Requested-With":null};H.headers["Content-Type"]="undefined"!==typeof c.contentType?c.contentType:"application/x-www-form-urlencoded; charset\x3dutf-8";f?(f=new q,f.addVariables(b),f.build(H)):r?H.data=n:n&&(e+="?"+n,v&&(e+="\x26"+v),v=
null);!n&&v&&(e+="?"+v);return{url:e,options:H,sizeLimit:c.sizeLimit}},sendUrlRequest:function(a,c){var g="string"===typeof a.options.data?a.options.data.length:null;if(a.sizeLimit&&g&&("function"===typeof a.sizeLimit?a.sizeLimit(g):g>a.sizeLimit))return(new f).reject(Error("SIZE_LIMIT_EXCEEDED"));c=c||"UniversalClient.sendUrlRequest";var k=a.deferred||new f;if(g="bin"===a.options.handleAs)a.options.handleAs="blob";var l=e(a.url,a.options,!0);g&&(l.handleResponse=t);var d=this;l.then(function(g){g=
"json"===a.options.handleAs&&g&&r.parseError(g)||g;if(g instanceof Error){var l;!0===d.useCommonAuth&&498===g.code&&(l=v.handleInvalidTokenError(g));b(l)["finally"](function(){k.reject(g)})}else k.resolve(d._makeResponse(c,g))},function(a){k.reject(r.makeError(a))});return k.promise},requestToUrl:function(a){if(a.options.headers&&a.options.headers["Content-Type"]&&0==a.options.headers["Content-Type"].indexOf("multipart/form-data"))return null;var b=a.url;if(a=a.options.data){if(b.length+a.length>=
g.defaults.io.postLength)return null;b+="?"+a}return b},_makeResponse:function(a,b){return b}};v.makeError=r.makeError;v.handleInvalidTokenError=function(a){};var y=new v({useCommonAuth:!0,allowSSL:!0});v.request=function(a,b){return y.send(a,b).otherwise(function(g){var c=b&&b.content&&b.content.token;if(498!==g.code||null!=c)return(new f).reject(g);b=h.mixin({},b);b.content=h.mixin({},b.content);b.content.token=!1;return y.send(a,b)})};v.requestPublicFirst=function(a,b,g){var c=h.mixin({},b);c.content=
h.mixin({},b.content);c.content.token=!1;return y.send(a,c).otherwise(function(c){return g&&g.retryOnAnyError||499===c.code||403===c.code?y.send(a,b):(new f).reject(c)})};return v})},"esri/dijit/geoenrichment/utils/UrlUtil":function(){define(["dojo/_base/url","esri/config","esri/kernel","esri/urlUtils"],function(h,f,e,d){var c={getDomain:function(b){if("string"!==typeof b)return null;b=b.replace(/^(http:\/\/|https:\/\/)/i,"");var a=b.indexOf("/");return 0>a?b:b.substr(0,a)},getPortalUrl:function(b){if("string"!==
typeof b)return null;var a=b;b=b.replace(/^(http:\/\/|https:\/\/)/i,"");a=a.substr(0,a.indexOf(b));return-1!==b.indexOf("/sharing")?a+b.substr(0,b.indexOf("/sharing")):-1!==b.indexOf("/portal")?a+b.substr(0,b.indexOf("/portal"))+"/portal":-1!==b.indexOf("/home")&&b.indexOf("/home")==b.length-5?a+b.substr(0,b.indexOf("/home")):a+b},getProxyUrl:function(b){var a=f.defaults.io.proxyUrl;a&&!/^http/i.test(a)&&(a=d.getAbsoluteUrl(a));a&&b&&(a=c.toHttpsUrl(a));return a},registerCORS:function(b){(b=c.getDomain(b))&&
-1==f.defaults.io.corsEnabledServers.indexOf(b)&&f.defaults.io.corsEnabledServers.push(b);c._fixCORS()},_fixCORS:function(){f.defaults.io.corsEnabledServers=f.defaults.io.corsEnabledServers.filter(function(b){return b.indexOf&&0===b.indexOf("null://")?(console.log("WARNING: incorrect CORS URL detected: "+b),!1):!0})},indexOfQuery:function(b){var a=b.indexOf("?");0<=a&&(b=b.substr(a+1),/^(http:\/\/|https:\/\/)/i.test(b)&&(b=b.indexOf("?"),a=0<=b?a+1+b:-1));return a},removeQuery:function(b){var a=c.indexOfQuery(b);
return 0>a?b:b.substr(0,a)},addQueryPart:function(b,a){var g=0>c.indexOfQuery(b)?"?":"\x26";return b+g+a},getVariableValue:function(b,a){if(b&&"string"===typeof a){var g=d.urlToObject(b);if(g.query){var c={};Object.keys(g.query).forEach(function(a){c[a.toLowerCase()]=g.query[a]});return c[a.toLowerCase()]}}},addUrlVariable:function(b,a,g){a=encodeURIComponent(a);g=encodeURIComponent(g);return c.addQueryPart(b,a+"\x3d"+g)},securePortsMap:{80:"443",8080:"8443"},toHttpUrl:function(b){return!b||/^http/i.test(b)?
b:"http://"+b},toHttpsUrl:function(b){b&&(b=c.toHttpUrl(b));if(!b||!/^http:\/\//i.test(b))return b;var a=new h(b);b=b.replace(/^http/i,"https");var g=c.securePortsMap[a.port];g&&(b=b.replace(":"+a.port,":"+g));return b},combine:function(b,a){"number"===typeof a&&(a+="");if(a){if(/^(http:\/\/|https:\/\/)/i.test(a)||!b)return a;"/"!=a.charAt(0)&&(a="/"+a);if(1==a.length)return b;var g=b.length-1;"/"==b.charAt(g)&&(b=b.substr(0,g));var k=d.urlToObject(b);b=c.removeQuery(b);g=b.length-a.length;0<=g&&
b.substr(g).toLowerCase()==a.toLowerCase()&&(b=b.substr(0,g));b+=a;for(var l in k.query)c.addQueryPart(b,k.query[l])}return b},combineMulti:function(b){for(var a=b[0],g=1;g<b.length;g++)a=c.combine(a,b[g]);return a},openUrl:function(b,a){if(a)return window.open(b,"_blank");a=window.open();a.opener=null;a.referrer=null;a.location=b;return a},isPageRunOnWebService:function(){return/^http/i.test(window.location.protocol)},getToken:function(b){return(b=b&&e.id.findCredential(b)||e.id.credentials[0])&&
b.token}};return c})},"esri/dijit/geoenrichment/utils/requests/BinaryData":function(){define(["dojo/_base/declare"],function(h){return h(null,{data:null,type:null,constructor:function(f,e){this.type=e||f&&f.type||null;this.data=f}})})},"esri/dijit/geoenrichment/utils/requests/MultipartDataBuilder":function(){define(["dojo/_base/declare","dojo/request/util","esri/lang","./FileContent"],function(h,f,e,d){var c=h(null,{data:null,constructor:function(a){this.data=a}}),b=f.parseArgs;f.parseArgs=function(a,
k,l){k.data&&k.data instanceof c&&(k.data=k.data.data,l=!0);return b(a,k,l)};var a=f.deepCreate;f.deepCreate=function(b,k){return k instanceof c?new c(k.data):a(b,k)};return h(null,{addVariables:function(a){for(var b in a)this.addVariable(b,a[b])},addVariable:function(a,b){e.isDefined(b)&&(b instanceof d?this._writeFileContent(a,b):this._writeVariable(a,b.toString()))},build:function(a){this._writeBoundary(!0);a.data=new c(this._prepareBinaryData());var b=a.headers||{};b["Content-Type"]="multipart/form-data; boundary\x3d"+
this._dataProvider.boundary;a.headers=b;this._dataProvider=null},_prepareBinaryData:function(){var a=this._dataProvider.buffer;if(!window.Uint8Array)return a;for(var b=a.length,c=new Uint8Array(new ArrayBuffer(b)),d=0;d<b;d++)c[d]=a.charCodeAt(d);return c},_dataProvider:null,_getDataProvider:function(){if(!this._dataProvider){for(var a="",b=0;32>b;b++)a+=String.fromCharCode(Math.floor(97+25*Math.random()));this._dataProvider={buffer:"",boundary:a}}return this._dataProvider},_writeVariable:function(a,
b){this._writeBoundary();this._writeContentDisposition(a);this._writeLineBreak();this._writeData(this._toUTF8(b));this._writeLineBreak()},_writeFileContent:function(a,b){this._writeBoundary();this._writeContentDisposition(a,b.filename);b.contentType&&(this._writeData("Content-Type: "+b.contentType),this._writeLineBreak());b.contentTransferEncoding&&(this._writeData("Content-Transfer-Encoding: "+b.contentTransferEncoding),this._writeLineBreak());this._writeLineBreak();this._writeData(b.data);this._writeLineBreak()},
_writeBoundary:function(a){this._writeDoubleDash();this._writeData(this._getDataProvider().boundary);a?this._writeDoubleDash():this._writeLineBreak()},_writeContentDisposition:function(a,b){b=b?'"; filename\x3d"'+this._toUTF8(b.replace(/"/g,"'")):"";this._writeData('Content-Disposition: form-data; name\x3d"'+this._toUTF8(a)+b+'"');this._writeLineBreak()},_writeDoubleDash:function(){this._writeData("--")},_writeLineBreak:function(){this._writeData("\r\n")},_writeData:function(a){this._getDataProvider().buffer+=
a},_toUTF8:function(a){return unescape(encodeURIComponent(a))}})})},"esri/dijit/geoenrichment/utils/requests/ErrorUtil":function(){define(["esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when","require"],function(h,f,e){function d(b){var a=new h;e(["./DataResource"],function(c){f((new c(b)).getFileContent(),a.resolve,a.reject)});return a.promise}var c={getErrorFromBin:function(b){var a=/^text\/|^application\/json/;return b&&b.type&&!a.test(b.type)?null:f(b&&d(b),function(b){if(b){if(b.hasOwnProperty("contentType")&&
!a.test(b.contentType))return null;try{var g=JSON.parse(decodeURIComponent(escape(b.data))),l=c.parseError(g);if(l)return l;if(g.messages&&g.messages.length){var d=g.messages[0];if("esriJobMessageTypeError"==d.type)return Error(d.description)}}catch(n){}}return Error("Binary data error.")})},parseError:function(b){var a;b.error?a=c.makeError(b.error):"error"===b.status&&(a=c.makeError(b));a&&a.code&&null==a.httpCode&&(a.httpCode=a.code);return a},makeError:function(b){null==b?b=Error():"string"===
typeof b&&(b={message:b});if(!(b instanceof Error)&&"object"===typeof b){var a=b;b=Error();a.code&&(b.code=a.code);a.message&&(b.message=a.message);a.details&&(b.details=a.details)}b.log=dojoConfig.isDebug;return b}};return c})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/stdGeographies/StdGeographiesModel":function(){define(["dojo/_base/declare"],function(h){return h(null,{_levelsCache:null,_levels:null,constructor:function(f){this._initWithLevels(f.levels)},_initWithLevels:function(f){this._levels=
f;this._levelsCache={};this._levels.forEach(function(e){delete e.description;this._levelsCache[e.id]=e;e.adminLevel&&(this._levelsCache[e.adminLevel]=e)},this)},getLevels:function(f){return f?this._levels.filter(function(e){return!e.isWholeCountry}):this._levels.slice()},getLevel:function(f){return this._levelsCache[f]},getLevelPluralName:function(f){return(f=this.getLevel(f))?f.name||f.pluralName:null},toJson:function(){return{levels:this._levels}}})})},"esri/dijit/geoenrichment/ReportPlayer/config":function(){define(["esri/kernel"],
function(h){function f(e){e=e.split(".");return Number((Number(e[0])+Number(e[1])/100).toFixed(2))}h=Math.max(f("3.33"),f(h.version)).toFixed(2);return{jsapiVersion:h,esriDijitCssUrl:"https://js.arcgis.com/"+h+"/dijit/themes/claro/claro.css",esriCssUrl:"https://js.arcgis.com/"+h+"/esri/css/esri.css",playerSourceRootUrl:"https://js.arcgis.com/"+h+"/",configScriptText:null,env:"prod",isPlayerOnServer:!1,updateVariableInfoFromDataXml:!0,runReportTask:{cacheResult:!0,ignoreErrors:!0,secondAttempt:!0},
maps:{maxNumberOfMapsShownAtTheSameTime:6},charts:{showErrorIfHasUnavailableData:!1},tables:{leaveEmptyCellsUponError:!0,showUnavailableData:!0},createImageCommand:{skipSavingFile:!1},createPDFCommand:{skipSavingFile:!1},createPlayerCommand:{compressData:!1,prettifyDataJson:!1},exportToExcel:{skipSavingFile:!1},modules:{exportCommands:!0,complexCellTooltips:!0,paths:{panoramicViewer:null}},generalization:{factor:-1,maxVerticesInAllFeatures:1E5,numVerticesPerFeature:5E4}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/_SerializationSupport":function(){define("require dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all ./supportClasses/areas/AnalysisAreaJsonUtil ./supportClasses/areas/AnalysisAreaUtil ./supportClasses/PortalManager ../core/infographics/InfographicTypes ../core/supportClasses/templateJsonUtils/query/TemplateJsonQueryUtil esri/dijit/geoenrichment/ReportPlayer/countryConfig esri/dijit/geoenrichment/ReportPlayer/_devConfig".split(" "),
function(h,f,e,d,c,b,a,g,k,l,p,n,m){function q(){var a=new d;h("./supportClasses/attachments/AttachmentsStoreSerializer ./supportClasses/GEUtil ../core/supportClasses/templateJsonUtils/TemplateJsonSerializer ../core/supportClasses/templateJsonUtils/TemplateJsonAnalyzer ../core/infographics/utils/InfographicJsonUtil ../core/conversion/portalToEditorUtils/variables/PlayerVariableProvider ../core/infographics/InfographicTypes ./commands/mapToImage/MapToURLUtil esri/dijit/geoenrichment/utils/ProjectionUtil".split(" "),
function(b,c,g,k,d,m,e,q,p){r=b;t=c;w=g;u=d;v=m;l=e;y=q;A=p;a.resolve()});return a.promise}var r,t,w,u,v,y,A;return f(null,{reportDataToJson:function(b,g){var k=this;g=g||{};var d=!1;p.processTemplateFieldInfos(b.templateJson,function(a){a.isInfographic&&a.infographicJson.type===l.ATTACHMENTS&&(d=!0)});return q().then(function(){return c(null,function(){return c(b.attachmentsStore&&r.getAttachmentsStoreJson(b.attachmentsStore,{numAreas:b.analysisAreas.length,saveImages:d}),function(c){var l=e.mixin({},
b.config);!1!==g.forceFixedDataMode&&delete l.geoenrichmentUrl;c={isMultiFeature:b.isMultiFeature,reportTitle:b.reportTitle,templateJson:w.serialize(b.templateJson),reportObject:k._prepareReportObjectJson(b.reportObject),fieldData:b.fieldData,analysisAreas:a.areasToJson(b.analysisAreas),combinedAreasInfo:b.combinedAreasInfo&&a.combinedAreasInfoToJson(b.combinedAreasInfo),reverseAnalysisAreasOnMap:b.reverseAnalysisAreasOnMap,infographicOptions:b.infographicOptions&&b.infographicOptions.toJson(),attachmentsStore:c,
templateVariableProvider:b.templateVariableProvider&&b.templateVariableProvider.toJson(),config:l,countryConfig:n.toJson(),mapImageInfos:g.mapImageInfos,customLogo:b.customLogo};m.logData&&(console.log("_SerializationSupport.js \x3d\x3e reportDataJson"),console.log(c));return c})})})},_prepareReportObjectJson:function(a){var b={},c;for(c in a)a[c]&&"object"!==typeof a[c]&&(b[c]=a[c]);return b},_enrichInfographicVariables:function(a,g){var k=a.infographicOptions;return c(k.getOptions().getItems(k.countryID),
function(){var c=[];g.forEach(function(b){b.isInfographic&&b.variables&&a.analysisAreas.forEach(function(a,g){k.setCurrentAnalysisAreaIndex(g);var m=new d;a=k.createGeoenrichment({currentFeatureIndex:g});a.onDone=function(){m.resolve()};a.country=k.countryID;g=l.supportsComparison(b.type);a.setGeoLevels(g?u.getSubLevels(b):null,g?u.getHighestLevel(b):null);a.setVariables(b.variables);a.setStudyArea(k.studyArea);c.push(m.promise)})});return b(c)})},reportDataFromJson:function(b){var l=this;return q().then(function(){var d=
b.fieldData;d.featureData&&(d.areaData=d.featureData.map(function(a){return{mainCalculator:{data:a}}}),delete d.featureData);var m={isMultiFeature:b.isMultiFeature,reportTitle:b.reportTitle,templateJson:w.deserialize(b.templateJson),reportObject:b.reportObject,fieldData:d,analysisAreas:a.areasFromJson(b.analysisAreas),combinedAreasInfo:b.combinedAreasInfo&&a.combinedAreasInfoFromJson(b.combinedAreasInfo)||{},reverseAnalysisAreasOnMap:b.reverseAnalysisAreasOnMap,infographicOptions:b.infographicOptions&&
l._infographicOptionsProvider.getInfographicOptionsFromJson(b.infographicOptions),attachmentsStore:b.attachmentsStore&&r.getAttachmentsStoreFromJson(b.attachmentsStore),templateVariableProvider:b.templateVariableProvider&&new v(b.templateVariableProvider),config:b.config||{},mapImageInfos:b.mapImageInfos,customLogo:b.customLogo};g.populateCombinedAreasInfo(m.combinedAreasInfo,m.analysisAreas);t.setGeoenrichmentUrl(null);d=!1;m.config.geometryServiceUrl?A.setGeometryServiceUrl(m.config.geometryServiceUrl):
d=!0;m.config.printMapTaskUrl?y.setPrintMapTaskUrl(m.config.printMapTaskUrl):d=!0;n.fromJson(b.countryConfig);return c(d&&k.tryConfigureServicesFromAGOLPublic()).then(function(){return m})})}})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/areas/AnalysisAreaJsonUtil":function(){define(["esri/graphic","esri/dijit/PopupTemplate"],function(h,f){function e(b,a){if(!b)return null;b.getLayer()&&(b=new h(b.geometry,b.symbol,b.attributes,b.infoTemplate));b=b.toJson();a&&delete b.infoTemplate;
return b}function d(b){if(!b)return null;if(b instanceof h)return b;var a=b.infoTemplate&&new f(b.infoTemplate);delete b.infoTemplate;b=new h(b);a&&b.setInfoTemplate(a);return b}function c(b){var a={},c;for(c in b){var k=b[c];if("string"===typeof k||"number"===typeof k&&!isNaN(k))a[c]=k}return a}return{areasToJson:function(b,a){var g=a&&a.excludeInfoTemplate;return b.map(function(a){var b=c(a);b.feature=e(a.feature,g);b.location=a.location&&e(a.location,g);b.additionalFeatures=a.additionalFeatures&&
a.additionalFeatures.map(function(a){return e(a,g)});b.geographies=a.geographies;b.buffer=a.buffer;b.featureServiceQueryInfos=a.featureServiceQueryInfos;return b})},combinedAreasInfoToJson:function(b){var a=c(b);a.groups=b.groups&&b.groups.map(function(a){var b=c(a);b.indexes=a.indexes.slice();b.location=a.location&&e(a.location);b.additionalFeatures=a.additionalFeatures&&a.additionalFeatures.map(e);return b});return a},areasFromJson:function(b){return b.map(function(a){var b=c(a);b.feature=d(a.feature);
b.location=a.location&&d(a.location);b.additionalFeatures=a.additionalFeatures&&a.additionalFeatures.map(d);b.geographies=a.geographies;b.buffer=a.buffer;b.featureServiceQueryInfos=a.featureServiceQueryInfos;return b})},combinedAreasInfoFromJson:function(b){var a=c(b);a.groups=b.groups&&b.groups.map(function(a){var b=c(a);b.indexes=a.indexes.slice();b.location=a.location&&d(a.location);b.additionalFeatures=a.additionalFeatures&&a.additionalFeatures.map(d);return b});return a}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/areas/AnalysisAreaUtil":function(){define(["dojo/_base/lang",
"esri/geometry/webMercatorUtils","esri/dijit/geoenrichment/utils/CoordinateUtil"],function(h,f,e){var d={geometryToLatLong:function(c){var b=c.spatialReference.wkid;return b===e.WGS_84_WKID?{STORE_LONG:c.x,STORE_LAT:c.y}:e.isWebMercator(b)?(c=f.xyToLngLat(c.x,c.y),{STORE_LONG:c[0],STORE_LAT:c[1]}):null},populateCombinedAreasInfo:function(c,b){var a={},g={};b.forEach(function(b){b.latitude&&(a[b.latitude]=1);b.longitude&&(g[b.longitude]=1)});c.name=c.name||b.map(function(a){return a.name}).join(", ");
c.shortName=c.shortName||b.map(function(a){return a.shortName||a.name}).join(", ");c.description=c.description||b.map(function(a){return a.description||a.name}).join(", ");c.address=c.address||b.map(function(a){return a.address||a.name}).join(", ");c.latitude=c.latitude||Object.keys(a).join(", ");c.longitude=c.longitude||Object.keys(g).join(", ");return c},groupAreas:function(c){function b(a){var b=a.locationName||a.name;return{isSingleAreaGroup:!0,label:b,hideGroupLabel:b===(a.shortName||a.name),
areas:[a]}}var a=c.combinedAreasInfo&&c.combinedAreasInfo.groups||[],g=[],k=[],l={};c.analysisAreas.forEach(function(d){if(!(c.filter&&!c.filter(d)||d.hidden))if(d.isGrouped){if(!l[d.groupIndex]){var m=a[d.groupIndex],m=l[d.groupIndex]={isRealGroup:!0,label:m.locationName||m.name,areas:[]};k.push(m);g.push(m)}l[d.groupIndex].areas.push(d)}else g.push(b(d))});var d;1===g.length&&g[0].isRealGroup&&(g=g[0].areas.map(b),k.length=0,d=!0);return{groupInfos:g,isOnlyAreasInOnlyGroup:d}},parseSites:function(c){if(c.sites){c.analysisAreas=
[];c.sites.forEach(function(a){a.areas.forEach(function(a){c.analysisAreas.push(a)})});c.combinedAreasInfo={groups:c.sites.map(function(a){var b=h.mixin({},a);delete b.areas;delete b.attributes;delete b.notes;delete b.images;b.indexes=a.areas.map(function(a){return c.analysisAreas.indexOf(a)});return b})};d.populateCombinedAreasInfo(c.combinedAreasInfo,c.sites);if(!c.attachmentsProvider||!c.attachmentsProvider.getAttributesForAreaAt){c.attachmentsProvider={};c.attachmentsProvider.supportsMultipleAreas=
1<c.sites.length;var b=c.attachmentsProvider.areaAttachments=[];c.sites.forEach(function(a){a.areas.forEach(function(c){b.push({attributes:a.attributes,notes:a.notes,images:a.images})})})}delete c.sites}}};return d})},"esri/dijit/geoenrichment/utils/CoordinateUtil":function(){define(["esri/geometry/webMercatorUtils","esri/geometry/jsonUtils"],function(h,f){var e={},d=[4326,102100,102113,3857];e.WGS_84_WKID=4326;e.WEB_MERCATOR_WKID=102100;e.getSupportedWKIDs=function(){return d.slice()};e.testSpatialReferenceWKID=
function(c){c=d.indexOf(Number(c&&"object"===typeof c?c.wkid:c));return 0<=c?d[0===c?0:1]:0};e.isWebMercator=function(c){return 102100===e.testSpatialReferenceWKID(c)};e.isWGS84=function(c){return 4326===e.testSpatialReferenceWKID(c)};e.getGeometryConverter=function(c,b){c=e.testSpatialReferenceWKID(c);b=e.testSpatialReferenceWKID(b);return c&&b&&c!==b?4326===c?h.geographicToWebMercator:h.webMercatorToGeographic:null};e.toWGS84=function(c){return e.toSpatialReference(c,4326)};e.toWebMercator=function(c){return e.toSpatialReference(c,
102100)};e.toSpatialReference=function(c,b){c&&!c.toJson&&(c=f.fromJson(c));b=e.getGeometryConverter(c&&c.spatialReference,b);return null!=b?b(c):c};return e})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/PortalManager":function(){define(["esri/dijit/geoenrichment/when","esri/arcgis/Portal","../../../utils/requests/UniversalClient","../commands/mapToImage/MapToURLUtil","../../../utils/ProjectionUtil"],function(h,f,e,d,c){var b={_cache:{},getPortalInfo:function(a){if(!b._cache[a]){var c=
new f.Portal(a);b._cache[a]=h(c.signIn(),function(a){return{user:a,portal:c}})}return b._cache[a]},tryConfigureServicesFromAGOLPublic:function(){return e.requestPublicFirst("https://www.arcgis.com/sharing/rest/portals/self",{},{retryOnAnyError:!1}).then(function(a){if(a=a&&a.helperServices)a.geometry&&c.setGeometryServiceUrl(a.geometry.url),a.printTask&&d.setPrintMapTaskUrl(a.printTask.url)}).otherwise(function(a){console.log(a)})}};return b})},"esri/arcgis/Portal":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/kernel dojo/_base/Deferred dojo/_base/array dojo/_base/sniff require ../kernel ../lang ../request ../urlUtils ../Evented ../IdentityManager".split(" "),
function(h,f,e,d,c,b,a,g,k,l,p,n){var m={options:{disableIdentityLookup:!0},requestParams:{f:"json"}},q=function(a){function b(b){a[b]||(a[b]=function(){var g=arguments;return d.when(a,function(a){Array.prototype.unshift.call(g,a.results||a);return q(c[b].apply(c,g))})})}if(!a)return a;a.then&&(a=f.delegate(a));a.total||(a.total=d.when(a,function(a){return k.isDefined(a.total)?a.total:a.length||0}));b("forEach");b("filter");b("map");b("some");b("every");return a},r={useSSL:function(a,b){var c=m&&
m.self||{};if(c&&!c.isPortal)return-1!==a.indexOf("https:")||c.allSSL?b.replace("http:","https:"):b;var g=r.getLocation(b);return-1<c.portalHostname.toLowerCase().indexOf(g.hostname.toLowerCase())&&g.port&&"80"!==g.port&&"443"!==g.port?(b=g.pathname,b=0===b.indexOf("/")?b:"/"+b,c.allSSL||-1<a.indexOf("https:")?"https://"+g.hostname+(c.httpsPort&&"443"!==c.httpsPort?":"+c.httpsPort:"")+b+g.search:"http://"+g.hostname+(c.httpPort&&"80"!==c.httpPort?":"+c.httpPort:"")+b+g.search):-1!==a.indexOf("https:")||
c.allSSL?b.replace("http:","https:"):b},formatUrl:function(a){var b=m.currentToken;return-1!==a.indexOf("null")?null:r.useSSL(window.location.protocol,b?a+(-1!==a.indexOf("?")?"\x26":"?")+("token\x3d"+b):a)},getLocation:function(a){var b=document.createElement("a");b.href=a;return{protocol:b.protocol,hostname:b.hostname,port:b.port,pathname:b.pathname,search:b.search,hash:b.hash,host:b.host}},resultsToTypedArray:function(a,b,g){g=g?g.listings||g.notifications||g.userInvitations||g.tags||g.items||
g.groups||g.comments||g.provisions||g.results||g:[];return c.map(g,function(c){c=f.mixin(c,b||{});return a?new a(c):c})},clearFieldsFromObject:function(a,b){var c,g=a.length;if(f.isArray(a))for(c=0;c<g;c++)delete b[a[c]];else for(c in a)delete b[c];return b},requestToTypedArray:function(a,b,c,g,k){return q(r.request(a,b,c).then(f.partial(r.resultsToTypedArray,g,k)))},request:function(a,b,c){var g;b&&b.portal&&delete b.portal;b&&b.form&&(g=b.form,delete b.form);b=f.mixin(f.mixin({},b||{}),m.requestParams);
c=f.mixin(c||{},m.options);return l({url:r.useSSL(window.location.protocol,a.url||a),content:b,callbackParamName:"callback",timeout:c&&c.timeout||0,form:g},c)},formatQueryParams:function(a,b,c){a=f.mixin(f.mixin({},a),f.isString(b)?{q:b}:b||{});a.q=!c&&m.extraQuery?"("+a.q+")"+m.extraQuery:a.q;return a}},t=h([],{declaredClass:"esri.arcgis.PortalComment",constructor:function(a){f.mixin(this,a);this.url=this.item.itemUrl+"/comments/"+this.id;this.created=this.created?new Date(this.created):null}}),
w=h([],{declaredClass:"esri.arcgis.PortalRating",constructor:function(a){f.mixin(this,a);this.url=this.item.itemUrl+"/rating";this.created=this.created?new Date(this.created):null}}),u=h([],{declaredClass:"esri.arcgis.PortalItem",constructor:function(a){f.mixin(this,a);this.folderId=this.ownerFolder||this.folderId;this.itemUrl=(this.portal&&this.portal.portalUrl)+"content/items/"+this.id;this.userItemUrl=this.hasOwnProperty("ownerFolder")?this.itemUrl.replace("/content/","/content/users/"+this.owner+
(this.folderId?"/"+this.folderId:"")+"/"):null;this.itemDataUrl=r.formatUrl(this.itemUrl+"/data");this.thumbnailUrl=r.formatUrl(this.itemUrl+"/info/"+this.thumbnail);this.displayName=this._getDisplayName();this.iconUrl=this._getIconUrl();this.isPremiumContent=this._getIsPremiumContent();this.created=this.created?new Date(this.created):null;this.uploaded=this.uploaded?new Date(this.uploaded):null;this.modified=this.modified?new Date(this.modified):null},getTypeInfo:function(){var a=this.type;return{source:-1<
c.indexOf(this.typeKeywords||[],"ArcGIS Server")||"Feature Collection"===a?a:null,displayName:this.displayName,iconUrl:this.iconUrl,isPremiumContent:this.isPremiumContent,premiumIconUrl:this._getPremiumIconUrl()}},addComment:function(a){var b=f.isString(a)?{comment:a}:a;return r.request(this.itemUrl+"/addComment",b,{usePost:!0}).then(f.hitch(this,function(a){return new t(f.mixin(b,{id:a.commentId,item:this}))}))},updateComment:function(a){if(a&&a.url&&a.comment)return r.request(a.url+"/update",{comment:a.comment},
{usePost:!0}).then(function(b){a.id=b.commentId;return a});throw Error();},getComments:function(){return r.requestToTypedArray(this.itemUrl+"/comments",null,null,t,{item:this})},deleteComment:function(a){if(a&&a.url)return r.request(a.url+"/delete",null,{usePost:!0});throw Error();},addRating:function(a){var b=f.isObject(a)?a:{rating:parseFloat(a)};return r.request(this.itemUrl+"/addRating",b,{usePost:!0}).then(f.hitch(this,function(a){return new w(f.mixin(b,{id:a.ratingId,item:this}))}))},getRating:function(){return r.request(this.itemUrl+
"/rating").then(f.hitch(this,function(a){return new w(f.mixin(a,{item:this}))}))},deleteRating:function(){return r.request(this.itemUrl+"/deleteRating",null,{usePost:!0})},_getDisplayName:function(){var a=this.type,b=this.typeKeywords||[],g=a;"Feature Service"===a||"Feature Collection"===a?g=-1<c.indexOf(b,"Table")?"Table":-1<c.indexOf(b,"Route Layer")?"Route Layer":-1<c.indexOf(b,"Markup")?"Markup":"Feature Layer":"Image Service"===a?g=-1<c.indexOf(b,"Elevation 3D Layer")?"Elevation Layer":-1<c.indexOf(b,
"Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":"Scene Service"===a?g="Scene Layer":"Scene Package"===a?g="Scene Layer Package":"Stream Service"===a?g="Feature Layer":"Geoprocessing Service"===a&&this.portal&&this.portal.isPortal?g=-1<c.indexOf(b,"Web Tool")?"Tool":"Geoprocessing Service":"Geocoding Service"===a?g="Locator":"Microsoft Powerpoint"===a?g="Microsoft PowerPoint":"GeoJson"===a?this.type=g="GeoJSON":"Globe Service"===a?g="Globe Layer":"Vector Tile Service"===a?g="Tile Layer":"netCDF"===
a?g="NetCDF":"Map Service"===a?g=-1===c.indexOf(b,"Spatiotemporal")&&(-1<c.indexOf(b,"Hosted Service")||-1<c.indexOf(b,"Tiled"))&&-1===c.indexOf(b,"Relational")?"Tile Layer":"Map Image Layer":a&&-1<a.toLowerCase().indexOf("add in")?g=a.replace(/(add in)/ig,"Add-In"):"datastore catalog service"===a?g="Big Data File Share":"Compact Tile Package"===a?g="Tile Package (tpkx)":"Raster function template"===a&&(g="Raster Function Template");return g},_getIconUrl:function(){var b=this.type&&this.type.toLowerCase()||
"",g=this.typeKeywords||[],k=!1,l=!1,d=!1,m=!1,e=!1,l=!1;0<b.indexOf("service")||"feature collection"===b||"kml"===b||"wms"===b||"wmts"===b||"wfs"===b?(k=-1<c.indexOf(g,"Hosted Service"),"feature service"===b||"feature collection"===b||"kml"===b||"wfs"===b?(m=-1<c.indexOf(g,"Table"),l=-1<c.indexOf(g,"Route Layer"),d=-1<c.indexOf(g,"Markup"),b=(e=-1!==c.indexOf(g,"Spatiotemporal"))&&m?"spatiotemporaltable":m?"table":l?"routelayer":d?"markup":e?"spatiotemporal":k?"featureshosted":"features"):"map service"===
b||"wms"===b||"wmts"===b?(e=-1!==c.indexOf(g,"Spatiotemporal"),l=-1!==c.indexOf(g,"Relational"),b=e||l?"mapimages":k||-1<c.indexOf(g,"Tiled")||"wmts"===b?"maptiles":"mapimages"):b="scene service"===b?-1<c.indexOf(g,"Line")?"sceneweblayerline":-1<c.indexOf(g,"3DObject")?"sceneweblayermultipatch":-1<c.indexOf(g,"Point")?"sceneweblayerpoint":-1<c.indexOf(g,"IntegratedMesh")?"sceneweblayermesh":-1<c.indexOf(g,"PointCloud")?"sceneweblayerpointcloud":-1<c.indexOf(g,"Polygon")?"sceneweblayerpolygon":-1<
c.indexOf(g,"Building")?"sceneweblayerbuilding":"sceneweblayer":"image service"===b?-1<c.indexOf(g,"Elevation 3D Layer")?"elevationlayer":-1<c.indexOf(g,"Tiled Imagery")?"tiledimagerylayer":"imagery":"stream service"===b?"streamlayer":"vector tile service"===b?"vectortile":"datastore catalog service"===b?"datastorecollection":"geocoding service"===b?"geocodeservice":"geoprocessing service"===b?-1<c.indexOf(g,"Web Tool")&&this.portal&&this.portal.isPortal?"tool":"layers":"layers"):b="web map"===b||
"cityengine web scene"===b?"maps":"web scene"===b?-1<c.indexOf(g,"ViewingMode-Local")?"webscenelocal":"websceneglobal":"web mapping application"===b||"mobile application"===b||"application"===b||"operation view"===b||"desktop application"===b?"apps":"map document"===b||"map package"===b||"published map"===b||"scene document"===b||"globe document"===b||"basemap package"===b||"mobile basemap package"===b||"mobile map package"===b||"project package"===b||"project template"===b||"pro map"===b||"layout"===
b||"layer"===b&&-1<c.indexOf(g,"ArcGIS Pro")||"explorer map"===b&&c.indexOf(g,"Explorer Document")?"mapsgray":"service definition"===b||"csv"===b||"shapefile"===b||"cad drawing"===b||"geojson"===b||"360 vr experience"===b||"netcdf"===b||"administrative report"===b?"datafiles":"explorer add in"===b||"desktop add in"===b||"windows viewer add in"===b||"windows viewer configuration"===b?"appsgray":"arcgis pro add in"===b||"arcgis pro configuration"===b?"addindesktop":"rule package"===b||"file geodatabase"===
b||"sqlite geodatabase"===b||"csv collection"===b||"kml collection"===b||"windows mobile package"===b||"map template"===b||"desktop application template"===b||"gml"===b||"arcpad package"===b||"code sample"===b||"form"===b||"document link"===b||"operations dashboard add in"===b||"rules package"===b||"image"===b||"workflow manager package"===b||"explorer map"===b&&-1<c.indexOf(g,"Explorer Mapping Application")||-1<c.indexOf(g,"Document")?"datafilesgray":"network analysis service"===b||"geoprocessing service"===
b||"geodata service"===b||"geometry service"===b||"geoprocessing package"===b||"locator package"===b||"geoprocessing sample"===b||"workflow manager service"===b?"toolsgray":"layer"===b||"layer package"===b||"explorer layer"===b?"layersgray":"scene package"===b?"scenepackage":"mobile scene package"===b?"mobilescenepackage":"tile package"===b||"compact tile package"===b?"tilepackage":"task file"===b?"taskfile":"report template"===b?"report-template":"statistical data collection"===b?"statisticaldatacollection":
"insights workbook"===b?"workbook":"insights model"===b?"insightsmodel":"insights page"===b?"insightspage":"insights theme"===b?"insightstheme":"hub initiative"===b?"hubinitiative":"hub page"===b?"hubpage":"hub site application"===b?"hubsite":"relational database connection"===b?"relationaldatabaseconnection":"big data file share"===b?"datastorecollection":"image collection"===b?"imagecollection":"desktop style"===b?"desktopstyle":"style"===b?"style":"dashboard"===b?"dashboard":"raster function template"===
b?"rasterprocessingtemplate":"vector tile package"===b?"vectortilepackage":"ortho mapping project"===b?"orthomappingproject":"ortho mapping template"===b?"orthomappingtemplate":"solution"===b?"solutions":"geopackage"===b?"geopackage":"deep learning package"===b?"deeplearningpackage":"real time analytic"===b?"realtimeanalytics":"big data analytic"===b?"bigdataanalytics":"feed"===b?"feed":"excalibur imagery project"===b?"excaliburimageryproject":"notebook"===b?"notebook":"storymap"===b?"storymap":"survey123 add in"===
b?"survey123addin":"mission"===b?"mission":"mission report"===b?"missionreport":"quickcapture project"===b?"quickcaptureproject":"pro report"===b?"proreport":"urban model"===b?"urbanmodel":"web experience"===b?"experiencebuilder":"web experience template"===b?"webexperiencetemplate":"workflow"===b?"workflow":"kernel gateway connection"===b?"kernelgatewayconnection":"insights script"===b?"insightsscript":"hub initiative template"===b?"hubinitiativetemplate":"storymap theme"===b?"storymaptheme":"maps";
return b?a.toUrl("../css/images/item_type_icons/"+b+"16.png"):null},_getIsPremiumContent:function(){var a=this.typeKeywords,b=!1;if(-1<c.indexOf(a,"Requires Subscription")||-1<c.indexOf(a,"Requires Credits"))b=!0;return b},_getPremiumIconUrl:function(){var b=this.typeKeywords,g;this.isPremiumContent&&(g=-1<c.indexOf(b,"Requires Credits")?"premiumcredits":"premiumitem");return g?a.toUrl("../css/images/item_type_icons/"+g+"16.png"):null},getThumbnailUrl:function(a){var b=this.thumbnailUrl;b&&a&&(b+=
(-1===b.indexOf("?")?"?":"\x26")+"w\x3d"+a);return b}}),v=h([],{declaredClass:"esri.arcgis.PortalListing",constructor:function(a){f.mixin(this,a);this.id=this.itemId;this.url=(this.portal&&this.portal.portalUrl)+"content/"+(this.userItemUrl?"items/":"listings/")+this.itemId;this.commentsUrl=this.url+"/comments";this.created=this.created?new Date(this.created):null;this.banner=this.banner?r.formatUrl(this.url+"/info/"+this.banner):"";this.thumbnail=this.thumbnail?r.formatUrl(this.url+"/info/"+this.thumbnail):
"";this.largeThumbnail=this.largeThumbnail?r.formatUrl(this.url+"/info/"+this.largeThumbnail):"";this.avgRating=this.avgRating||0;this.numRatings=this.numRatings||0;this.numComments=this.numComments||0;this.listingProperties=this.listingProperties||{priceDesc:"",creditsPerTransaction:0,licenseType:"free",trialSupported:!1,trialDuration:0,listingAccess:"private"};for(var b in this.listingProperties)this[b]&&(this.listingProperties[b]=this[b]);this.properties=this.properties||{systemRequirements:"",
termsAndConditions:"",version:"1.0"};this.screenshots=c.map(this.screenshots,f.hitch(this,function(a){return r.formatUrl(this.url+"/info/"+a)}));this.vendorName=this.vendor.name;this.vendor.thumbnail=this.vendor.thumbnail?this.userItemUrl?r.formatUrl(this.portal.portalUrl+"/portals/self/resources/"+this.vendor.thumbnail):r.formatUrl(this.url+"/vendorinfo/"+this.vendor.thumbnail):""},getComments:function(){return r.requestToTypedArray(this.commentsUrl,null,null,t,{item:this})},getVendor:function(){return this.vendor}}),
y=h([],{declaredClass:"esri.arcgis.PortalProvision",constructor:function(a){f.mixin(this,a);this.created=this.created?new Date(this.created):null;this.startDate=this.startDate?new Date(this.startDate):null;this.endDate=this.endDate&&-1!==this.endDate?new Date(this.endDate):null;this.listing=a.listing?new v(f.mixin(a.listing,{portal:this.portal})):null}}),A=h([],{declaredClass:"esri.arcgis.PortalGroup",constructor:function(a){f.mixin(this,a);this.url=(this.portal&&this.portal.portalUrl)+"community/groups/"+
this.id;this.thumbnailUrl=r.formatUrl(this.url+"/info/"+this.thumbnail);this.modified=this.modified?new Date(this.modified):null;this.created=this.created?new Date(this.created):null},getMembers:function(){return r.request(this.url+"/users")},queryItems:function(a,b){a=r.formatQueryParams({},a,b);a.q="group:"+this.id+(a.q?" "+a.q:"");return this.portal.queryItems(a)},getThumbnailUrl:function(a){var b=this.thumbnailUrl;b&&a&&(b+=(-1===b.indexOf("?")?"?":"\x26")+"w\x3d"+a);return b}}),z=h([],{declaredClass:"esri.arcgis.PortalFolder",
constructor:function(a){f.mixin(this,a);this.url=(this.portal&&this.portal.portalUrl)+"content/users/"+this.username+"/"+this.id;this.created=this.created?new Date(this.created):null},getItems:function(){return r.requestToTypedArray(this.url,null,null,u,{portal:this.portal,folderId:this.id})}}),D=h([],{declaredClass:"esri.arcgis.PortalUser",constructor:function(a){f.mixin(this,a);this.url=(this.portal&&this.portal.portalUrl)+"community/users/"+this.username;this.userContentUrl=(this.portal&&this.portal.portalUrl)+
"content/users/"+this.username;this.thumbnailUrl=this.thumbnail?r.formatUrl(this.url+"/info/"+this.thumbnail):null;this.modified=this.modified?new Date(this.modified):null;this.created=this.created?new Date(this.created):null},getGroups:function(){return q(r.request(this.url).then(f.hitch(this,function(a){return r.resultsToTypedArray(A,{portal:this.portal},a.groups)})))},getNotifications:function(){return r.requestToTypedArray(this.url+"/notifications",null,null,null,{portal:this.portal})},getGroupInvitations:function(){return r.requestToTypedArray(this.url+
"/invitations",null,null,null,{portal:this.portal})},getTags:function(){return r.requestToTypedArray(this.url+"/tags",null,null,null,{portal:this.portal})},getFolders:function(){return q(this.getContent(null,{num:1}).then(function(a){return a.folders}))},getItems:function(a){return q(this.getContent(a).then(function(a){return a.items}))},getItem:function(a){return r.request(this.portal.portalUrl+"content/items/"+a).then(f.hitch(this,function(a){return new u(f.mixin(a,{portal:this.portal}))}))},getContent:function(a,
b){var c=this.url.replace("/community/","/content/")+(a?"/"+a:"");return r.request(c,b).then(f.hitch(this,function(b){b.folders=r.resultsToTypedArray(z,{portal:this.portal},b.folders);b.items=r.resultsToTypedArray(u,{portal:this.portal,folderId:a},b.items);return b}))},getThumbnailUrl:function(a){var b=this.thumbnailUrl;b&&a&&(b+=(-1===b.indexOf("?")?"?":"\x26")+"w\x3d"+a);return b}});h={Portal:h([n],{declaredClass:"esri.arcgis.Portal",onLoad:function(){},onError:function(){},constructor:function(a){a=
f.isObject(a)?a:{url:a};this.registerConnectEvents();m={options:{disableIdentityLookup:!0},requestParams:{f:"json"}};a.self?(m.self=a.self,f.mixin(this,{url:a.url||p.getProtocolForWebResource()+"//"+(a.self.urlKey?a.self.urlKey+"."+a.self.customBaseUrl:a.self.portalHostname)}),this.portalUrl=-1!==this.url.indexOf("/sharing")?this.url+"/":this.url+"/sharing/rest/",a=a.self.user?this.signIn():this.init(this.url)):(a.url&&f.mixin(this,{url:a.url}),a=this.init(this.url));a.then(f.hitch(this,function(){this.emit("ready",
this);this.onLoad(this)}))},init:function(a,b){a=(a||this.portalUrl).replace(/\/+$/,"");this.portalUrl=-1!==a.indexOf("/sharing")?a+"/":a+"/sharing/rest/";return this._getSelf(this.portalUrl).then(f.hitch(this,function(a){m.self=f.mixin({},a);(a=a.user)&&b&&(m.currentToken=b&&b.token,m.loggedInUser=new D(f.mixin(a,{portal:this,credential:b})));m.self.id&&!1===m.self.canSearchPublic&&(m.extraQuery=" AND orgid:"+m.self.id);f.mixin(this,m.self);this.thumbnailUrl=r.formatUrl(this.portalUrl+"portals/self/resources/"+
this.thumbnail);this.isOrganization=this.access&&this.access.length?!0:!1;this.created=this.created?new Date(this.created):null;this.modified=this.modified?new Date(this.modified):null;return this}),f.hitch(this,function(a){this.onError(a);throw a;}))},signIn:function(){var a=new d,b=f.hitch(this,function(){this._onSignIn().then(f.hitch(this,function(){a.resolve(m.loggedInUser)}),f.hitch(this,function(b){a.reject(b)}))});if(m&&m.self)m&&m.loggedInUser?setTimeout(function(){a.resolve(m.loggedInUser)},
0):b();else this.on("load",f.hitch(this,function(){b()}));return a},signOut:function(){m.loggedInUser.credential&&m.loggedInUser.credential.destroy();m.loggedInUser=null;m.options.disableIdentityLookup=!0;r.clearFieldsFromObject(m.self,this);m.self=null;return this.init(this.url)},getPortalUser:function(){return m.loggedInUser},addResource:function(a,b){return r.request(this.portalUrl+"portals/self/addResource",{key:a,text:b},{usePost:!0})},update:function(a){return r.request(this.portalUrl+"portals/self/update",
a,{usePost:!0})},queryGroups:function(a,b){return this._queryPortal(this.portalUrl+"community/groups",r.formatQueryParams({},a,b),A)},queryItems:function(a,b){return this._queryPortal(this.portalUrl+"search",r.formatQueryParams({},a,b),u)},queryListings:function(a){a=r.formatQueryParams({},a,!0);var b="";a.q&&-1<a.q.toLowerCase().indexOf("mylistings:true")?(a.q=a.q.toLowerCase().replace("mylistings:true",""),b="?mylistings\x3dtrue"):a.q||(a.q='""');return this._queryPortal(this.portalUrl+"content/listings"+
b,a,v)},queryCustomerList:function(a,b){a=r.formatQueryParams({},a,!0);return this._queryPortal(this.portalUrl+"portals/self/customersList",a)},getProvisions:function(){return this.getCustomers().then(f.hitch(this,function(a){return a.purchases}))},getInterests:function(){return this.getCustomers().then(f.hitch(this,function(a){return a.interests}))},getTrials:function(){return this.getCustomers().then(f.hitch(this,function(a){return a.trials}))},getCustomers:function(a){return r.request(this.portalUrl+
"portals/self/customers",{status:a||"all"})},getMyPurchases:function(){return this.getPurchases().then(function(a){return a.purchases})},getMyInterests:function(){return this.getPurchases().then(function(a){return a.interests})},getPurchases:function(){return r.request(this.portalUrl+"portals/self/purchases").then(f.hitch(this,function(a){a.interests=c.map(a.interests,function(a){return f.mixin(a.provision,{listing:a.listing})});a.purchases=c.map(a.purchases,function(a){return f.mixin(a.provision,
{listing:a.listing})});a.trials=c.map(a.trials,function(a){return f.mixin(a.provision,{listing:a.listing})});a.interests=r.resultsToTypedArray(y,{portal:this},a.interests);a.trials=r.resultsToTypedArray(y,{portal:this},a.trials);a.purchases=r.resultsToTypedArray(y,{portal:this},a.purchases);return a}))},queryUsers:function(a,b){return this._queryPortal(this.portalUrl+"community/users",r.formatQueryParams({sortField:"username"},a,b),D)},_onSignIn:function(){m.options.disableIdentityLookup=!1;m.self=
null;return g.id.getCredential(this.portalUrl).then(f.hitch(this,"init",this.url)).then(function(){return m.loggedInUser},f.hitch(this,function(a){m.options.disableIdentityLookup=!0;this.onError(a);throw a;}))},_getSelf:function(a){var b;a+="portals/self";m.self?(b=new d,setTimeout(function(){b.resolve(m.self)},0)):b=r.request(a,{culture:e.locale});return b},_queryPortal:function(a,b,c){var g=f.mixin({num:10,start:0,sortField:"title",sortOrder:"asc"},b),k=["start","query","num","nextStart"];a=r.request(a,
g).then(f.hitch(this,function(a){a.results=r.resultsToTypedArray(c,{portal:this},a);a.queryParams=f.mixin({},g);a.nextQueryParams=f.mixin(g,{start:a.nextStart});return r.clearFieldsFromObject(k,a)}));a=f.delegate(a);a.queryParams=f.mixin({},g);a.nextQueryParams=d.when(a,function(a){return a.nextQueryParams});return q(a)}}),PortalFolder:z,PortalGroup:A,PortalItem:u,PortalUser:D,PortalComment:t,PortalRating:w,PortalUtil:r,PortalResult:q,PortalListing:v};b("extend-esri")&&f.mixin(f.getObject("arcgis",
!0,g),h);return h})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/commands/mapToImage/MapToURLUtil":function(){define("require dojo/_base/declare esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all dojo/dom-style esri/dijit/geoenrichment/utils/DataUtil esri/dijit/geoenrichment/utils/ImageInfoUtil esri/dijit/geoenrichment/utils/RegExpUtil esri/dijit/geoenrichment/utils/UrlUtil".split(" "),function(h,f,e,d,c,b,a,g,k,l){function p(){var b=new e;
h("esri/tasks/PrintTask esri/tasks/PrintParameters esri/tasks/PrintTemplate esri/layers/GraphicsLayer ./DotDensityToImageUtil ./LegendToLayerUtil".split(" "),function(c,g,l,d,p,h){m=g;q=l;r=d;t=p;w=h;n=f(c,{returnJson:!1,mapName:null,_execute:function(){this.returnJson&&(this.printGp.submitJob=this.printGp.execute=function(b,c){b="data:application/json;base64,"+a.base64FromJson(b.Web_Map_as_JSON);c([{value:{url:b}}]);return(new e).resolve()});return this.inherited(arguments)},_getPrintDefinition:function(a,
b){var c=this.inherited(arguments);this.returnJson&&this.mapName&&(c.title=this.mapName);console.log(c);return c},_createOperationalLayers:function(a,b){var c=this.inherited(arguments);if(b.__legendLayerId){var g=c.filter(function(a){return a.id===b.__legendLayerId})[0];c.splice(c.indexOf(g),1);c.push(g)}return c},_createFeatureCollection:function(a,b,c,g){var l=this.inherited(arguments);this.returnJson&&l&&("esri.layers.FeatureLayer"===a.declaredClass||"esri.layers.StreamLayer"===a.declaredClass||
"esri.layers.GraphicsLayer"===a.declaredClass)&&l.featureCollection.layers.forEach(function(b){b.layerDefinition.name=a.arcgisProps&&a.arcgisProps.title||a._titleForLegend||a.name||a.id;b.layerDefinition.name=k.decodeXML(b.layerDefinition.name);b.layerDefinition.objectIdField="OBJECTID";b.layerDefinition.fields=[{name:"OBJECTID",type:"esriFieldTypeOID"}];var c={OBJECTID:1},g=/[^\w]/g,l;b.featureSet.features.forEach(function(a,d){a.attributes=a.attributes||{};a.attributes.OBJECTID=d+1+"";a.attributes.__nameField||
(a.attributes.Name=k.decodeXML(a.attributes.Name||b.layerDefinition.name),l="Name");d=a.attributes.__fieldAliases;for(var m in a.attributes)if(0!==m.indexOf("__")){var e=m,q=a.attributes[m];"string"===typeof q&&(q=k.decodeXML(q));var p=d&&d[m];(p=p&&p.replace(g,"_"))&&void 0===a.attributes[p]&&(a.attributes[p]=q,e=p);a.attributes.__nameField===m&&(l=e);c[m]||(c[m]=1,b.layerDefinition.fields.push({name:e,type:"string"===typeof q?"esriFieldTypeString":"esriFieldTypeDouble"}))}});b.layerDefinition.displayField=
l});return l}});b.resolve()});return b.promise}var n,m,q,r,t,w,u,v={setPrintMapTaskUrl:function(a){u=a;l.registerCORS(a)},mapToURL:function(a,b,c,g){var k=v._getUrlForMap(a);if(k)return k;k=p().then(function(){return v._replaceDotDensityLayersWithPictureMarkers(a).then(function(k){return d(b&&w.legendToGraphicsLayer(b,a,c),function(b){b&&a.addLayer(b);return d(v._runPrintTask(a,c,b,g),function(c){b&&a.removeLayer(b);v._rollbackReplacing(a,k);var g=new e;setTimeout(function(){g.resolve(c.url)},100);
return g.promise})})})});v._putUrlToCache(a,k);return k},_replaceDotDensityLayersWithPictureMarkers:function(a){var b=[];for(i=0;i<a.graphicsLayerIds.length;i++)layer=a.getLayer(a.graphicsLayerIds[i]),layer.loaded&&layer.visible&&t.isDotDensity(layer)&&b.push(v._createGraphicsLayerFromDotDensityLayer(i,layer,a));return c(b)},_createGraphicsLayerFromDotDensityLayer:function(a,b,c){return t.createPictureMarkersFromDotDensityLayer(b,c.extent,c).then(function(g){if(!g)return null;var k=new r;g.map(function(a){k.add(a)});
c.addLayer(k,a);b.visible=!1;return{addedLayer:k,hiddenLayer:b}}).otherwise(function(a){console.log(a);return null})},_runPrintTask:function(a,c,g,k){function l(){var l=new n(u);l.returnJson=k&&k.replaceWithJson;l.mapName=k&&k.mapName;var d=new m;d.map=a;var e=new q;e.exportOptions={width:3.125*b.get(c,"width"),height:3.125*b.get(c,"height"),dpi:300};e.format="png32";e.showAttribution=!1;e.forceFeatureAttributes=!0;e.__legendLayerId=g&&g.id;d.template=e;return l.execute(d)}return d(l(),function(a){return a},
function(a){console.log(a);return d(l(),function(a){return a},function(a){console.log(a);return l()})})},_rollbackReplacing:function(a,b){b.forEach(function(b){b&&b.addedLayer&&a.removeLayer(b.addedLayer);b&&b.hiddenLayer&&(b.hiddenLayer.visible=!0)})},urlToSrc:function(a,b){return b&&b.saveImagesAsDataUrl?g.getRemoteImageDataUrl(a,{sizeLimit:1500}):a}},y,A=0;v.enableCaching=function(){y={}};v.clearCaching=function(){y=null};v._putUrlToCache=function(a,b){y&&b&&(a.__mapToImageUtilKey=A++,y[a.__mapToImageUtilKey]=
b)};v._getUrlForMap=function(a){return y&&y[a.__mapToImageUtilKey]};return v})},"esri/dijit/geoenrichment/utils/ImageInfoUtil":function(){define(["dojo/_base/lang","esri/dijit/geoenrichment/when","./ImageUtil","./UrlUtil"],function(h,f,e,d){var c=/^data:/i,b={_infoCache:{},getImageInfo:function(a,c,k){var g=k&&k.sizeLimit||1E5;b._infoCache[a]||(b._infoCache[a]=e.imageFromUrl(a,k).then(function(c){var g=e.imageToDataURL(c),k={dataUrl:g,contentType:e.getContentType(g),width:c.width,height:c.height};
setTimeout(function(){b._infoCache[a]=k});return k}));return f(b._infoCache[a],function(a){a=h.mixin({},a);c&&(a.filename=c&&c.replace(/\.\w+$/,".png").toLowerCase());return function(a){return f(b._processDataUrl(a,g),function(b){if(b&&b.dataUrl){var c=h.mixin({},a);c.dataUrl=b.dataUrl;c.width*=b.factor;c.height*=b.factor;return f(c)}return f(a)})}(a)})},ensureDataUrlForRemoveImage:function(a,g){return!a||c.test(a)?a:b.getRemoteImageDataUrl(a,g)},getRemoteImageDataUrl:function(a,c){function g(c,g){return b.getImageInfo(c?
n+"?"+a:a,null,{crossOrigin:g}).then(function(a){return f(b._processDataUrl(a,e),function(a){return a&&a.dataUrl||a})})}function l(){console.log("Failed to get data for URL: "+a);return a}var e=c&&c.sizeLimit||1E5,n=d.getProxyUrl();return g(!1,"anonymous").otherwise(function(){return g(!1,null)}).otherwise(function(){return n?g(!0,"anonymous"):l()}).otherwise(function(){return g(!0,null)}).otherwise(l)},_processDataUrl:function(a,b){var c=Math.max(a.width,a.height);if(c<=b)return a.dataUrl;var g=
b/c;return f(e.scaleImage(a.dataUrl,{factor:g}),function(a){return{dataUrl:a,factor:g}})}};return b})},"esri/dijit/geoenrichment/utils/ImageUtil":function(){define(["esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when","./UrlUtil"],function(h,f,e){var d={base64DataToDataURL:function(c,b){if(/^data:image/.test(c))return c;b||(b=atob(c.substr(0,16)),b=d.getImageContentType(b));return"data:"+(b||"image/png")+";base64,"+c},getImageContentType:function(c){if("\u00ff\u00d8\u00ff"===c.substr(0,
3)&&"JFIF"===c.substr(6,4))return"image/jpeg";if("\u0089PNG\r\n\u001a\n"===c.substr(0,8))return"image/png";if("GIF89a"===c.substr(0,6)||"GIF87a"===c.substr(0,6))return"image/gif"},base64DataFromDataURL:function(c){0==c.indexOf("data:")&&(c=c.substr(c.indexOf(",")+1));return c},getBase64DataIndex:function(c){c=0==c.indexOf("data:")?c.indexOf(";base64,"):-1;return 0<c?c+8:0},getContentType:function(c){var b=d.getBase64DataIndex(c);return b?c.substring(5,b-8):null},checkBase64FileSize:function(c,b){return d.getBase64FileSize(c)<=
b},getBase64FileSize:function(c){return.75*c.length},imageToDataURL:function(c,b){b=b||{};var a=document.createElement("canvas"),g=a.getContext("2d");a.width=b.width||c.width;a.height=b.height||c.height;var k=b.opacity;null!=k&&!isNaN(k)&&0<=k&&1>k&&(g.globalAlpha=+k,b.format="image/png");(k=b.pos)?g.drawImage(c,k.x||0,k.y||0):g.drawImage(c,0,0,a.width,a.height);return a.toDataURL(b.format)},imageFromUrl:function(c,b){var a=new h,g=new Image;0!==c.indexOf("data:")&&b&&b.crossOrigin&&g.setAttribute("crossOrigin",
b.crossOrigin);g.onload=function(){if(g.width&&g.height)a.resolve(g);else{var c=Error("Error of reading an image from URL.");b&&b.ignoreError?a.resolve(null):a.reject(c)}g.onload=g.onerror=null};g.onerror=function(c){b&&b.ignoreError?a.resolve(null):a.reject(c);g.onload=g.onerror=null};c=require.toUrl(c);/^http:/i.test(c)&&/^https/i.test(window.location.protocol)&&(c=e.toHttpsUrl(c));g.src=c;return a.promise},scaleImage:function(c,b){if("string"===typeof c)var a=d.base64DataToDataURL(c),g=d.getContentType(a),
a=d.imageFromUrl(a);return f(a||c).then(function(a){var c=1,k=a.width,e=a.height;if(b.factor)c=b.factor;else if(b.maxDim)c=b.maxDim/Math.max(k,e);else if(b.imageDim){var m=b.imageDim.w,q=b.imageDim.h;b.imageDim.preserveRatio?(c=Math.min(m/k,q/e),b.imageDim.reduceOnly&&1<c&&(c=1)):b.imageDim.reduceOnly?(k=Math.min(k,m),e=Math.min(e,q)):(k=m,e=q)}return d.imageToDataURL(a,{width:k*c,height:e*c,format:b.format||g,opacity:b.opacity})})},getImageViewType:function(c,b){return 1E3<=b?(c/=b,.025>=Math.abs(c-
2)?"360":2<c?"pano":null):null}};return d})},"esri/dijit/geoenrichment/utils/RegExpUtil":function(){define([],function(){var h={createRegExp:function(a,b,c){a=h.trimText(a);return!a&&c?null:new RegExp(a,b)},trimText:function(a){return a?a.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,"").trim():""},replace:function(a,b,c){return null==a?"":(""+a).replace(b,function(a){return c[a]||""})}},f=/&|<|>/g,e=/&|<|>|"|'/g,d={"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26apos;"};h.encodeXML=
function(a,b){return h.replace(a,b?e:f,d)};var c=/&amp;|&lt;|&gt;|&quot;|&apos;/g,b={"\x26amp;":"\x26","\x26lt;":"\x3c","\x26gt;":"\x3e","\x26quot;":'"',"\x26apos;":"'"};h.decodeXML=function(a){return h.replace(a,c,b)};h.IS_RICH_TEXT_RE=/<\w/;h.IS_URL_RE=/((www\.|http:\/\/|https:\/\/)[A-Za-z0-9_.\-~]+\.[A-Za-z0-9_.\-~/]+)|([A-Za-z0-9_.\-~]+\.com[A-Za-z0-9_.\-~/]*)/;h.isRichText=function(a){return a&&h.IS_RICH_TEXT_RE.test(a)};h.isUrl=function(a){return a&&h.IS_URL_RE.test(a)};var a=/^[0-9a-fA-F]{32}$/;
h.isId=function(b){return b&&a.test(b)};return h})},"esri/dijit/geoenrichment/utils/ProjectionUtil":function(){define("dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/SpatialReference esri/geometry/jsonUtils esri/dijit/geoenrichment/utils/CoordinateUtil esri/dijit/geoenrichment/utils/PolygonUtil esri/dijit/geoenrichment/utils/UrlUtil esri/dijit/geoenrichment/utils/requests/UniversalClient esri/dijit/geoenrichment/utils/requests/EveryRequest".split(" "),function(h,f,e,d,c,b,a,g,k){function l(a){return a&&
a.spatialReference||a instanceof e&&a||a&&new e(a)||new e(c.WEB_MERCATOR_WKID)}function p(a,b){var g=[];try{for(var k=0;k<a.length;k++)g.push(c.toSpatialReference(a[k],b))}catch(z){console.log(z)}return(new f).resolve(g)}function n(a,c){function g(a){f.push(function(){return m(q,a,e,c)})}var l=a[0],e=d.getJsonType(l),q={outSR:c.wkid||c.toJson(),inSR:l.spatialReference.wkid||l.spatialReference.toJson()},f=[],p=0,n=[];1==a.length?n.push(l):a.forEach(function(a){var c=b.getNumberOfPoints(a);p+=c;if(1E4<
p){var k=[];n.length?(k.push(a),p=c):(n.push(a),p=0);g(n);n=k}else n.push(a)});n.length&&g(n);return k(f,{stopOnError:!0}).then(function(a){for(var b=a[0],c=1;c<a.length;c++)b=b.concat(a[c]);return b},function(a){console.log(a);return[]})}function m(a,b,c,k){a.geometries=q(b);return g.requestPublicFirst({url:w,urlSuffix:"project"},{content:a}).then(function(a){return r(a.geometries,c,k)})}function q(a){var b=a.map(function(a){a=a.toJson();delete a.spatialReference;return a});return{geometryType:d.getJsonType(a[0]),
geometries:b}}function r(a,b,c){var g=d.getGeometryType(b),k={spatialReference:c.toJson()};return a.map(function(a){return new g(h.mixin(a,k))})}var t={},w;t.setGeometryServiceUrl=function(b){w=b;a.registerCORS(b)};t.getSpatialReference=l;t.projectGeometries=function(a,b){var g=l(b);b=Array.isArray(a)?a:[a];if(!b.length)return(new f).resolve(a);var k={},d=b.slice(),e=0;b=b.filter(function(a,b){if(a.spatialReference&&a.spatialReference.wkid!==g.wkid)return k[b]=e++,!0});return b.length?(c.testSpatialReferenceWKID(g)&&
c.testSpatialReferenceWKID(b[0].spatialReference)?p(b,g):n(b,g)).then(function(b){d.forEach(function(a,c){void 0!==k[c]&&(d[c]=b[k[c]])});return Array.isArray(a)?d:d[0]}):(new f).resolve(a)};t.unionGeometries=function(a){var b=l(a[0].spatialReference);a={sr:b.wkid||b.toJson(),geometries:q(a)};return g.requestPublicFirst({url:w,urlSuffix:"union"},{content:a}).then(function(a){return r([a.geometry],a.geometryType,b)[0]})};return t})},"esri/dijit/geoenrichment/utils/PolygonUtil":function(){define([],
function(){var h={getNumberOfPoints:function(f){if(!f)return 0;Array.isArray(f)||(f=[f]);var e=0;f.forEach(function(d){e+=h.getGeometryPointCount(d.geometry||d)});return e},getGeometryPointCount:function(f){if(!f)return 0;var e=0,d=f.rings||f.paths;!d&&f.points&&(d=[f.points]);d?d.forEach(function(c){e+=c&&c.length||0}):e+="x"in f?1:2;return e}};return h})},"esri/dijit/geoenrichment/utils/requests/EveryRequest":function(){define(["dojo/_base/declare","esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when"],
function(h,f,e){var d=h(null,{requests:null,results:null,requestCount:0,chunkSize:0,stopOnError:!1,onProgress:null,index:0,completeCount:0,executeCount:0,isExecuting:!1,dfd:null,constructor:function(c,b,a,g,k){this.requests=c;this.results=b;this.requestCount=this.requests.length;this.chunkSize=Math.max(a,0);this.stopOnError=g;this.onProgress=k},execute:function(){this.isExecuting=!0;for(this.dfd=new f;this.tryStartNextRequest(););return this.dfd.promise},tryStartNextRequest:function(){if(!this.isExecuting)return!1;
if(this.index==this.requestCount&&!this.executeCount)return this.isExecuting=!1,this.dfd.resolve(this.results),!1;if(this.index==this.requestCount||this.executeCount==this.chunkSize)return!1;var c=this.requests[this.index++];this.executeCount++;var b=c.request;"function"===typeof b&&(b=b());var a=this,g=!0;e(b,function(b){a.processResult(b,c.key,b instanceof Error,g)},function(b){a.processResult(b,c.key,!0,g)});g=!1;return!0},processResult:function(c,b,a,g){if(this.isExecuting)if(a&&this.stopOnError)this.isExecuting=
!1,this.onProgress&&this.onProgress(1),this.dfd.reject(c);else if(this.results[b]=c,this.completeCount++,this.executeCount--,this.onProgress&&this.onProgress(this.completeCount/this.requestCount),!g)for(;this.tryStartNextRequest(););}});return function(c,b){var a=!1,g=10,k=null;"boolean"===typeof b?a=b:b&&("number"===typeof b.chunkSize&&(g=b.chunkSize),"boolean"===typeof b.stopOnError&&(a=b.stopOnError),"function"===typeof b.onProgress&&(k=b.onProgress));var l,e=[];if(Array.isArray(c))l=[],c.forEach(function(a,
b){e.push({key:b,request:a})});else for(var f in c)l={},e.push({key:f,request:c[f]});return(new d(e,l,g,a,k)).execute()}})},"esri/dijit/geoenrichment/ReportPlayer/core/infographics/InfographicTypes":function(){define(["dojo/_base/lang"],function(h){var f={STATIC:"static",ATTACHMENTS:"attachments",AREA_DETAILS:"areaDetails",INTERESTING_FACTS:"interestingFacts",LOCATOR_TABLE:"locatorTable",COMPARISON_TABLE:"comparisonTable"},e={AGE_PYRAMID:"AgePyramid",ONE_VAR:"OneVar",RELATED_VARS:"RelatedVariables",
TAPESTRY:"Tapestry",PRIZM5:"Prizm5"},d={},c;for(c in e)d[e[c]]=!0;h.mixin(f,e);var b={};for(c in f)b[f[c]]=!0;f.isDynamic=function(a){return d[a]};f.isSupported=function(a){return b[a]};f.isTableLike=function(a){return a===f.AREA_DETAILS||a===f.LOCATOR_TABLE||a===f.COMPARISON_TABLE};f.fixTapestryNameToWidget=function(a){return"TapestryNEW"===a?"Tapestry":a};f.fixTapestryNameToData=function(a){return"Tapestry"===a?"TapestryNEW":a};f.supportsMultiFeature=function(a){return a===f.COMPARISON_TABLE||a===
f.LOCATOR_TABLE||a===f.ATTACHMENTS||a===f.AREA_DETAILS};f.supportsComparison=function(a){return a===f.ONE_VAR||a===f.AGE_PYRAMID||a===f.RELATED_VARS||a===f.COMPARISON_TABLE};f.isDynamicWithFiltering=function(a){return a===f.ONE_VAR||a===f.AGE_PYRAMID||a===f.RELATED_VARS};return f})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/query/TemplateJsonQueryUtil":function(){define(["./_SectionJsonCollector","../../../infographics/InfographicTypes"],function(h,f){var e={},d=
{process:function(c,b,a,g,k){var l=g;g=function(a,b,c){a&&l.apply(this,arguments)};k={processLevel:b,objJson:a,processFunc:g,ignoreComparisonCalculators:k&&k.ignoreComparisonCalculators};c!==b||"field"===c&&"field"===b?"document"===c?d._processTemplateJson(a,k):"section"===c?d._processSectionJson(a,k):"table"===c?d._processTableJson(a,k,null):"tableRow"===c?d._processTableDataObj(a,k,null):"field"===c&&d._processFieldInfo(a,k,null):g(a)},_processTemplateJson:function(c,b){c.sectionsTables?c.sectionsTables.forEach(function(a){d._processTableJson(a,
b)}):h.collectSectionJsons(c,{saveParentInfo:!1,processFieldInfoFunc:function(a){"field"===b.processLevel&&b.processFunc(a)}}).forEach(function(a){d._processSectionJson(a,b)})},_processSectionJson:function(c,b){"section"===b.processLevel&&b.processFunc(c);c.stack&&c.stack.forEach(function(a){"sectionElement"===b.processLevel&&b.processFunc(a);"table"===a.id&&d._processTableJson(a,b)})},_processTableJson:function(c,b,a){"table"===b.processLevel&&b.processFunc(c);c.data.data.forEach(function(c){"tableRow"===
b.processLevel&&b.processFunc(c,a);d._processTableDataObj(c,b,a)});c.backgroundSectionJson&&d._processSectionJson(c.backgroundSectionJson,b);c.foregroundSectionJson&&d._processSectionJson(c.foregroundSectionJson,b);c.backgroundFloatingTablesSectionJson&&d._processSectionJson(c.backgroundFloatingTablesSectionJson,b);c.foregroundFloatingTablesSectionJson&&d._processSectionJson(c.foregroundFloatingTablesSectionJson,b)},_processTableDataObj:function(c,b,a){if(c.fieldInfos)for(var g in c.fieldInfos)d._processFieldInfo(c.fieldInfos[g],
b,a,"tableCell")},_processFieldInfo:function(c,b,a,g){if(c){"field"!==b.processLevel||b.skipVariables&&(c.hasVariable||c.script)||b.processFunc(c,a,g);c.triggerJson&&c.triggerJson.fieldInfo&&c.templateName!==c.triggerJson.fieldInfo.templateName&&d._processFieldInfo(c.triggerJson.fieldInfo,b,c,"trigger");c.dataDrillingPanelInfo&&d._processSectionJson(c.dataDrillingPanelInfo.sectionJson,b);c.tooltipInfo&&c.tooltipInfo.fieldInfo&&d._processFieldInfo(c.tooltipInfo.fieldInfo,b,c,"fieldTooltip");c.linkFieldInfo&&
d._processFieldInfo(c.linkFieldInfo,b,c,"linkFieldInfo");if(c.isRichText)for(var k in c.richTextJson.fieldInfos)d._processFieldInfo(c.richTextJson.fieldInfos[k],b,c,"richTextPart");c.isInfographic&&d._processInfographicFieldInfo(c,b);c.isChart&&d._processChartFieldInfo(c,b);c.isReportSection&&c.sectionJson&&d._processSectionJson(c.sectionJson,b)}},_processInfographicFieldInfo:function(c,b){var a=c.infographicJson;switch(a.type){case f.STATIC:a.header&&d._processTableJson(a.header,b,c);a.variableTables&&
a.variableTables.forEach(function(a){a.variable&&d._processFieldInfo(a.variable.fieldInfo,b,c,"staticInfographicVariable");a.description&&a.description.fieldInfo&&d._processFieldInfo(a.description.fieldInfo,b,c,"staticInfographicDescription")});if(a.dataDrilling)for(var g in a.dataDrilling){var k=a.dataDrilling[g];k&&k.sectionJson&&d._processSectionJson(k.sectionJson,b)}break;case f.AGE_PYRAMID:case f.TAPESTRY:case f.PRIZM5:case f.RELATED_VARS:case f.ONE_VAR:!b.ignoreComparisonCalculators&&a.fieldInfos&&
a.fieldInfos.forEach(function(a){d._processFieldInfo(a,b,c,"dynamicInfographicVariable")});break;case f.AREA_DETAILS:a.titleSectionJson&&d._processSectionJson(a.titleSectionJson,b,c);a.attributesSectionJson&&d._processSectionJson(a.attributesSectionJson,b,c);a.notesSectionJson&&d._processSectionJson(a.notesSectionJson,b,c);break;case f.LOCATOR_TABLE:a.titleSectionJson&&d._processSectionJson(a.titleSectionJson,b);d._processSectionJson(a.headerSectionJson,b);d._processSectionJson(a.dataSectionJson,
b);a.summarySectionJson&&d._processSectionJson(a.summarySectionJson,b);a.summaryFooterSectionJson&&d._processSectionJson(a.summaryFooterSectionJson,b);break;case f.COMPARISON_TABLE:a.titleSectionJson&&d._processSectionJson(a.titleSectionJson,b),b.ignoreComparisonCalculators||d._processSectionJson(a.dataSectionJson,b)}},_processChartFieldInfo:function(c,b){var a=c.chartJson.visualProperties;a.chartIcons&&a.chartIcons.forEach(function(a){d._processFieldInfo(a,b,c,"chartIcon")});a.floatingIcons&&a.floatingIcons.forEach(function(a){d._processTableJson(a,
b,c,"floatingIcon")});a.floatingTexts&&a.floatingTexts.forEach(function(a){d._processTableJson(a,b,c,"floatingText")});b.ignoreComparisonCalculators&&c.chartJson.comparisonInfo&&(b=Object.assign({},b),b.skipVariables=!0);a.tooltip&&a.tooltip.fieldInfo&&d._processFieldInfo(a.tooltip.fieldInfo,b,c,"chartTooltip");c.chartJson.dataDrillingPanelInfo&&d._processSectionJson(c.chartJson.dataDrillingPanelInfo.sectionJson,b);c.chartJson.seriesItems.forEach(function(a){a.points.forEach(function(a){d._processFieldInfo(a.fieldInfo,
b,c,"chartPointField");a.iconFieldInfo&&d._processFieldInfo(a.iconFieldInfo,b,c,"chartPointIcon");a.captionFieldInfo&&d._processFieldInfo(a.captionFieldInfo,b,c,"chartPointCaption")})})}};e.DOCUMENT="document";e.SECTION="section";e.TABLE="table";e.SECTION_ELEMENT="sectionElement";e.TABLE_ROW="tableRow";e.FIELD="field";e.process=d.process;e.processTemplateFieldInfos=function(c,b,a){d.process("document","field",c,b,a)};e.processSectionFieldInfos=function(c,b,a){d.process("section","field",c,b,a)};e.processSectionElements=
function(c,b){d.process("document","sectionElement",c,b)};e.processTableFieldInfos=function(c,b,a){d.process("table","field",c,b,a)};e.processChartFieldInfos=function(c,b){c.seriesItems.forEach(function(a){a.points.forEach(function(a){a.fieldInfo&&b(a.fieldInfo,"series")})});var a=c.visualProperties.tooltip;if(a&&a.fieldInfo&&a.fieldInfo.isRichText)for(var g in a.fieldInfo.richTextJson.fieldInfos)b(a.fieldInfo.richTextJson.fieldInfos[g],"tooltip");c.dataDrillingPanelInfo&&e.processSectionFieldInfos(c.dataDrillingPanelInfo.sectionJson,
function(a){b(a,"dataDrilling")})};e.hasMultiFeatureChart=function(c){var b=!1;e.processTemplateFieldInfos(c,function(a){a.isChart&&(b=b||a.chartJson&&!!a.chartJson.isMultiFeatureChart)});return b};e.hasComparisonInfographicTable=function(c){var b=!1;e.processTemplateFieldInfos(c,function(a){a.isInfographic&&(b=b||a.infographicJson&&a.infographicJson.type===f.COMPARISON_TABLE)});return b};e.isGraphicReport=function(c){return!!c.sectionsTables};e.hasDynamicColumns=function(c){return e._checkTableAttributes(c,
function(b){return 0<b.dynamicColumns})};e.hasDynamicRows=function(c){return e._checkTableAttributes(c,function(b){return 0<b.dynamicRows})};e._checkTableAttributes=function(c,b){var a;e.isGraphicReport(c)?e.processTemplateFieldInfos(c,function(c){c.isReportSection&&c.sectionJson&&c.sectionJson.stack&&c.sectionJson.stack.some(function(c){if("table"===c.id&&c.attributes&&b(c.attributes))return a=!0})}):a=e.collectSectionJsons(c).some(function(a){return a.stack&&a.stack.some(function(a){return"table"===
a.id&&a.attributes&&b(a.attributes)})});return a};e.hasMultiFeatureSections=function(c){return e.isGraphicReport(c)?e.hasMultiFeatureChart(c)||e.hasDynamicColumns(c)||e.hasComparisonInfographicTable(c):!1};e.calcNumberOfMaps=function(c,b){var a=0;e.collectSectionJsons(c).forEach(function(c){a+=e.calcNumberOfMapsInSectionJson(c,b)});return a};e.calcNumberOfMapsInSectionJson=function(c,b){var a=0;c.stack&&c.stack.forEach(function(c){c.isMap&&(b&&b(c),a++)});e.processSectionFieldInfos(c,function(c){c.isMap&&
(b&&b(c.mapJson),a++)});return a};e.calcNumberOfMapsInTableJson=function(c){var b=0;e.processTableFieldInfos(c,function(a){a.isReportSection&&(b+=e.calcNumberOfMapsInSectionJson(a.sectionJson))});return b};e.collectSectionJsons=h.collectSectionJsons;e.getParentBox=h.getParentBox;e.setParentBox=h.setParentBox;e.getParentStyle=h.getParentStyle;return e})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/query/_SectionJsonCollector":function(){define(["dojo/_base/lang","esri/dijit/geoenrichment/utils/MathUtil",
"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/GridDataUtil","../../tableJson/TableJsonUtil"],function(h,f,e,d){var c={},b={provideParentInfo:function(b,c,g,d,e,q){a.collectStatistics(c);var k;a:{switch(e){case "floating":k=c.style.left+q.left;break a;case "page":k=a.calcX(c,g,d)+q.left;break a}k=void 0}a:{switch(e){case "floating":e=c.style.top+q.top;break a;case "page":e=a.calcY(c,g,d)+q.top;break a}e=void 0}b._parentBox={x:k,y:e,w:a.calcFullWidth(c,g,d),h:a.calcFullHeight(c,g,d)};c=
d.field;g.style.fields=g.style.fields||{};g=(g.style.fields[c]=g.style.fields[c]||{}).backgroundColor;b._parentStyle={backgroundColor:g}},sanitize:function(b){a.sanitize(b)}},a={collectStatistics:function(b){if(!b._measureInfo){var c={},g={},k;b.data.columns.forEach(function(a){k&&(g[k.field]=a);k=a;c[a.field]=a});var d={},e={},f={},h={},w={},u={};b.data.data.forEach(function(c,g){b.data.columns.forEach(function(b,k){var l=w[k]||0,m=u[g]||0,q=a._getDataHeight(c,b.field);b=a._getFieldWidth(c,b);l+=
q;m+=b;w[k]=l;u[g]=m;q=k+"_"+g;e[q]=l;d[q]=m;f[q]=d[k-1+"_"+g]||0;h[q]=e[k+"_"+(g-1)]||0})});b._measureInfo={xPositions:f,yPositions:h,columnsHash:c,nextColumnHash:g}}},calcX:function(a,b,c){c=a.data.columns.indexOf(c);b=a.data.data.indexOf(b);return a._measureInfo.xPositions[c+"_"+b]||0},calcY:function(a,b,c){c=a.data.columns.indexOf(c);b=a.data.data.indexOf(b);return a._measureInfo.yPositions[c+"_"+b]||0},calcFullWidth:function(b,c,g){g=g.field;var k=a._getFieldWidth(c,b._measureInfo.columnsHash[g]),
d=c.columnSpans&&c.columnSpans[g]||1;if(1<d)for(var l,e=0;e<d-1;e++)l=b._measureInfo.nextColumnHash[l?l.field:g],k+=a._getFieldWidth(c,l);return k},_getFieldWidth:function(a,b){a.style.fields=a.style.fields||{};return(a.style.fields[b.field]=a.style.fields[b.field]||{}).width||b.style.width},calcFullHeight:function(b,c,g){g=g.field;var k=b.data.data.indexOf(c),d=a._getDataHeight(c,g);c=c.rowSpans&&c.rowSpans[g]||1;if(1<c)for(var l=k+1,e=0;e<c-1;e++)k=b.data.data[l++],d+=a._getDataHeight(k,g);return d},
_getDataHeight:function(a,b){a.style.fields=a.style.fields||{};return(a.style.fields[b]=a.style.fields[b]||{}).height||a.style.height},sanitize:function(a){delete a._measureInfo}},g={getIntersectingTableJsonsBehind:function(a,b,c,g,m){function k(a){var g=a.data.data[0].fieldInfos[a.data.columns[0].field];return e.isTextLikeCell(g)||e.isShapeCell(g)||e.isImageCell(g)?f.checkRectsIntersect([c,{x:a.style.left+b.left,y:a.style.top+b.top,w:d.getTableWidth(a),h:d.getTableHeight(a)}]):!1}function l(a){return f.checkRectsIntersect([c,
{x:a.style.left+b.left,y:a.style.top+b.top,w:a.style.width,h:a.style.height}])}var p=[],n=[];a.backgroundFloatingTablesSectionJson&&a.backgroundFloatingTablesSectionJson.stack.forEach(function(a,b){if(-1===g||m||g!==b)if("table"===a.id&&k(a)||"img"===a.id&&l(a))-1===g||m||g>b?p.push(a):n.push(a)});a.foregroundFloatingTablesSectionJson&&a.foregroundFloatingTablesSectionJson.stack.forEach(function(a,b){if(m&&g===b)return!0;if("table"===a.id&&k(a)||"img"===a.id&&l(a))m&&g>b?p.push(a):n.push(a)});return{elementJsonsBehind:p,
elementJsonsAbove:n}}};c.collectSectionJsons=function(a,b){b=b||{};var g=[];if(!a)return[];if(a.sections)return a.sections;if(!a.sectionsTables)return[];b.processSectionJson=b.processSectionJson||function(){};a.sectionsTables.forEach(function(k,d){var l={addBackground:function(){!1!==b.backgroundForeground&&k.backgroundSectionJson&&k.backgroundSectionJson.stack&&g.push(k.backgroundSectionJson)},addBackgroundTables:function(l){var e=[];!1!==b.floatingTables&&k.backgroundFloatingTablesSectionJson&&
k.backgroundFloatingTablesSectionJson.stack.forEach(function(g,d){"table"===g.id&&c._processTableJson(g,e,"floating",a.documentOptions,b,k,d,!1)});l&&e.reverse();e.forEach(function(a){b.processSectionJson(a,{pageIndex:d,source:"foreground",floatingIndex:a.__floatingIndex});delete a.__floatingIndex});g=g.concat(e)},addInGridSections:function(){var l=[];c._processTableJson(k,l,"page",a.documentOptions,b,k);l.forEach(function(a){b.processSectionJson(a,{pageIndex:d,source:"grid",index:a.__inGridIndex});
delete a.__inGridIndex});g=g.concat(l)},addForegroundTables:function(l){var e=[];!1!==b.floatingTables&&k.foregroundFloatingTablesSectionJson&&k.foregroundFloatingTablesSectionJson.stack.forEach(function(g,d){"table"===g.id&&c._processTableJson(g,e,"floating",a.documentOptions,b,k,d,!0)});l&&e.reverse();e.forEach(function(a){b.processSectionJson(a,{pageIndex:d,source:"foreground",floatingIndex:a.__floatingIndex});delete a.__floatingIndex});g=g.concat(e)},addForeground:function(){!1!==b.backgroundForeground&&
k.foregroundSectionJson&&k.foregroundSectionJson.stack&&g.push(k.foregroundSectionJson)}};b.topFirst?(l.addForeground(),l.addForegroundTables(!0),l.addInGridSections(),l.addBackgroundTables(!0),l.addBackground()):(l.addBackground(),l.addBackgroundTables(),l.addInGridSections(),l.addForegroundTables(),l.addForeground())});return g};c._processTableJson=function(a,c,d,e,m,f,r,t){a.data.data.forEach(function(k,l){k.fieldInfos&&a.data.columns.forEach(function(q,p){var n=k.fieldInfos[q.field];if(n&&n.sectionJson&&
n.sectionJson.stack){m.processFieldInfoFunc&&m.processFieldInfoFunc(n);(!1!==m.saveParentInfo||m.populateWithFloatingElementsBehind)&&b.provideParentInfo(n.sectionJson,a,k,q,d,e);if(m.populateWithFloatingElementsBehind){q=function(a){a=h.clone(a);a.isContextFloatingElement=!0;a.style.left=a.style.left+e.left-u._parentBox.x;if("table"===a.id)a.style.top=a.style.top+e.top-u._parentBox.y;else if("img"===a.id||"map"===a.id)a.style.top=a.style.top+e.top-u._parentBox.y;return a};var u=h.clone(n.sectionJson),
w;"page"===d?w=g.getIntersectingTableJsonsBehind(f,e,u._parentBox,-1,void 0):"floating"===d&&(w=g.getIntersectingTableJsonsBehind(f,e,u._parentBox,r,t));n=w.elementJsonsBehind.map(q);w=w.elementJsonsAbove.map(q);u.stack=n.concat(u.stack);u.stack=u.stack.concat(w);c.push(u)}else c.push(n.sectionJson);w=c[c.length-1];"page"===d?w.__inGridIndex=l*a.data.columns.length+p:w.__floatingIndex=r}})});b.sanitize(a)};c.getParentBox=function(a){return a&&a._parentBox};c.setParentBox=function(a,b){a._parentBox=
b};c.getParentStyle=function(a){return a&&a._parentStyle};return c})},"esri/dijit/geoenrichment/utils/MathUtil":function(){define([],function(){function h(b){return Array.isArray(b)?b:[b.x,b.y]}function f(b){return Array.isArray(b)?b:[b.x,b.y,b.x+b.w,b.y+b.h]}function e(b){return Array.isArray(b)?{x:b[0],y:b[1],w:b[2]-b[0],h:b[3]-b[1]}:b}function d(b){return[[b[0],b[1]],[b[2],b[1]],[b[2],b[3]],[b[0],b[3]],[b[0]+(b[2]-b[0])/2,b[1]+(b[3]-b[1])/2]]}var c={rotatePointAroundPoint:function(b,a,g){g=c.degToRad(g);
var k=h(b),d=h(a);a=Math.cos(g)*(d[0]-k[0])-Math.sin(g)*(d[1]-k[1])+k[0];g=Math.sin(g)*(d[0]-k[0])+Math.cos(g)*(d[1]-k[1])+k[1];return Array.isArray(b)?[a,g]:{x:a,y:g}},degToRad:function(b){return b*Math.PI/180},radToDeg:function(b){return 180*b/Math.PI},cosDeg:function(b){return Math.cos(c.degToRad(b))},sinDeg:function(b){return Math.sin(c.degToRad(b))},angleTo180_180Range:function(b){b=(b+180)%360;0>b&&(b=360+b);return b-180},angleTo0_360Range:function(b){b%=360;0>b&&(b=360+b);return b},calcVectorLength:function(b){var a=
b[0]-b[2];b=b[1]-b[3];return Math.sqrt(a*a+b*b)},addPointToVector:function(b,a){a=h(a);b=b.slice();b[0]+=a[0];b[1]+=a[1];b[2]+=a[0];b[3]+=a[1];return b},subtractPointFromVector:function(b,a){a=h(a);b=b.slice();b[0]-=a[0];b[1]-=a[1];b[2]-=a[0];b[3]-=a[1];return b},putVectorToOrigin:function(b){return c.subtractPointFromVector(b,[b[0],b[1]])},normalizeVector:function(b){b=c.putVectorToOrigin(b);var a=c.calcVectorLength(b);b[2]/=a;b[3]/=a;return b},calcDotProduct:function(b,a){b=c.putVectorToOrigin(b);
a=c.putVectorToOrigin(a);return b[2]*a[2]+b[3]*a[3]},calcAngleBetweenVectors:function(b,a){b=c.normalizeVector(b);a=c.normalizeVector(a);return Math.acos(c.calcDotProduct(b,a))},addLengthToVector:function(b,a){var g=c.calcVectorLength(b),k=[b[0],b[1]];b=c.normalizeVector(b);b[2]*=g+a;b[3]*=g+a;return c.addPointToVector(b,k)},rotateVectorAroundPoint:function(b,a,g){a=h(a);var k=c.rotatePointAroundPoint(a,[b[0],b[1]],g);b=c.rotatePointAroundPoint(a,[b[2],b[3]],g);return[k[0],k[1],b[0],b[1]]},toLineABC:function(b){var a=
b[3]-b[1],c=b[0]-b[2];return[a,c,-a*b[0]-c*b[1]]},intersect2Lines:function(b,a){var g=c.toLineABC(b),k=c.toLineABC(a);a=g[0];b=g[1];var g=g[2],d=k[0],e=k[1],k=k[2],f=a*e-d*b;return 0===f?null:[(k*b-g*e)/f,(d*g-a*k)/f]},intersectLineWithRect:function(b,a){function g(g,k){(g=c.intersect2Lines(b,[g[0],g[1],k[0],k[1]]))&&c.isPointInRect(a,g)&&m.push(g)}var k=d(a),l=k[0],e=k[1],f=k[2],k=k[3],m=[];g(l,e);g(e,f);g(f,k);g(k,l);if(2!==m.length)return null;l=[m[0][0],m[0][1],m[1][0],m[1][1]];return c.calcVectorLength(l)?
l:null},isPointInRect:function(b,a){b=f(b);a=h(a);var c=b[2]-b[0],k=b[3]-b[1];return!(a[0]<b[0]||a[0]>b[0]+c||a[1]<b[1]||a[1]>b[1]+k)},isRectInRect:function(b,a){return c.checkRectsIntersect([b,a])&&d(f(b)).every(function(b){return c.isPointInRect(a,b)})},checkRectsIntersect:function(b){b=b.map(f);return b.every(function(a){var g=d(a);return b.every(function(b){return a===b?!0:g.some(function(a){return c.isPointInRect(b,a)})||d(b).some(function(b){return c.isPointInRect(a,b)})})})},getRotatedRectBox:function(b,
a){var g=!Array.isArray(b);b=f(b);var k=d(b);b=k[0];var l=k[1],p=k[2],n=k[3],k=k[4];b=c.rotatePointAroundPoint(k,b,a);l=c.rotatePointAroundPoint(k,l,a);p=c.rotatePointAroundPoint(k,p,a);n=c.rotatePointAroundPoint(k,n,a);b=c.getPointsExtent([b,l,p,n]);return g?e(b):b},uniteRects:function(b){var a=!Array.isArray(b[0]);b=b.map(f);var g=[];b.forEach(function(a){g=g.concat(d(a))});b=c.getPointsExtent(g);return a?e(b):b},getPointsExtent:function(b){var a=!Array.isArray(b[0]),c=Infinity,k=-Infinity,d=Infinity,
f=-Infinity;b.forEach(function(a){a=h(a);c=Math.min(c,a[0]);k=Math.max(k,a[0]);d=Math.min(d,a[1]);f=Math.max(f,a[1])});b=[c,d,k,f];return a?e(b):b}};return c})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/GridDataUtil":function(){define(["dojo/_base/lang","../../supportClasses/templateJsonUtils/fieldInfo/FieldLibrary","esri/dijit/geoenrichment/utils/FieldUtil","esri/dijit/geoenrichment/utils/ObjectUtil","esri/dijit/geoenrichment/ReportPlayer/countryConfig"],function(h,f,e,d,c){var b=
{getFieldCellValue:function(a){return a.gridData&&a.gridData[a.column.field]},setFieldCellContent:function(a,b){a.set("value",b);a.gridData[a.column.field]=b},clearFieldInfo:function(a,c){a.fieldInfos&&delete a.fieldInfos[c];a[c]="";b.setNumericDataValue(void 0,a,c)},getNumericCellValue:function(a){return b.getNumericDataValue(a.gridData,a.column.field)},setNumericCellValue:function(a,c){return b.setNumericDataValue(c,a.gridData,a.column.field)},getNumericDataValue:function(a,b){return a&&b&&a[b+
"_numeric"]},setNumericDataValue:function(a,b,c){b[c+"_numeric"]=a},getRenderedValue:function(a,g,k){var l={parentGrid:a,gridData:g,column:k};a=a._getCellRenderer().getRenderedContent(l);if(a.isUnavailableData)return{};var e;"number"!==typeof a.value||isNaN(a.value)?"string"===typeof a.formattedValue&&(l=d.parsePercentOrCurrency(a.formattedValue,c.getCurrencyFormat()),isNaN(l)||(e=l)):e=a.value;"number"!==typeof e&&(e=b.getNumericDataValue(g,k.field));return{numericValue:e,formattedValue:a.formattedValue}},
isEmptyCell:function(a){return!a.get("value")&&!a.gridData[a.column.field]&&!b.getFieldInfo(a)},hasSpans:function(a){return b.getColumnSpan(a)||b.getRowSpan(a)},getColumnSpan:function(a){return a&&a.gridData&&a.gridData.columnSpans&&a.gridData.columnSpans[a.column.field]},getRowSpan:function(a){return a&&a.gridData&&a.gridData.rowSpans&&a.gridData.rowSpans[a.column.field]},getDataColumnSpan:function(a,b){return a&&a.columnSpans&&a.columnSpans[b]},getDataRowSpan:function(a,b){return a&&a.rowSpans&&
a.rowSpans[b]},getFieldInfo:function(a){return a&&a.gridData&&a.column&&a.gridData.fieldInfos&&a.gridData.fieldInfos[a.column.field]},getGridFirstFieldInfo:function(a){return b.getFieldInfo(a.getFirstCell())},setFieldInfo:function(a,b){a.gridData&&(a.gridData.fieldInfos[a.column.field]=b)},provideFieldInfo:function(a){b.setFieldInfo(a,b.getFieldInfo(a)||{});return b.getFieldInfo(a)},getPreservableSettings:function(a){return{triggerJson:b.getConditionalFormatting(a),dataDrilling:b.getDataDrilling(a),
tooltipInfo:b.getTooltipInfo(a)}},setPreservableSettings:function(a,c){b.setConditionalFormatting(a,c&&c.triggerJson);b.setDataDrilling(a,c&&c.dataDrilling);b.setTooltipInfo(a,c&&c.tooltipInfo)},getCellStyle:function(a,c){if(!a||!a.gridData||!a.column)return null;var g=a.gridData.style&&a.gridData.style.fields&&a.gridData.style.fields[a.column.field];!g&&c&&(g={},b.setCellStyle(a,g));return g},getCellThemeStyle:function(a){return a&&a.gridData&&a.column?a.gridData.themeStyle&&a.gridData.themeStyle.fields[a.column.field]:
null},setCellStyle:function(a,b){var c=a.gridData.style=a.gridData.style||{};c.fields=c.fields||{};c.fields[a.column.field]=b},updateCellStyle:function(a,c){a=b.getCellStyle(a,!0);h.mixin(a,c)},copyFieldStyle:function(a,c,k){a=b.getCellStyle(a);c=b.getCellStyle(c,!0);for(var g in k)void 0!==a[g]&&(c[g]=a[g])},getFieldCellUrl:function(a){if(a.gridData&&a.gridData.urls&&a.column)return a.gridData.urls[a.column.field]},setFieldCellUrl:function(a,b){a.gridData&&a.column&&(a.gridData.urls=a.gridData.urls||
{},void 0===b?delete a.gridData.urls[a.column.field]:a.gridData.urls[a.column.field]=b)},getConditionalFormatting:function(a){return(a=b._toFieldInfo(a))&&a.triggerJson},setConditionalFormatting:function(a,c){var g=b.getFieldInfo(a);g.triggerJson=null;if(c){if(a=b.isVariableLikeFieldCell(a))c.fieldInfo=g;c.fieldInfo===g&&(c.fieldInfo=h.clone(c.fieldInfo),delete c.fieldInfo.triggerJson,a&&(delete c.fieldInfo.tooltipInfo,delete c.fieldInfo.dataDrillingPanelInfo))}g.triggerJson=c},getDataDrilling:function(a){return(a=
b.getSourceFieldInfo(a))&&a.dataDrillingPanelInfo},setDataDrilling:function(a,c){if(a=b.getSourceFieldInfo(a))a.dataDrillingPanelInfo=c},getTooltipInfo:function(a){return(a=b.getSourceFieldInfo(a))&&a.tooltipInfo},setTooltipInfo:function(a,c){if(a=b.getSourceFieldInfo(a))a.tooltipInfo=c},getSourceFieldInfo:function(a){var c=b._toFieldInfo(a);a=b.getConditionalFormatting(a);return c&&c.isImage?a&&a.fieldInfo:c},_toFieldInfo:function(a){return a?a.gridData?b.getFieldInfo(a):"object"===typeof a&&a:null},
isReportSectionCell:function(a){a=b._toFieldInfo(a);return!(!a||!a.isReportSection)},isInfographicCell:function(a){a=b._toFieldInfo(a);return!(!a||!a.isInfographic)},isChartCell:function(a){a=b._toFieldInfo(a);return!(!a||!a.isChart)},isMapCell:function(a){a=b._toFieldInfo(a);return!(!a||!a.isMap)},isImageCell:function(a){a=b._toFieldInfo(a);return!(!a||!a.isImage)},isImageTriggerCell:function(a){a=b._toFieldInfo(a);return!!(a&&a.isImage&&a.triggerJson)},getImageTriggerFieldInfo:function(a){return(a=
b._toFieldInfo(a))&&a.isImage&&a.triggerJson?a.triggerJson.fieldInfo:null},isShapeCell:function(a){a=b._toFieldInfo(a);return!(!a||!a.isShape)},isEmptyShapeCell:function(a){a=(a=b._toFieldInfo(a))&&a.shapeJson;return!(!a||a.g&&a.g.length)},isPlaceholderShapeCell:function(a){a=(a=b._toFieldInfo(a))&&a.shapeJson;return!(!a||!a.isPlaceholder)},isTextLikeCell:function(a){return!b._toFieldInfo(a)||b.isRichTextCell(a)||b.isVariableLikeFieldCell(a)||b.isSpecialFieldCell(a)},isRichTextCell:function(a){a=
b._toFieldInfo(a);return!(!a||!a.isRichText)},isVariableLikeFieldCell:function(a){a=b._toFieldInfo(a);return!(!a||!a.hasVariable&&!a.script&&"headers.CHART_POINT_VALUE"!==a.name)},isVariableFieldCell:function(a){a=b._toFieldInfo(a);return!(!a||!a.hasVariable)},isScriptFieldCell:function(a){a=b._toFieldInfo(a);return!(!a||!a.script)},isUneditableScript:function(a){a=b._toFieldInfo(a);return!!(a&&a.script&&a.script.isUneditableScript)},isNumericVariableFieldCell:function(a){return(a=b._toFieldInfo(a))?
a.hasVariable&&e.isNumericField(a)||a.script&&!a.script.isUneditableScript&&"String"!==a.script.type||"headers.CHART_POINT_VALUE"===a.name?!0:!1:!1},isCalculatableNumericVariableFieldCell:function(a){return b.isNumericVariableFieldCell(a)},isStringVariableFieldCell:function(a){a=b._toFieldInfo(a);return!(!a||!(a.hasVariable&&"esriFieldTypeString"===a.type||a.script&&"String"===a.script.type))},isSpecialFieldCell:function(a){var c=b._toFieldInfo(a);return c&&("headers.CHART_POINT_VALUE"===c.name||
!b.isVariableLikeFieldCell(a)&&f.hasField(c.name))}};return b})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/fieldInfo/FieldLibrary":function(){define(["dojo/string","dojo/i18n!esri/nls/jsapi"],function(h,f){var e=f.geoenrichment.dijit.ReportPlayer.FieldInfoLabels;f=f.geoenrichment.dijit.ReportPlayer.FieldInfoPreview;e={_SPECIAL_HEADER_FIELDS_NAME_MAP:{SITE_NAME:"SiteName",STORE_ADDR:"SiteAddr",AREA_DESC2:"SiteDesc",STORE_LAT:"Latitude",STORE_LONG:"Longitude",AREA_ID:"AreaID",
AREA_DESC:"AreaDesc",STORE_ID:"StoreID",RING:"Ring",STORE_NAME:"StoreName",GROUPCOUNT:"SummaryCount"},_ADDITIONAL_HEADER_FIELDS_MAP:{SITENOTE:"SiteNote",SITENOTE2:"SiteNote2",SITENOTE3:"SiteNote3",SITENOTE4:"SiteNote4",SITENOTE5:"SiteNote5",SITENOTE6:"SiteNote6",SITENOTE7:"SiteNote7",SITENOTE8:"SiteNote8",SITENOTE9:"SiteNote9",SITENOTE10:"SiteNote10",SITENOTES:"SiteNotes",CHART_AREA_NAME:"ChartAreaName",CHART_SERIES_NAME:"ChartSeriesName",CHART_POINT_NAME:"ChartVariableName",CHART_POINT_VALUE:"ChartVariableValue"},
_REPORT_VAR_FIELDS_MAP:{REPORTNAME:"Title",REPORTTITLE2:"Subtitle",CURRPAGE:"Page",COPYRIGHT:"Copyright",TRIALURLTEXT:"TrialUrlText",PHONENUMBER:"PhoneNumber",PRODUCTURL:"ProductUrl",PRODUCTLABEL:"ProductLabel",SOURCE:"Source",CENSUSYEAR:"CensusYear",CURRENTYEAR:"CurrentYear",FUTUREYEAR:"FutureYear",LATITUDELABEL:"LatitudeLabel",LONGITUDELABEL:"LongitudeLabel",PAGEFORMAT:"PageFormat",BANDFROM0TO1UNIT2:"BandFrom0To1Unit2",RADIUS0UNIT1:"Radius0Unit1",AREADELIMITER:"AreaDelimiter",BANDREGIONFROM0TO1:"BandRegionFrom0To1",
ET_AL:"ET_AL",LINEBUFFERSEGMENTFROM0TO1UNIT2RADIUS:"LineBufferSegmentFrom0To1Unit2Radius",LINEBUFFERRADIUS0UNIT1RADIUS:"LineBufferRadius0Unit1Radius",RINGVALUE0UNIT1RADIUS:"RingValue0Unit1Radius",RINGSVALUES0UNIT1RADII:"RingsValues0Unit1Radii",RINGBUFFERBANDFROM0TO1UNIT2RADIUS:"RingBufferBandFrom0To1Unit2Radius",DRIVETIMEBANDFROM0TO1UNIT2RADIUS:"DriveTimeBandFrom0To1Unit2Radius",RINGBUFFERBANDSBANDS0UNIT1RADII:"RingBufferBandsBands0Unit1Radii",RINGBUFFERBANDRING0UNIT1RADIUS:"RingBufferBandRing0Unit1Radius",
DRIVETIMEBANDBAND0UNIT1RADIUS:"DriveTimeBandBand0Unit1Radius",DRIVETIMESRINGS0UNIT1RADII:"DriveTimesRings0Unit1Radii",DRIVETIMERING0UNIT1RADIUS:"DriveTimeRing0Unit1Radius",DRIVEDISTANCEVALUE0UNIT1RADIUS:"DriveDistanceValue0Unit1Radius",DRIVEDISTANCESRINGS0UNIT1RADII:"DriveDistancesRings0Unit1Radii",DRIVEDISTANCERING0UNIT1RADIUS:"DriveDistanceRing0Unit1Radius"},_SPECIAL_HEADER_FIELDS_NAME_MAP_BACK:{},_ADDITIONAL_HEADER_FIELDS_MAP_BACK:{},_REPORT_VAR_FIELDS_MAP_BACK:{},_PREVIEW:{Title:f.fieldPreviewTitle,
Title_graphic:f.fieldPreviewTitleGraphic,Subtitle:f.fieldPreviewSubtitle,Date:f.fieldPreviewDate,Page:f.fieldPreviewPage,Count:f.fieldPreviewLocationsCount,Copyright:f.fieldPreviewCopyright,TrialUrlText:f.fieldPreviewTrialUrlText,PhoneNumber:f.fieldPreviewPhoneNumber,ProductUrl:f.fieldPreviewProductUrl,ProductLabel:f.fieldPreviewProductLabel,Source:f.fieldPreviewSource,SITE_NAME:f.fieldPreviewSiteName,SITE_NAME_multi:f.fieldPreviewSiteNameMulti,STORE_LAT:f.fieldPreviewLat,STORE_LONG:f.fieldPreviewLong,
AREA_DESC2:f.fieldPreviewAreaDesc2,STORE_ADDR:f.fieldPreviewStoreAddr,AREA_DESC:f.fieldPreviewAreaDesc,CHART_AREA_NAME:f.fieldPreview_chartArea,CHART_SERIES_NAME:f.fieldPreview_seriesName,CHART_POINT_NAME:f.fieldPreview_pointName},_LABELS:{CHART_AREA_NAME:e.chartAreaName,CHART_SERIES_NAME:e.chartSeriesName,CHART_POINT_NAME:e.chartPointName,CHART_POINT_VALUE:e.chartPointValue},DATE_FIELD_NAME:"Date",DATE_FIELD_ALIAS:"Date",DATE_FIELD_DEFAULT_FORMAT:"d-MMMM dd, yyyy",GROUPCOUNT_FIELD_NAME:"SummaryCount",
GROUPCOUNT_FIELD_ALIAS:"SummaryCount",SITENOTES_FIELD_NAME:"SiteNotes",SITENOTES_FIELD_ALIAS:"SiteNotes",init:function(){for(var d in this._SPECIAL_HEADER_FIELDS_NAME_MAP)this._SPECIAL_HEADER_FIELDS_NAME_MAP_BACK[this._SPECIAL_HEADER_FIELDS_NAME_MAP[d].toUpperCase()]=d;for(d in this._ADDITIONAL_HEADER_FIELDS_MAP)this._ADDITIONAL_HEADER_FIELDS_MAP_BACK[this._ADDITIONAL_HEADER_FIELDS_MAP[d].toUpperCase()]=d;for(d in this._REPORT_VAR_FIELDS_MAP)this._REPORT_VAR_FIELDS_MAP_BACK[this._REPORT_VAR_FIELDS_MAP[d].toUpperCase()]=
d},templateToUIHeader:function(d){d=d&&this.trimTemplateHeaderName(d).toUpperCase();return this._SPECIAL_HEADER_FIELDS_NAME_MAP[d]||this._ADDITIONAL_HEADER_FIELDS_MAP[d]},qualifyTemplateHeaderName:function(d){return d&&0!==d.indexOf("headers.")?"headers."+d:d},trimTemplateHeaderName:function(d){if(!d)return d;0===d.indexOf("headers.")&&(d=d.substr(d.indexOf(".")+1));return d},templateToUIReportVar:function(d){d=d&&d.toUpperCase();return this._REPORT_VAR_FIELDS_MAP[d]},uiToTemplate:function(d){d=d&&
d.toUpperCase();return this._SPECIAL_HEADER_FIELDS_NAME_MAP_BACK[d]||this._ADDITIONAL_HEADER_FIELDS_MAP_BACK[d]||this._REPORT_VAR_FIELDS_MAP_BACK[d]},getPreview:function(d,c,b){d=this.trimTemplateHeaderName(d);c&&"Title"===d&&(d+="_graphic");b&&"SITE_NAME"===d&&(d+="_multi");return"SiteNotes"===d?f.fieldPreviewSiteNotes:0===d.indexOf("SiteNote")?h.substitute(f.fieldPreviewSiteNote,{index:d.replace("SiteNote","")||1}):this._PREVIEW[d]},hasField:function(d){return!!(this.uiToTemplate(d)||this.templateToUIHeader(d)||
this.templateToUIReportVar(d))},isAdditionalHeadersField:function(d){d=d&&this.trimTemplateHeaderName(d).toUpperCase();return this._ADDITIONAL_HEADER_FIELDS_MAP[d]},isChartAttribute:function(d){return this.isAdditionalHeadersField(d)&&-1!==d.toUpperCase().indexOf("CHART_")},getSiteNoteFieldNameAt:function(d){return"SiteNote"+(!d||1>=Number(d)?"":d)},getFieldLabel:function(d){d=d&&this.trimTemplateHeaderName(d).toUpperCase();return this._LABELS[d]},getReportVarSelfTagsMap:function(){return{Page:"currPage",
Title:"reportName",Subtitle:"reportTitle2"}},getReportVarTextTagsMap:function(){var d=this.getReportVarSelfTagsMap(),c={},b;for(b in this._REPORT_VAR_FIELDS_MAP){var a=this._REPORT_VAR_FIELDS_MAP[b];d[a]||(c[a]=a)}return c}};e.init();return e})},"esri/dijit/geoenrichment/utils/FieldUtil":function(){define([],function(){function h(c){return("string"===typeof c?c:c&&c.type)||""}var f={isNumericField:function(c){switch(h(c)){case "esriFieldTypeSmallInteger":case "esriFieldTypeInteger":return"i";case "esriFieldTypeSingle":case "esriFieldTypeDouble":return"f"}return!1},
isStringField:function(c){return"esriFieldTypeString"==h(c)||!1},isDateField:function(c){return"esriFieldTypeDate"==h(c)||!1}},e=/DISTANCE$/;f.isDistanceField=function(c){return e.test(h(c))};var d=/^(SHAPE__Area|SHAPE__Length)$/i;f.canShowField=function(c,b){if(!c||!c.name||"esriFieldTypeOID"===c.type)return!1;if("esriFieldTypeDate"===c.type)return"d";var a=f.isNumericField(c)||f.isStringField(c);if("f"===a&&!1===c.editable&&d.test(c.name))return null;void 0===b&&(b=/^(OBJECTID|OID|FID)$/i);return b&&
b.test(c.name)?!1:!0===a?"s":a};f.createFieldInfo=function(c){var b=f.canShowField(c);c={fieldName:c.name,label:c.alias||c.name,isEditable:!!c.editable,visible:!!b};switch(b){case "i":c.format={places:0,digitSeparator:!0};break;case "f":c.format={digitSeparator:!0};break;case "s":c.stringFieldOption="textbox"}return c};return f})},"esri/dijit/geoenrichment/utils/ObjectUtil":function(){define(["dojo/number"],function(h){var f={};Math.log10=Math.log10||function(d){return Math.log(d)*Math.LOG10E};f.populateObject=
function(d,c,b){function a(c,k){function g(g){var d=c[g],l=k[g],e=d&&"object"===typeof d;void 0!==d&&(void 0===l?k[g]=d:l&&"object"===typeof l&&e?a(d,l):b&&(e?(l=k[g]={},a(d,l)):k[g]=c[g]))}if(c&&k&&!(Array.isArray(c)&&!Array.isArray(k)||Array.isArray(k)&&!Array.isArray(c)))if(Array.isArray(c))c.forEach(function(a,b){g(b)});else for(var d in c)g(d)}a(c,d);return d};f.filterByPattern=function(d,c){function b(a,c,d){for(var g in a){var k=a[g],l=c[g];if(Array.isArray(k)){var e=k[0];if(l&&Array.isArray(l)){var f=
d[g]=[];l.forEach(function(a){if(a&&"object"===typeof a){var c=Array.isArray(a)?[]:{};b(e,a,c);f.push(c)}})}}else if("object"===typeof k){if(l&&"object"===typeof l){var h=d[g]={};b(k,l,h)}}else void 0!==l&&(d[g]=l)}}var a={};b(c,d,a);return a};f.traverseObject=function(d,c){for(var b in d){var a=d[b];c(a,b,d);a&&"object"===typeof a&&f.traverseObject(a,c)}};f.copyOwnJsonProperties=function(d,c,b){c=c||{};for(var a in d){var g=d[a];d.hasOwnProperty(a)&&"function"!=typeof g&&(g&&"object"==typeof g&&
b&&(g=b(a,g)),void 0!==g&&(c[a]=g))}return c};f.removeUndefinedProperties=function(d){d&&Object.keys(d).forEach(function(c){void 0===d[c]&&delete d[c]});return d};f.getValue=function(d,c){if("string"!==typeof c)return d;c=c.split(".");for(var b=0;b<c.length;b++)d=d&&d[c[b]];return d};f.setValue=function(d,c,b){if("string"===typeof c&&(c=c.split("."),c.length)){for(var a=0;a<c.length-1;a++)d=d&&d[c[a]];d&&(d[c[c.length-1]]=b)}};f.isNumber=function(d){return!isNaN(parseFloat(d))&&isFinite(d)};f.roundNumber=
function(d,c){return"number"!==typeof d?d:parseFloat(d.toFixed(void 0!==c?c:0))};f.getBestPrecision=function(d){return 0===d?0:Math.max(0,Math.round(Math.log10(3E3/Math.abs(d))))};f.getPlaces=function(d,c){function b(b,c){var k=d.indexOf(b,a);if(0>k)return g;b=d.charAt(k+b.length);return!b||0>c.indexOf(b)?g:k-a}d=+d;if(isNaN(d))return-1;d+="";var a=d.indexOf(".")+1,g=a?d.length-a:0;if(2>=g||!c)return g;c=0;if(!+d.substr(0,a-1))for(;"0"===d.charAt(a);)a++,c++,g--;for(var k=g-1;2<=k;k--){var l=Math.min(b("000000000000000".substr(0,
k),"01234"),b("999999999999999".substr(0,k),"56789"));if(l!==g){g=l;break}}return g+c};f.formatNumber=function(d,c){c="number"===typeof c?{places:c}:c||{};var b=c.places,a={};0<=b?a.places=b:b=-1;d=h.format(d,a);if(c.noSeparator){void 0===e&&(e=h.format(9999,{places:0}).replace(/9/g,""));var a=e,g;if(a)for(;0<=(g=d.indexOf(a));)d=d.substr(0,g)+d.substr(g+1)}if(c.preserveTrailingZeroes||0>=b||!d)return d;for(c=d.length;0<b&&"0"==d.charAt(c-1);)c--,--b||c--;return d.substr(0,c)};f.formatNumberAsCurrency=
function(d,c,b){return c?c.split(";")[0>d?1:0].replace("0",f.formatNumber(Math.abs(d),b)):f.formatNumber(d,b)};var e;f.parseNumber=function(d,c,b,a){if(""===d)return"undefined"!==typeof b?b:NaN;if(null==d||"string"!==typeof d&&isNaN(d))return NaN;d=String(d);if(!d.trim())return void 0!==b?b:NaN;b=h.parse(d,{strict:a});isNaN(b)&&d.trim().length&&(b=a?h.parse(d,{strict:a,locale:"en-US"}):Number(d));return isNaN(b)||void 0===c||0>c?b:h.round(b,c)};f.parsePercentOrCurrency=function(d,c,b,a,g){"string"===
typeof d&&(d=d.replace("%",""),c&&(c=c.split(";")[0].replace("0",""),d=d.replace(c,"")));return f.parseNumber(d,b,a,g)};f.compareEqual=function(d,c,b){return void 0===b?d===c:Number(Number(d).toFixed(b))===Number(Number(c).toFixed(b))};return f})},"esri/dijit/geoenrichment/ReportPlayer/countryConfig":function(){define(["./dataProvider/supportClasses/stdGeographies/StdGeographiesModel"],function(h){function f(){if(!d||!d.hierarchies)return"census";var a=d.hierarchies[0].ID;if(1==d.hierarchies.length)return a;
if(d.defaultDatasetID)for(var b in d.hierarchies){var c=d.hierarchies[b];if(c.datasets&&c.datasets.some(function(a){return a==d.defaultDatasetID})){a=c.ID;break}}return a}var e={},d;e.getCurrentCountry=function(){return d};e.getCountryID=function(){return d&&d.id};e.getCurrencySymbol=function(){return d&&d.currencySymbol||"$"};e.getCurrencyFormat=function(){if(d&&d.currencyFormat)return d.currencyFormat;var a=e.getCurrencySymbol();return a+"0;-"+a+"0"};e.setCountry=function(a){d=a};var c,b;e.getSingleUnits=
function(){return c};e.getPluralUnits=function(){return b};e.setSingleAndPluralUnits=function(a,g){c=a;b=g};var a;e.getHierarchyID=function(){return a};e.setHierarchyID=function(b){a=b||f()};var g;e.getGeographiesModel=function(){return g};e.setGeographiesModel=function(a){g=a};e.reset=function(){g=b=c=a=d=null};e.toJson=function(){return{country:{id:e.getCountryID(),currencySymbol:e.getCurrencySymbol(),currencyFormat:e.getCurrencyFormat()},hierarchy:a,geographiesModel:g&&g.toJson()}};e.fromJson=
function(b){b&&(d=b.country,a=b.hierarchy,g=b.geographiesModel&&new h(b.geographiesModel))};return e})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/tableJson/TableJsonUtil":function(){define(["dojo/_base/lang","../templateJsonUtils/fieldInfo/FieldInfoBuilder","../templateJsonUtils/fieldInfo/FieldLibrary","../../grid/coreUtils/GridDataUtil","esri/dijit/geoenrichment/ReportPlayer/core/sections/SectionTypes"],function(h,f,e,d,c){var b={createTable:function(a){var b=a.numColumns,c=a.numRows,
d=a.width,e=a.widths,n=a.style,m=a.attributes&&a.attributes.fixedColumns,q=a.attributes&&a.attributes.dynamicColumns;if(d)if(e)e=e.map(function(a){return d*Number(a.replace("%",""))/100});else for(var r=d/b,e=[],t=0;t<b;t++)e.push(r);if(e)d||isNaN(Number(e[0]))||(d=0,e.forEach(function(a){d+=a}));else for(r=Number(100/b).toFixed(3)+"%",e=[],t=0;t<b;t++)e.push(r);r=[];for(t=0;t<b;t++)r.push({field:"field"+t,style:{width:e[t]}});for(var e=[],w=!0,u=a.height?a.height/c:a.rowHeight||15.07,v=0;v<c;v++){for(var y=
{style:{height:u,fields:{}},fieldInfos:{}},t=0;t<b;t++){var A="field"+t;!1!==a.useDefaultTheme&&(y.style.fields[A]=h.mixin({horizontalAlign:0===t?"left":"right",overrideStyle:0===v?1<c?!1!==a.useDefaultHeaderTheme?"TableHeader":"Default":void 0:w?"AlternatingRow":"Default"},a.cellParams));q&&t>=m&&0===v&&(y.fieldInfos[A]=f.createFieldInfoFromSpecialFieldName("AREA_DESC"));a.processTableCell&&a.processTableCell(y,A,v,t,a)}e.push(y);w=!w}return{id:"table",attributes:h.mixin({},a.attributes),style:h.mixin({width:d||
772.33},n),data:{columns:r,data:e}}},createSingleCellTable:function(a){a=a||{};var c=b.createTable({numColumns:1,numRows:1,attributes:a.attributes,useDefaultTheme:!1});b.modifyTableJson(c,0,0,a);return c},modifyTableJson:function(a,b,c,d){b=a.data.data[b];c=a.data.columns[c];var g=c.field;d.text&&(b[g]=d.text);d.fieldInfo&&(b.fieldInfos[g]=d.fieldInfo);d.cellStyle&&(b.style.fields[g]=d.cellStyle);d.columnSpan&&(b.columnSpans=b.columnSpans||{},b.columnSpans[g]=d.columnSpan);d.rowSpan&&(b.rowSpans=
b.rowSpans||{},b.rowSpans[g]=d.rowSpan);b.themeStyle=d.themeStyle;d.width&&(a.style.width=d.width,c.style.width=d.width);d.height&&(b.style.height=d.height);void 0!==d.left&&(a.style.left=d.left);void 0!==d.top&&(a.style.top=d.top)},getTableWidth:function(a){return a.style.width},getTableHeight:function(a){var b=0;a.data.data.forEach(function(a){b+=a.style?a.style.height:0});return b},calcTableBox:function(a){return{x:a.style.left||0,y:a.style.top||0,w:b.getTableWidth(a),h:b.getTableHeight(a)}},createDetailsSection:function(a){return{type:c.DETAILS,
stack:[b.createTable(a)]}},createDetailsSectionForFieldInfos:function(a,g){return{type:c.DETAILS,stack:[function(){var c=b.createTable(h.mixin({numColumns:2,numRows:a.length+1},g));c.data.data.forEach(function(b,c){0===c?b.field0=a[0].hasVariable?a[0].fieldCategory:"":(c=a[c-1],b.field0=c.script?c.script.alias:c.hasVariable?c.alias:e.getFieldLabel(c.name)||"",b.fieldInfos.field1=c)});b.provideSpaceAfter(c);return c}()]}},createDetailsSectionForFieldInfoGroups:function(a,g){return{type:c.DETAILS,stack:[function(){var c=
b.createTable(h.mixin({numColumns:a.length+1,numRows:a[0].length+1},g));c.data.data.forEach(function(b,g){c.data.columns.forEach(function(c,d){0!==d&&(0===g?b[c.field]=a[d-1][0].fieldCategory||"":(d=a[d-1][g-1],b.field0=b.field0||(d.script?d.script.alias:d.alias),b.fieldInfos[c.field]=d))})});b.provideSpaceAfter(c);return c}()]}},provideSpaceAfter:function(a,b){a.style.spaceAfter=Math.max(b||0,90-15.07*a.data.data.length)},applyDefaultStyling:function(a){var b=!0;a.data.data.forEach(function(c,g){a.data.columns.forEach(function(a){c.style.fields[a.field].overrideStyle=
0===g?"TableHeader":b?"AlternatingRow":void 0});b=!b})},setTableHeaderStyle:function(a){if(a.style)for(var b in a.style.fields)(a.style.fields[b]=a.style.fields[b]||{}).overrideStyle="TableHeader"},DEFAULT_ROW_HEIGHT:15.07,isEmptyTable:function(a){return a.isGrid?!a.columns||!a.columns.length||!a.store||!a.store.data.length:a.data?!a.data.columns||!a.data.columns.length||!a.data.data||!a.data.data.length:!1},isSingleCelledTable:function(a){return a.isGrid?a.store&&1===a.store.data.length&&a.columns&&
1===a.columns.length:a.data?1===a.data.columns.length||1===a.data.data.length:!1},isMultiDataTable:function(a){return a.isGrid?1<a.columns.length||2<a.store.data.length:a.data?1<a.data.columns.length||2<a.data.data.length:!1},getTableSubtype:function(a){if(!b.isSingleCelledTable(a))return null;a=a.isGrid?a.store.data[0].fieldInfos&&a.store.data[0].fieldInfos[a.columns[0].field]:a.data.data[0].fieldInfos&&a.data.data[0].fieldInfos[a.data.columns[0].field];return d.isTextLikeCell(a)?"isTextLike":a.isImage?
a.triggerJson?"isImage.hasConditionalStyling":"isImage":a.isShape?"isShape":null},tableJsonHasInfographic:function(a){return!!b.getTableJsonInfographic(a)},getTableJsonInfographic:function(a){var b;a.data.data.some(function(a){if(a.fieldInfos)for(var c in a.fieldInfos){var g=a.fieldInfos[c];if(g&&g.isInfographic)return b=g.infographicJson,!0}});return b},getTableJsonFirstFieldInfo:function(a){return a.data.data[0].fieldInfos[a.data.columns[0].field]},tableJsonHasChart:function(a){return a.data.data.some(function(a){if(a.fieldInfos)for(var b in a.fieldInfos){var c=
a.fieldInfos[b];if(c&&c.isChart)return!0}})}};return b})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoBuilder":function(){define(["./utils","dojo/i18n!esri/nls/jsapi"],function(h,f){function e(a){Object.keys(a).forEach(function(b){var c=a[b];void 0!==c&&null!==c||delete a[b]})}f=f.geoenrichment.dijit.ReportPlayer.ReportPlayer;var d={NUMBER:"n/",createFieldInfoFromCalculator:function(a,b,c){if(!a)return null;a=(b="function"===typeof a.getDescriptionWithType?
a:null)?b.variable:a;var g=c&&c.format,d=c&&c.autoformatCurrency,k=c&&c.additionalText,l=c&&c.calculatorName,f=c&&c.defaultDistanceUnits;c=c&&c.summaryType;var t=b&&b.getToggleGroup&&b.getToggleGroup();c={alias:b?b.getDescriptionWithType()||b.getAliasWithType():a.description||a.alias,hasVariable:!0,variableID:a.id,fullName:a.fullName,fieldCategory:a.fieldCategory,vintage:a.vintage,type:a.type,statefulName:t?t.value:"n/"+a.fullName,summaryType:c};b=b?b.getCalcType().charAt(0):"n";c.name=h.name.createFieldNameFromSource(a,
b);g?h.format.setFieldInfoFormat(c,g):(c.decimals=a.precision,c.showCurrency=!(!d||"n"!==b||!a.units||"CURRENCY"!==a.units.toUpperCase()),c.showPercent=!c.showCurrency&&("p"===b||"n"===b&&a.units&&"PCT"===a.units.toUpperCase()),c.useThousandsSeparator=!0);a.isWebMap&&(c.isWebMap=!0,c.webMapFieldName=a.fieldName,c.webMapField=a.field,c.webMapId=a.webMapId,c.layerUrl=a.layerUrl,!g&&a.fieldInfo&&a.fieldInfo.format&&(c.decimals=a.fieldInfo.format.places,c.useThousandsSeparator=!1!==a.fieldInfo.format.digitSeparator));
a.customDataCollection&&(c.isCustomDataCollection=!0,c.customDataCollectionId=a.customDataCollection.id,c.customDataCollectionUrl=a.customDataCollection.url,c.customDataCollectionPortalUrl=a.customDataCollection.portalUrl);a.isSiteAttribute&&(c.isSiteAttribute=!0,c.attribute=a.attribute,c.type=a.attribute.type,!g&&0<a.attribute.places&&(c.decimals=a.attribute.places));a.isDataLayerAttribute&&(c.isDataLayerAttribute=!0,c.layerID=a.layerID,c.layerUrl=a.layerUrl,c.layerName=a.layerName,c.attribute=a.attribute,
c.type=a.attribute.type,!g&&0<a.attribute.decimals&&(c.decimals=a.attribute.decimals),"DISTANCE"===a.attribute.name&&(c.units=a.attribute.units||f||"esriMiles"));"string"===typeof k&&(c.additionalText=k);c.usedFields=a.usedFields;c.expressionText=a.expressionText;h.name.provideQualifiedFieldInfoTemplateName(c,l);e(c);return c},fieldInfoToVariable:function(a){if(!a.hasVariable)return null;var b={id:a.variableID,fullName:a.fullName,fieldCategory:a.fieldCategory,vintage:a.vintage,type:a.type,precision:a.decimals,
usedFields:a.usedFields,expressionText:a.expressionText};a.isWebMap&&(b.isWebMap=!0,b.fieldName=a.webMapFieldName,b.field=a.webMapField,b.webMapId=a.webMapId,b.layerUrl=a.layerUrl);a.isSiteAttribute&&(b.isSiteAttribute=!0,b.attribute=a.attribute);return b},createFieldInfoFromScript:function(a,b){var c=b&&b.format,g=b&&b.additionalText;b=b&&b.calculatorName;a=a||{};a.name=a.name||h.name.DEFAULT_SCRIPT_NAME;a.alias=a.alias||f.scriptNameDefault;a.decimals=Number(a.decimals)||0;var d={};d.name=h.name.createFieldNameFromScript(a);
h.name.provideQualifiedFieldInfoTemplateName(d,b);d.script=a;c?h.format.setFieldInfoFormat(d,c):(d.decimals=Number(a.decimals),d.showCurrency=!1,d.showPercent=!1,d.useThousandsSeparator=!0);"string"===typeof g&&(d.additionalText=g);e(d);return d},createFieldInfoFromImage:function(a,b){return{isImage:!0,imageJson:a,triggerJson:b}},createFieldInfoFromMap:function(a){return{isMap:!0,mapJson:a}},createFieldInfoFromShape:function(a){return{isShape:!0,shapeJson:a}},createFieldInfoFromChart:function(a){return{isChart:!0,
chartJson:a}},createFieldInfoFromInfographic:function(a){return{isInfographic:!0,infographicJson:a}},createFieldInfoFromSection:function(a){return{isReportSection:!0,sectionJson:a}},createFieldInfoFromMissingVariable:function(a,b){return{name:a&&a.substr(a.indexOf(".")+1),templateName:a,isMissing:!0,alias:b}},createFieldInfoForUnsupportedContent:function(){return{isUnsupportedContent:!0}}},c=/^\[\w+\]$/,b=/\[\w+\]/;d.createFieldInfoFromLabel=function(a,k){if("string"!==typeof a)return null;a=a.trim();
var g=c.test(a);if(!k||g){if(!g)return null;a=a.replace(/\[|\]/g,"").toUpperCase();return d.createFieldInfoFromSpecialFieldName(h.fields.uiToTemplate(a))}return b.test(a)?h.richText.createFieldInfoFromRenderedXMLString(a):null};d.createFieldInfoFromSpecialFieldName=function(a,b){if("string"!==typeof a)return null;var c;a=h.fields.trimTemplateHeaderName(a);a=a.toUpperCase();"GROUPCOUNT"===a?c={name:h.fields.GROUPCOUNT_FIELD_NAME,alias:h.fields.GROUPCOUNT_FIELD_ALIAS}:"CURRDATE"===a?c={name:h.fields.DATE_FIELD_NAME,
alias:h.fields.DATE_FIELD_ALIAS,format:b||h.fields.DATE_FIELD_DEFAULT_FORMAT}:"SITENOTES"===a?c={name:h.fields.qualifyTemplateHeaderName(h.fields.SITENOTES_FIELD_NAME),alias:h.fields.SITENOTES_FIELD_ALIAS,type:"esriFieldTypeString"}:0===a.indexOf("SITENOTE")&&(c=h.fields.getSiteNoteFieldNameAt(a.replace("SITENOTE","")),c={name:h.fields.qualifyTemplateHeaderName(c),alias:c,type:"esriFieldTypeString"});if(c)return c;var g=h.fields.templateToUIHeader(a);g?(c={name:h.fields.qualifyTemplateHeaderName(a),
alias:g,type:"esriFieldTypeString"},h.fields.isChartAttribute(a)&&(c.isChartAttribute=!0),"CHART_POINT_VALUE"===a&&(c.type="esriFieldTypeDouble",c.decimals=0,c.useThousandsSeparator=!0,b&&h.format.setFieldInfoFormat(c,b))):(b=h.fields.templateToUIReportVar(a))&&(c={name:b,alias:b,type:"esriFieldTypeString"});c&&(c.templateName=c.name);return c};var a=/_P$/i;d.isFieldInfoInPercentState=function(b){return b?b.statefulName&&("p"===b.statefulName.charAt(0)||a.test(b.statefulName))||b.alias&&-1!==b.alias.indexOf("(%)"):
!1};return d})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/fieldInfo/utils":function(){define(["esri/dijit/geoenrichment/Deferred","require"],function(h,f){var e={},d;e.init=function(){if(d)return d.promise;d=new h;f("./FieldInfoBuilder ./FieldInfoFormatUtil ./FieldInfoNameUtil ./FieldInfoRenderer ./RichTextJsonUtil ./FieldLibrary".split(" "),function(c,b,a,g,k,l){e.builder=c;e.format=b;e.name=a;e.renderer=g;e.richText=k;e.fields=l;d.resolve()});return d.promise};
e.init();return e})},"esri/dijit/geoenrichment/ReportPlayer/core/sections/SectionTypes":function(){define([],function(){return{PAGE_HEADER:"PageHeader",DETAILS_HEADER:"DetailsHeader",DETAILS:"Details",GROUP:"Group",PAGE_FOOTER:"PageFooter",REPORT_FOOTER:"ReportFooter",DATA_SOURCE:"DataSource",EMPTY:"empty",INFOGRAPHIC_HEADER:"InfographicHeader",INFOGRAPHIC_VARIABLE:"InfographicVariable",INFOGRAPHIC_BACKGROUND:"InfographicBackground",INFOGRAPHIC_FOREGROUND:"InfographicForeground",INFOGRAPHIC_ATTRIBUTES:"InfographicAttributes",
INFOGRAPHIC_NOTES:"InfographicNotes",INFOGRAPHIC_SUMMARY:"InfographicSummary",INFOGRAPHIC_SUMMARY_FOOTER:"InfographicSummaryFooter",TABLE_BACKGROUND:"TableBackground",TABLE_FOREGROUND:"TableForeground",TABLE_BACKGROUND_FLOATING_PANELS:"BackgroundFloatingPanels",TABLE_FOREGROUND_FLOATING_PANELS:"ForegroundFloatingPanels",TABLE_FLOATING_PANELS:"FloatingPanels"}})},"esri/dijit/geoenrichment/ReportPlayer/_devConfig":function(){define([],function(){return{logData:!0,showAreaDataUtilUndefinedData:!1,createPlayerCommand:{saveDataJsonAsTextFile:!1,
useTestBuild:!1,configUrl:"https://laci2.esri.com/jenkins/job/report-player-jsapi-pr/lastSuccessfulBuild/artifact/release/reportPlayer/config.js",baseUrl:"https://laci2.esri.com/jenkins/job/report-player-jsapi-pr/lastSuccessfulBuild/artifact/release",mainUrl:"https://laci2.esri.com/jenkins/job/report-player-jsapi-pr/lastSuccessfulBuild/artifact/release/dojo/dojo.js",esriDijitCssUrl:"https://js.arcgis.com/3.31/dijit/themes/claro/claro.css",esriCssUrl:"https://laci2.esri.com/jenkins/job/report-player-jsapi-pr/lastSuccessfulBuild/artifact/release/reportPlayer/reportPlayer.css"},
createPDFCommand:{removeUnicodeChars:!1},preview:{bigValues:!1},charts:{enableEffects:!1},table:{printGridRefresh:!1},emulateErrors:{playerError:!1,contentErrors:!1,themeParseError:!1,metadataParseError:!1,layoutParseError:0,reportContainerRenderError:!1,createReportError:!1,createReportNaN:!1,createReportNull:!1,getMapItemError:!1,emptyDataProviderResponse:!1,emptyTemplateJson:!1}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/_ServerSerializationSupport":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/when esri/dijit/geoenrichment/utils/ImageUtil ./supportClasses/ReportDataProcessor ./supportClasses/tasks/parsers/DataXMLParser ./supportClasses/areas/AnalysisAreaUtil ./supportClasses/areas/AnalysisAreaJsonUtil ./supportClasses/areas/AreasPreprocessor ./supportClasses/GEUtil ../core/supportClasses/ReportTemplateTypes ../core/conversion/PortalToEditorConverter ../core/supportClasses/templateJsonUtils/query/TemplateJsonQueryUtil ./supportClasses/attachments/AttachmentsStoreSerializer ../core/supportClasses/templateJsonUtils/TemplateJsonSerializer ../core/conversion/portalToEditorUtils/variables/PlayerVariableProvider ../core/conversion/portalToEditorUtils/metadata/MetadataFromDataBuilder ../countryConfig".split(" "),
function(h,f,e,d,c,b,a,g,k,l,p,n,m,q,r,t,w,u){return h(null,{reportDataToServerData:function(a){return null},reportDataFromServerData:function(h,y){function v(a,b){B.some(function(a){return"metadata.xml"===a.name})||B.push({name:"metadata.xml",data:w.recoverMetadataFromAreaData(a.areaData,b)})}function z(a,b){h.sites=[];var c={};a.areaData.forEach(function(a){var b=a.headers&&a.headers.data||{};a={name:b.SITE_NAME||b.STORE_NAME||b.AREA_DESC,shortName:b.AREA_DESC,address:b.STORE_ADDR,description:b.AREA_DESC2,
latitude:b.STORE_LAT,longitude:b.STORE_LONG};b=b.STORE_ID||"default";"number"!==typeof c[b]&&(c[b]=h.sites.length,h.sites.push(f.mixin({areas:[]},a)));h.sites[c[b]].areas.push(f.mixin({feature:{attributes:{}}},a))});a.reportInfo.sites&&a.reportInfo.sites.forEach(function(a,c){c=h.sites[c];c.attributes=a.attributes;c.notes=a.notes;c.images=a.images;c.images&&c.images.forEach(function(a){function c(a){return(a=b[a])&&d.base64DataToDataURL(a,"image/png")}a.url=c(a.url);a.thumbnail=c(a.thumbnail)})})}
var D=this;u.reset();var B=h.reportItem.resources,G;if(!Array.isArray(B)){var F=B,B=[],E;for(E in F)B.push({name:E,data:F[E]})}B.forEach(function(a){"theme.css"===a.name&&(a.name="theme.css.txt")});var C=B.filter(function(a){return"report.xml"===a.name})[0],I=B.filter(function(a){return"data.xml"===a.name})[0],J=function(){var a=/.*\.(png|jpg|jpeg)$/i,c=/.*\.(json)$/i,g={},k={};B.forEach(function(b){a.test(b.name)&&(g[b.name]=b.data,"logo.png"===b.name&&(G=d.base64DataToDataURL(b.data,"image/png")));
if(c.test(b.name)){if(-1!==b.data.indexOf("mapOptions")&&-1!==b.data.indexOf("ComparisonResultsLayer.")){var e=JSON.parse(b.data);e.operationalLayers.filter(function(a){a.featureCollection&&a.featureCollection.layers&&(a.featureCollection.layers=a.featureCollection.layers.filter(function(a){return a.id&&0===a.id.indexOf("ComparisonResultsLayer.")?!1:!0}));return!0});b.data=JSON.stringify(e)}k[b.name]=b.data}});var e={},l=C.data.match(/<section[^<>]*query=".+?".*?>/g);l&&l.forEach(function(a){a=a.replace(/.*?query="/,
"");a=a.replace(/".*/,"");e[a]=1});var f={},l=b.parse(I.data,function(a,b,c){return(a=k[b])?(f[c]=1,a):g[b]||b});v(l,{map:f,locator:e});z(l,g);return l}(),K=new t;return e(function(a){var b=C.data.indexOf("\x3csection"),c={isGraphicReport:C.data.indexOf("\x3ctable")<b,isMultiFeature:!1,defaultComparisonZoom:null,type:p.STANDARD,portalJson:{files:B}};return e(n.provideEditorJson(c,{variableProvider:a}),function(){c.templateJson=r.deserialize(c.templateJson);c.isMultiFeature=m.hasMultiFeatureSections(c.templateJson);
delete c.portalJson;return c})}(K),function(b){a.parseSites(h);var d=g.areasFromJson(h.analysisAreas),f=h.combinedAreasInfo&&g.combinedAreasInfoFromJson(h.combinedAreasInfo)||{},m=h.attachmentsProvider&&q.getAttachmentsStoreFromJson(h.attachmentsProvider),n=D._infographicOptionsProvider.getInfographicOptions({analysisAreas:d}),p={isMultiFeature:b.isMultiFeature&&1<d.length,reportTitle:null,templateJson:b.templateJson,reportObject:b,fieldData:{specialTradeAreaCalculatorName:null,runReportTaskIDs:null,
metadata:{},areaData:[],errors:[],reportInfo:null},analysisAreas:d,combinedAreasInfo:f,reverseAnalysisAreasOnMap:!0,infographicOptions:n,attachmentsStore:m,templateVariableProvider:K,customLogo:G,config:{}};a.populateCombinedAreasInfo(p.combinedAreasInfo,p.analysisAreas);k.provideAreasIndexes(p);l.setGeoenrichmentUrl(null);y&&y.forEach(function(a){switch(a){case "Maps":l.addCapability("FormatInfographicsMaps");break;case "ImageUrls":l.addCapability("FormatInfographicsImageUrls")}});return e(c.applyRunReportAndGetDataResults(J,
p)).then(function(){return p})})}})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/ReportDataProcessor":function(){define("esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all esri/dijit/geoenrichment/Deferred ./tasks/EnrichAreasTask ./tasks/RunReportTask ./data/AreaCalculatorsUtil ./data/VariablesUtil ./CustomReportsManager ./stdGeographies/StdGeographiesModel esri/dijit/geoenrichment/utils/DateUtil ../../core/supportClasses/templateJsonUtils/fieldInfo/FieldLibrary ../../core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoNameUtil ../../core/supportClasses/templateJsonUtils/query/TemplateJsonQueryUtil ../../core/supportClasses/templateJsonUtils/TemplateJsonAnalyzer ../../core/infographics/utils/InfographicJsonUtil ../../config ../../countryConfig".split(" "),
function(h,f,e,d,c,b,a,g,k,l,p,n,m,q,r,t,w){return{runReportAndGetData:function(a,b){return f([g.getCustomReportByID(a),b]).then(function(b){var g=b[0];b=b[1];return(new c).execute({portalUrl:a.portalUrl,analysisAreas:a.analysisAreas,countryID:a.countryID,hierarchy:a.hierarchy,report:{reportID:g.reportID,portalUrl:g.templateData.getPortalUrl(!0),modified:g.modified,isMultiFeature:g.isMultiFeature},attachmentsStore:b,cacheResult:t.runReportTask.cacheResult}).then(function(a){return{taskIDs:a.taskIDs,
areaData:a.areaData,reportInfo:a.reportInfo}},function(b){a.fieldData.errors.push(b);return(new e).reject(b)})})},runReportFromVariables:function(c){var g={};c.variables.fullNames.forEach(function(a){var b=n.createFieldNameFromSource(a);g[a.substr(a.indexOf(".")+1)]=b});return(new d).enrichAreas({portalUrl:c.portalUrl,analysisAreas:c.analysisAreas,countryID:c.countryID,hierarchy:c.hierarchy,fields:a.convertForEnrich(c.variables),comparisonLevels:c.comparisonLevels||r.getDefaultLevels()}).then(function(a){var d=
c.analysisAreas.map(function(){return{}});b.addEnrichFeatures(a,g,n.DATA_COLLECTIONS_CALCULATOR_NAME,d);return{areaData:d}},function(a){c.fieldData.errors.push(a);return(new e).reject(a)})},applyRunReportAndGetDataResults:function(a,b){if(a&&a.areaData){var c=b.templateJson;b.fieldData.specialTradeAreaCalculatorName=c.metadata.specialTradeAreaCalculatorName;delete c.metadata;b.fieldData.runReportTaskIDs=a.taskIDs;b.fieldData.areaData=a.areaData;(b.fieldData.reportInfo=a.reportInfo)&&this._populateReportDataFromReportInfo(a.reportInfo,
b);this._reportDataFromAreas(b.analysisAreas,b.fieldData.areaData);this._reportDataFromReport(b.reportObject,b.fieldData,b.combinedAreasInfo);return this._populateReportDataFromAttachmentsStore(b)}},_populateReportDataFromReportInfo:function(a,b){b.reportTitle=b.reportObject.title=b.reportTitle||a.Title||"";a.country&&!w.getCurrentCountry()&&(w.setCountry(a.country),w.setHierarchyID(null));a.stdLevels&&!w.getGeographiesModel()&&w.setGeographiesModel(new k({levels:a.stdLevels}));if(t.updateVariableInfoFromDataXml||
t.isPlayerOnServer){var c=a.variables;m.processTemplateFieldInfos(b.templateJson,function(a){if(a.hasVariable&&a.variableID&&a.templateName){var g=a.templateName.indexOf("."),d=a.templateName.substr(0,g),g=a.templateName.substr(g+1);(d=c[d]&&c[d][g])&&d.alias&&(a.alias=d.alias,a=b.templateVariableProvider.get(a.templateName))&&(a.alias=d.alias,d.vintage&&(a.vintage=d.vintage),d.source&&(a.source=d.source))}})}a=q.collectVariablesStats(b.templateJson);if(a=b.templateVariableProvider.getVariablesDataVintageDescription({usedVariablesCache:a}))b.reportObject.dataVintageDescription=
a},_populateReportDataFromAttachmentsStore:function(a){var c=a.attachmentsStore,g=[];a.analysisAreas.forEach(function(d,k){c.supportsMultipleAreas&&c.setCurrentAnalysisAreaIndex(k);0===k&&g.push(h(c.getNotes(),function(b){b&&b.length&&(a.fieldData.metadata[p.SITENOTES_FIELD_NAME]=b.map(function(a){return a.text}).join("\x3cbr/\x3e\x3cbr/\x3e"),b.forEach(function(b,c){a.fieldData.metadata[p.getSiteNoteFieldNameAt(c+1)]=b.text}))}));g.push(h(c.getAttributes(),function(c){if(!c||!c.length)return null;
var g={attributes:{}};c.forEach(function(a){g.attributes[a.name]=a});(c=a.fieldData.areaData[k])&&b.addFeatureAttributesCalculator(g,c)}))});return f(g)},_reportDataFromAreas:function(a,c){a.forEach(function(a,g){if(g=c[g])b.addFeatureAttributesCalculator(a.feature,g),b.addAreaInfoCalculator(a,g)})},_reportDataFromReport:function(a,b,c){var g=b.metadata;a&&!g.Title&&(g.Title=a.title);g.Subtitle=b.reportInfo&&b.reportInfo.Subtitle||"";g.Source=a.dataVintageDescription||"Esri";g.Date=l.getReportFooterDate();
g.Copyright="\u00a9 "+l.getFullYear()+" Esri";g.ProductLabel="";g.ProductUrl="";g.PhoneNumber="";g.TrialUrlText="";a.isMultiFeature&&(g.SITE_NAME=c.locationName||c.name,g.STORE_NAME=c.locationName||c.name,g.AREA_DESC2=c.description||c.name,g.STORE_ADDR=c.address)}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/tasks/EnrichAreasTask":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all esri/kernel esri/SpatialReference esri/tasks/FeatureSet esri/geometry/Point ../GEUtil ../areas/AnalysisAreaUtil ../attachments/AttributesUtil ../../../core/supportClasses/map/Projector ../../../countryConfig esri/dijit/geoenrichment/utils/CoordinateUtil".split(" "),
function(h,f,e,d,c,b,a,g,k,l,p,n,m,q){function r(a){return(a=a&&c.id.findCredential(a)||c.id.credentials[0])&&a.token}return h(null,{enrichAreas:function(a){var b={};return e(this._analysisAreasToStudyAreas(a.analysisAreas,a.countryID,a.comparisonLevels),function(c){b.studyAreas=c;a.report?b.analysisVariables=[{itemid:a.report.reportID,url:a.report.portalUrl,token:r(a.portalUrl),outFields:["*"]}]:a.fields&&(b.analysisVariables=a.fields);return this._doRunTask(b,a,"enrich")}.bind(this)).then(this._handleFeatureSetsRequest.bind(this))},
createReport:function(a){var b={f:"bin",format:"xml",reportfields:{}};b.report={itemid:a.report.reportID,url:a.report.portalUrl,token:r(a.portalUrl)};return e(this._analysisAreasToStudyAreas(a.analysisAreas,a.countryID,null,a.getAttributes),function(c){b.studyAreas=c;return this._doRunTask(b,a,"createReport")}.bind(this))},_analysisAreasToStudyAreas:function(a,b,c,g){var k=this;c=c&&c.map(function(a){return{layer:a}});return d(a.map(function(a,e){var l;a.geographies&&a.geographies.length?(l=k._studyAreaFromGeographies(a.geographies,
b,!0),a.feature&&a.feature.attributes&&(l.attributes=f.mixin({},l.attributes,a.feature.attributes))):l={attributes:f.mixin({},a.feature.attributes),geometry:a.feature.geometry.toJson()};c&&(l.comparisonLevels=c);return d([k._getStorePointForArea(a),g&&g(a)]).then(function(a){var b=a[0];a=a[1];l.attributes=l.attributes||{};b&&(l.attributes.STORE_LAT=l.attributes.STORE_LAT||b.STORE_LAT,l.attributes.STORE_LONG=l.attributes.STORE_LONG||b.STORE_LONG);l.attributes.STORE_ID=e+"";a&&a.forEach(function(a){l.attributes[a.name]=
p.formatAttributeValueForStudyArea(a)});return l})}))},_getStorePointForArea:function(a){if(a=a.location&&a.location.geometry||a.buffer&&a.buffer.point){a=a instanceof g?a:new g(a);var c=l.geometryToLatLong(a);return c?c:e(n.projectGeometries(a,new b(q.WGS_84_WKID)),function(a){return l.geometryToLatLong(a)})}},createFeatureForGeographies:function(a,b){return this._createFeaturesForGeographies(a,b,!0).then(function(a){return a[0]})},createFeaturesForGeographies:function(a,b){return this._createFeaturesForGeographies(a,
b,!1)},_createFeaturesForGeographies:function(a,c,g){a={returnGeometry:!0,outSR:c.outSR||new b(q.WEB_MERCATOR_WKID),studyAreas:g?[this._studyAreaFromGeographies(a,c.countryID,!0,c.generalizationLevel)]:a.map(function(a){return this._studyAreaFromGeographies([a],c.countryID,!1,c.generalizationLevel)},this),dataCollections:["GlobalIntersect"]};return this._doRunTask(a,c,"enrich").then(this._handleFeatureSetsRequest.bind(this))},_studyAreaFromGeographies:function(a,b,c,g){var d={sourceCountry:b,layer:null,
ids:null},k=null,e=[],l;a.forEach(function(a){if(!a||!a.id)throw Error("Wrong geography.");var b=a.levelId;if(b)if(!k)k=b;else if(c&&k!==b)throw Error("Geographies have different level IDs.");e.push(a.id);a.sourceCountry&&(d.sourceCountry=a.sourceCountry);a.hierarchy&&(d.hierarchy=a.hierarchy);a.attributes&&(l=f.mixin(l||{},a.attributes))});d.layer=k;d.ids=c?[e.join(",")]:e;d.attributes=l;d.generalizationlevel=g;return d},createFeaturesForBuffer:function(a,c){c=c||{};var g={bufferUnits:a.units,bufferRadii:a.radii||
[a.radius],areaType:a.areaType||"RingBuffer"};"NetworkServiceArea"===g.areaType&&(g.travelMode=a.travelMode,g.networkOptions=a.networkOptions);a=a.point||a.polyline;g={returnGeometry:!0,outSR:c.outSR||a.spatialReference||new b(q.WEB_MERCATOR_WKID),dataCollections:["GlobalIntersect"],studyAreasOptions:g,studyAreas:[{geometry:a.toJson?a.toJson():a}]};return this._doRunTask(g,c,"enrich").then(this._handleFeatureSetsRequest.bind(this))},createFeaturesForBuffers:function(a,b){var c={},g=[];a.forEach(function(a){var b;
b=a.point||a.polyline;b=JSON.stringify(b.toJson?b.toJson():b)+";"+a.units+";"+a.areaType+";"+a.travelMode+";"+JSON.stringify(a.networkOptions);var d=c[b];d||(d=c[b]=f.clone(a),delete d.radius,d.radii=[],g.push(d));a.radii?d.radii=d.radii.concat(a.radii):d.radii.push(a.radius)});return d(g.map(function(a){return this.createFeaturesForBuffer(a,b)},this)).then(function(a){var b=[];a.forEach(function(a){b=b.concat(a)});return b})},_doRunTask:function(a,b,c){a=f.mixin({useData:{sourceCountry:b.countryID,
hierarchy:b.hierarchy||m.getHierarchyID()},forStorage:!1},a);return k[c](a)},_handleFeatureSetsRequest:function(b){return(new a(b[0])).features}})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/AttributesUtil":function(){define(["dojo/_base/lang","esri/layers/CodedValueDomain","esri/dijit/geoenrichment/utils/DateUtil","esri/dijit/geoenrichment/utils/ObjectUtil"],function(h,f,e,d){var c={composeAttributesFromFieldInfos:function(b,a){return b&&b.filter(function(a){return a.visible}).map(function(b){var c=
b.fieldName,g=b.label,d=b.format&&b.format.places,e=b.format&&b.format.digitSeparator,f=b.format&&b.format.dateFormat,q=a[b.fieldName];b=(b=b.format)&&b.dateFormat?"esriFieldTypeDate":b&&void 0!==b.places?0<b.places?"esriFieldTypeDouble":"esriFieldTypeInteger":"esriFieldTypeString";return{name:c,alias:g,places:d,digitSeparator:e,dateFormat:f,value:q,type:b,domain:null,length:void 0}})},formatAttributeValue:function(b,a){a=a||{};var c=a.hasOwnProperty("unavailableDataValue")?a.unavailableDataValue:
"";if(!b||null===b.value||void 0===b.value)return c;if(!a.skipFormattedValue&&b.formattedValue&&b.formattedValue!==c)return b.formattedValue;var k=b.domain&&"codedValue"===b.domain.type?new f(b.domain):null;k?(a=k.getName(b.value))||(a=b.value+""):"esriFieldTypeString"===b.type?a=b.value:"esriFieldTypeDate"===b.type?a=e.formatDateShort(b.value):(a=a.format,a=d.formatNumber(b.value,{places:a&&void 0!==a.decimals?a.decimals:b.places,noSeparator:a&&void 0!==a.useThousandsSeparator?!a.useThousandsSeparator:
!1===b.digitSeparator,preserveTrailingZeroes:!0}));return null===a||void 0===a?c:a},formatAttributeValueForStudyArea:function(b){var a;b&&null!==b.value&&void 0!==b.value||(a=!0);a||(a=b.domain&&"codedValue"===b.domain.type||"esriFieldTypeDate"===b.type);return a?c.formatAttributeValue(b):b.value},attributeToJson:function(b){return{name:b.name,alias:b.alias,type:b.type,value:b.value,domain:b.domain&&(b.domain.toJson?b.domain.toJson():h.clone(b.domain)),places:b.places,digitSeparator:b.digitSeparator,
dateFormat:b.dateFormat,length:b.length}},attributeFromJson:function(b){return{name:b.name,alias:b.alias,type:b.type,value:b.value,domain:b.domain,places:b.places,digitSeparator:b.digitSeparator,dateFormat:b.dateFormat,length:b.length}}};return c})},"esri/dijit/geoenrichment/utils/DateUtil":function(){define(["dojo/date/locale","esri/moment"],function(h,f){var e={formatDate:function(d,c){return(d=e.objectToDate(d))?h.format(d,c):""},formatMoment:function(d,c){return(d=e.objectToTime(d))?f(d).format(c):
""},formatDateShort:function(d){return e.formatMoment(d,"L")},formatDateTimeShort:function(d){return e.formatMoment(d,"L LT")},formatLiveTime:function(d){var c=e.formatMoment(d,"l, LT").replace(/\d\d\d\d/,function(b){return b.substr(2)});return c?c+" "+e.formatDate(d,{datePattern:"ZZZZ",selector:"date"}):""},formatTypicalTime:function(d){return e.formatMoment(d,"ddd LT")},parseDateShort:function(d){return(d=+f(d,"L"))?new Date(d):null},getReportFooterDate:function(d){return h.format(d||new Date,{datePattern:"MMMM d, yyyy",
selector:"date"})},getFullYear:function(){return(new Date).getFullYear()},objectToTime:function(d){if(!d)return null;d="string"===typeof d?new Date(d):d;return d.getTime?d.getTime():Number(d)||null},objectToDate:function(d){return d?d.getTime?d:new Date(d):null}};return e})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/map/Projector":function(){define(["dojo/_base/declare","esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when","esri/dijit/geoenrichment/promise/all","esri/dijit/geoenrichment/utils/ProjectionUtil"],
function(h,f,e,d,c){function b(a,b){return c.projectGeometries(a,b)}h=h(null,{_pendingInfos:null,_isBusy:!1,constructor:function(){this._pendingInfos=[]},addForProjection:function(a,b){if(this._isBusy)throw Error("Can't interrupt the current projection process.");a=a&&a.geometry||a;var c=new f;this._pendingInfos.push({geom:a,mapOrSR:b,dfd:c,index:this._pendingInfos.length});return c.promise},project:function(){function a(a){var c=l[a];return e(b(c.geoms,c.mapOrSR),function(a){a.forEach(function(a,
b){b=c.indexMap[b];n[b]=a;k[b].resolve(a)})})}var g=this;if(this._isBusy)throw Error("Can't interrupt the current projection process.");this._isBusy=!0;var k=[],l={};this._pendingInfos.forEach(function(a){k.push(a.dfd);var b=a.geom.type+";"+a.geom.spatialReference.wkid+";"+c.getSpatialReference(a.mapOrSR).wkid,b=l[b]=l[b]||{geoms:[],indexMap:{},mapOrSR:a.mapOrSR};b.geoms.push(a.geom);b.indexMap[b.geoms.length-1]=a.index});this._pendingInfos.length=0;var f=[],n=[],m;for(m in l)f.push(a(m));return d(f).then(function(){g._isBusy=
!1;return n})}});h.needProject=function(a,b){a=a&&a.geometry||a;return a.spatialReference&&a.spatialReference.wkid!==c.getSpatialReference(b).wkid};h.projectGeometries=b;return h})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/tasks/RunReportTask":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/promise/all esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when ./parsers/DataXMLParser ./EnrichAreasTask ../areas/AnalysisAreaJsonUtil esri/dijit/geoenrichment/utils/ArrayUtil esri/dijit/geoenrichment/ReportPlayer/config esri/dijit/geoenrichment/ReportPlayer/_devConfig".split(" "),
function(h,f,e,d,c,b,a,g,k,l,p){var n={_cache:{},_buildKey:function(a){return[a.countryID,a.hierarchy,JSON.stringify(g.areasToJson(a.analysisAreas,{excludeInfoTemplate:!0})),a.report.reportID,a.report.portalUrl,a.report.modified].join("_")},getCopy:function(a){a=this._buildKey(a);return(a=this._cache[a])&&f.clone(a)},copyAndPut:function(a,b){a=this._buildKey(a);this._cache[a]=b&&f.clone(b)},getResults:function(){var a=[],b;for(b in this._cache)a.push(this._cache[b]);return a}},m={execute:function(g){var m=
g.cacheResult&&n.getCopy(g);if(m)return c(m);var m=k.splitArrayToBunches(g.analysisAreas,10),q;return e(m.map(function(k){function e(){var e=f.mixin({},g,{analysisAreas:k});e.getAttributes=function(a){if(!g.attachmentsStore)return null;if(!g.attachmentsStore.supportsMultipleAreas&&q)return q;g.attachmentsStore.supportsMultipleAreas&&g.attachmentsStore.setCurrentAnalysisAreaIndex(g.analysisAreas.indexOf(a));return c(g.attachmentsStore.getAttributes(),function(a){q=q||a;return a})};return(new a).createReport(e).then(function(a){var c=
a&&a.taskID;a=a&&a.result;try{p.emulateErrors.createReportError&&(a={error:{message:"Error test: something crashed on the server!"}});var g;a&&"object"===typeof a&&(g=a.error);if(!g&&"string"===typeof a&&-1!==a.indexOf("{"))try{var k=JSON.parse(a);g=k&&k.error}catch(G){}if(g)if(l.runReportTask.ignoreErrors)a=[];else return(new d).reject(g);var e=b.parse(a);return{taskID:c,areaData:e.areaData,reportInfo:e.reportInfo,originalXML:a,error:g}}catch(G){return(new d).reject(G)}})}return c(e(),function(a){return!a||
a.error?l.runReportTask.secondAttempt?e():a:a},function(a){return l.runReportTask.secondAttempt?e():(new d).reject(a)})})).then(function(a){var b={taskIDs:[],areaData:[],reportInfo:null,originalXMLs:[],errors:[]};a.forEach(function(a){b.taskIDs.push(a.taskID);b.originalXMLs.push(a.originalXML);a.error&&b.errors.push(a.error);b.areaData=b.areaData.concat(a.areaData);b.reportInfo=a.reportInfo});g.cacheResult&&!b.errors.length&&n.copyAndPut(g,b);return b})}};h=h(null,{execute:function(a){console.log("Creating a new report...");
return m.execute(a)}});h.CreateReportResultCache=n;return h})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/tasks/parsers/DataXMLParser":function(){define("esri/units esri/dijit/geoenrichment/utils/FieldUtil esri/dijit/geoenrichment/utils/JsonXmlConverter ../../data/AreaDataUtil ../../../../core/supportClasses/DocumentOptions ./AttrUtil esri/dijit/geoenrichment/ReportPlayer/config esri/dijit/geoenrichment/ReportPlayer/_devConfig".split(" "),function(h,f,e,d,c,b,a,g){function k(a){return a.innerHTML?
a.innerHTML:a.tags&&a.tags.length&&a.tags[0].text||""}function l(a){var b={Title:null,Subtitle:null,country:null,hierarchyId:null,exportSettings:null};a.tags&&a.tags.forEach(function(a){"ReportTitle"===a.name&&(b.Title=k(a));"ReportTitle2"===a.name&&(b.Subtitle=k(a));if("CurrencyFormat"===a.name){a=k(a);var g=a.split(";")[0].replace("0","").trim();b.country={id:null,currencySymbol:g,currencyFormat:a}}else if("ReportLayout"===a.name){var d=b.exportSettings={};a.tags.forEach(function(a){if("Options"===
a.name&&a.attributes)d.addHeader=!!a.attributes.header,d.addDataSource=!!a.attributes.dataSource,d.addFooter=!!a.attributes.footer;else if("Page"===a.name&&a.attributes){d.pageSettings={};var b=a.attributes;if(b.width&&b.height&&b.units){a=Number(b.width);var g=Number(b.height);if(b=b.units===h.MILLIMETERS?"mm":b.units===h.CENTIMETERS?"cm":b.units===h.INCHES?"in":b.units===h.POINTS?"pt":null)d.pageSettings.pagesize=c.combineCustomSizeString(a,g,b)}else b.size&&b.orientation&&(d.pageSettings.pagesize=
b.size.toLowerCase(),d.pageSettings.orientation=b.orientation.toLowerCase())}})}});return b}function p(a){function b(a){g.sites=a.tags.map(function(a){var b={attributes:null,notes:null,images:null};a.tags&&a.tags.forEach(function(a){"Attributes"===a.name&&a.tags&&(b.attributes=a.tags.map(function(a){return{name:a.attributes.Name,alias:a.attributes.Alias,type:a.attributes.Type,value:f.isNumericField(a.attributes.Type)?Number(a.attributes.Value):a.attributes.Value}}));"Notes"===a.name&&a.tags&&(b.notes=
a.tags.map(function(a){return{text:a.attributes.Text}}));"Images"===a.name&&a.tags&&(b.images=a.tags.map(function(a){return{url:a.attributes.Source,thumbnail:a.attributes.Thumbnail,description:a.attributes.Description,imageViewType:null}}))});return b})}function c(a){var b;g.stdLevels=a.tags.map(function(a,c){b=b||a.attributes.Id.substr(0,a.attributes.Id.indexOf("."));return{id:a.attributes.Id,name:a.attributes.Caption,isWholeCountry:a.attributes.IsWholeCountry||0===c}});"US"===b&&(g.countrId="US");
"CAN"===b&&(g.countrId="CA")}var g={sites:null,stdLevels:null,countrId:null};a.tags.forEach(function(a){"StudyAreas"===a.name?b(a):"StandardGeographyLevels"===a.name&&c(a)});return g}function n(c,e){function l(c){if(c=function(c){var d={},l,f,m;c.tags.forEach(function(a){var b=k(a),q=b,n=p[c.name][a.name];"string"===(n&&n.type)?b=String(b):(b=Number(b),isNaN(b)&&(b=q),g.emulateErrors.createReportNaN&&(b=NaN),g.emulateErrors.createReportNull&&(b=null));e&&(b=e(a.name,b,c.name));void 0===d[a.name]&&
(d[a.name]=b);"AREA_ID"===a.name&&(l=b);"IDFNDFIELD"===a.name&&(f=b);"STORE_ID"===a.name&&(m=b)});l=l||f;if(!l&&!m)return null;var h;!l&&m&&(h=Number(m));l&&void 0===q[l]&&(q[l]=n++);b.cleanUpAttrs(d,a.isPlayerOnServer?{STORE_ID:1}:null);return{name:c.name,attrs:d,areaIndex:void 0!==h?h:q[l]}}(c)){var l=f[c.areaIndex]=f[c.areaIndex]||{};l[c.name]?l[c.name].comparisonLevels.push(c.attrs):l[c.name]=d.createCalculator(c.attrs)}}var f=[],q={},n=0,p;c.tags[0].tags.forEach(function(a){"xs:schema"===a.name?
p=m.parseSchema(a):l(a)});return{areaData:f,schemaParseResult:p}}var m={parseSchema:function(a){var b={};a.tags.forEach(function(a){"xs:element"===a.name&&a.attributes&&"ReportData"===a.attributes.name&&e.queryJson(a,"xs:element").filter(function(a){return!!a.tags}).forEach(function(a){var c=b[a.attributes.name]={};e.queryJson(a,"xs:element").forEach(function(a){c[a.attributes.name]={type:"xs:string"===a.attributes.type?"string":"number",alias:a.attributes["msdata:Caption"]||"",vintage:a.attributes["msdata:Vintage"]||
"",source:a.attributes["msdata:Source"]||""}})})});return b}};return{parse:function(a,b){return this._parseDataXmlJson(e.parseXml(a,{saveInnerHTML:!0}),b)},_parseDataXmlJson:function(a,b){if(!a||!a.tags||2>a.tags.length)return[];var c,d,k,e;a.tags.forEach(function(a){"ReportInfo"===a.name?c=l(a):"ReportArea"===a.name?d=p(a):"ReportData"===a.name&&(a=n(a,b),e=a.areaData,k=a.schemaParseResult)});g.logData&&(console.log("DataXMLPareser.js \x3d\x3e areaData:"),console.log(e));d&&(c.country.id=d.countrId,
c.sites=d.sites,c.stdLevels=d.stdLevels);c.variables=k;return{reportInfo:c,areaData:e}}}})},"esri/dijit/geoenrichment/utils/JsonXmlConverter":function(){define(["dojo/_base/declare","./RegExpUtil"],function(h,f){function e(b,c,d,e){return g(d,e)+"\x3c"+b+(c?a(c):"")+"\x3e"+(e?"\n":"")}function d(a,b,c){return g(b,c)+"\x3c/"+a+"\x3e"+(c?"\n":"")}function c(b,c,d,e){return g(d,e)+"\x3c"+b+(c?a(c):"")+" /\x3e"+(e?"\n":"")}function b(a,b,c){a=f.encodeXML(a,!1);return g(b,c)+a+(c?"\n":"")}function a(a){var b=
"",c;for(c in a){var g=a[c];Array.isArray(g)&&(g=g.join(";"));void 0===g||null===g||""===g||"number"===typeof g&&isNaN(g)||(b+=" "+c+'\x3d"'+f.encodeXML(g,!0)+'"')}return b}function g(a,b){if(!b)return"";b="";for(var c=0;c<a;c++)b+="     ";return b}return h(null,{parseJson:function(a,g){function k(a,g){a.text||"#text"===a.name?f+=b(a.text,g,l):a.name&&(a.tags&&a.tags.length?(f+=e(a.name,a.attributes,g,l),a.tags&&a.tags.forEach(function(a){k(a,g+1)}),f+=d(a.name,g,l)):f+=c(a.name,a.attributes,g,l))}
var l=g&&g.prettify,f="";g&&g.addDocumentOptions&&(f+='\x3c?xml version\x3d"1.0" encoding\x3d"utf-8"?\x3e');k(a,0);return f=decodeURIComponent(encodeURIComponent(f).replace("%19",""))},parseXml:function(a,b){function c(a,k){a.name=k.nodeName;b.saveInnerHTML&&(a.innerHTML=k.innerHTML);if(k.attributes&&k.attributes.length){a.attributes={};for(var e=0;e<k.attributes.length;e++){var l=k.attributes[e],m=l.value;if(!0===m||"true"===m)m=!0;else if(!1===m||"false"===m)m=!1;else if(g&&m){var q=Number(m);isNaN(q)||
(m=q)}a.attributes[l.nodeName]=m}}if(k.childNodes&&k.childNodes.length)for(a.tags=[],e=0;e<k.childNodes.length;e++){if(m=l=k.childNodes[e],"#text"!==m.nodeName||(d?m.nodeValue.trim():m.nodeValue))m={},a.tags.push(m),c(m,l)}else"#text"===k.nodeName&&(delete a.name,a.text=f.decodeXML(k.nodeValue))}b=b||{};var g=b.parseNumbers,d=b.ignoreWhiteSpacedTextNodes,d=void 0===d?!0:d,k={},e;a=(new DOMParser).parseFromString(a,"text/xml").childNodes;for(var l=0;l<a.length;l++)if(1===a[l].nodeType){e=a[l];break}e&&
c(k,e);return k},queryTopJson:function(a,b){return this.queryJson(a,b,!0)},queryJson:function(a,b,c){function g(a,k){a.tags&&a.tags.forEach(function(a){(b.test?b.test(a.name):a.name===b)&&d.push(a);c&&0===k||g(a,k+1)})}var d=[];g(a,0);return d},traverseJson:function(a,b){function c(a){g||(!0===b(a)?g=!0:a.tags&&a.tags.forEach(c))}var g=!1;c(a)},getInnerHTML:function(a){return a.innerHTML?a.innerHTML.trim():this.parseJson(a).replace(/^<[^<]*>/,"").replace(/<\/[^<]*>$/,"").trim()},_IS_RICH_RE:/<.+>.*<\/.+>|<br\s*\/>|<\/br>/,
_UNRICH_RE:/<.*?>/g,isRichText:function(a){return(a=String(a))&&this._IS_RICH_RE.test(a)},unrichHTML:function(a){if(!a)return"";a=f.decodeXML(String(a).trim()).replace(this._UNRICH_RE,"");0===a.indexOf("\x3c")&&-1!==a.indexOf("\x3e")&&(a="");return a}})()})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/data/AreaDataUtil":function(){define(["dojo/_base/lang","../../../core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoNameUtil","../../../_devConfig"],function(h,f,e){var d=
{getAreaDataValue:function(c){function b(a){!1!==w&&(u=a[w]);void 0===u&&(u=a[g])}function a(){if(m)b(m);else{var a=l[p];a&&b(a.data)}}var g=c.fieldName,d=c.fieldData,l=c.areaDataObject,p=c.calculatorName,n=c.featureIndex,m=c.featureAttributes,q=c.ignoreMetadata,h=c.isMultiFeature;if(!e.showAreaDataUtilUndefinedData&&g){var t=g.indexOf("."),w=!1;-1!==t&&(w=g.substr(t+1));p||-1===t||(p=g.substr(0,t));n=void 0===n?0:Number(n)||0;if((l=c.areaDataObject||d.areaData[n])||m){var u;h&&p===f.AREA_ATTRIBUTES_CALCULATOR_NAME&&
!q&&d&&b(d.metadata);void 0===u&&a();if(p)return u;void 0===u&&!q&&d&&b(d.metadata);if(void 0===u&&!m)for(var v in l)if(b(l[v].data),void 0!==u)break;return u}}},getAreaDataObjectCalculator:function(c,b,a){if(!c)return null;var g=c[b];!g&&a&&(g=c[b]=d.createCalculator());return g},createCalculator:function(c,b){return{data:c||{},comparisonLevels:b||[]}},combineAreaDataObjectCalculators:function(c,b,a){var g=[],k=[];c.forEach(function(a){if(a=d.getAreaDataObjectCalculator(a,b))g.push(a.data),k=k.concat(a.comparisonLevels)});
a&&a.removeDuplicates&&(k=d.removeDuplicacatedCalcData(k));return{thisAreas:g,comparisonLevels:k}},removeDuplicacatedCalcData:function(c){if(!c.length)return c;var b=[],a={},g=Object.keys(c[0]);c.forEach(function(c){var d=function(a){var b="";g.forEach(function(c){b+=a[c]+";"});return b}(c);a[d]||(a[d]=!0,b.push(c))});return b},setAreaDataValue:function(c,b,a,g,k){k=void 0===k?0:Number(k)||0;d.setAreaDataObjectValue(c,b,a[k],g)},setAreaDataObjectValue:function(c,b,a,g){a&&g&&null!==b&&void 0!==b&&
(d.getAreaDataObjectCalculator(a,g,!0).data[c]=b)},mergeAreaData:function(c,b){b.forEach(function(a,b){(b=c[b])&&d.mergeAreaDataObjects(b,a)})},mergeAreaDataObjects:function(c,b){for(var a in c){var g=c[a],d=b[a];d?g.comparisonLevels.length!==d.comparisonLevels.length?console.log("Error: can't merge calculators with different comparison levels!"):(h.mixin(d.data,g.data),g.comparisonLevels.forEach(function(a,b){h.mixin(d.comparisonLevels[b],a)})):b[a]=g}console.log("AreaDataUtil.js merging area data \x3d\x3e areaData");
console.log(b)}};return d})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoNameUtil":function(){define(["esri/dijit/geoenrichment/utils/MaskUtil","./FieldLibrary"],function(h,f){var e={SCRIPT_PREFIX:"",DEFAULT_SCRIPT_NAME:"Custom",TOTAL_SCRIPT_NAME:"Total",AVG_SCRIPT_NAME:"Average",SCRIPT_PREFIX_RE:/^SCRIPT_/i,FIRST_SYMBOL_IS_NUMBER_RE:/^[0-9]/,DATA_COLLECTIONS_CALCULATOR_NAME:"dataCollectionsCalculator",MAPS_CALCULATOR_NAME:"mapsCalculator",UNITED_MAPS_CALCULATOR_NAME:"unitedMapsCalculator",
AREA_ATTRIBUTES_CALCULATOR_NAME:"headers",ENRICHED_DATA_NO_LEVELS:"enrichFieldData_noLevels",SCRIPTS_CALCULATOR_NAME:"scripts",createFieldNameFromSource:function(d,c){if(!d)return"";var b="";d.isSiteAttribute?b=d.attribute.name:d.isChartAttribute?b=d.id:d.isWebMap?b=d.webMapFieldName||d.fieldName:(d=(d.fullName||d).replace(/_|\.|\s/g,""),c=c||"n",d+="n"===c?"":"_"+c,e.FIRST_SYMBOL_IS_NUMBER_RE.test(d)&&(d="_"+d),b=d.toUpperCase());return e._validateName(b)},createFieldNameFromScript:function(d){d=
d.name;e.SCRIPT_PREFIX_RE.test(d)&&(d=d.replace(e.SCRIPT_PREFIX_RE,""));return e._validateName(e.SCRIPT_PREFIX+d.replace(/\.|-/g,""))},_validateName:function(d){return e._checkXMLValidName(e._maskUnicodeInName(d))},_XML_MASK_NAME_RE:/(_X)(\d\d\d\d)/i,_checkXMLValidName:function(d){return e._XML_MASK_NAME_RE.test(d)?d.replace(e._XML_MASK_NAME_RE,"$1_$2"):d},_XML_UNICODE_RE:/&#x|;/ig,_maskUnicodeInName:function(d){return h.maskWithUnicodeXML(d).replace(e._XML_UNICODE_RE,"")},renderScriptName:function(d){return d.replace(e.SCRIPT_PREFIX_RE,
"")},provideQualifiedFieldInfoTemplateName:function(d,c){d&&(d.templateName=c?c+"."+d.name:d.isWebMap?e.AREA_ATTRIBUTES_CALCULATOR_NAME+"."+d.name:d.isSiteAttribute?e.AREA_ATTRIBUTES_CALCULATOR_NAME+"."+d.name:e.DATA_COLLECTIONS_CALCULATOR_NAME+"."+d.name)},getCalculatorName:function(d){return d&&d.templateName&&d.templateName.substr(0,d.templateName.indexOf("."))},isAreaAttributesFieldInfo:function(d){return e.getCalculatorName(d)===e.AREA_ATTRIBUTES_CALCULATOR_NAME},updateCalculatorName:function(d,
c){d&&(d.hasVariable||d.script)&&(d.templateName=c+d.templateName.substr(d.templateName.indexOf(".")))},refreshNameAndTemplateName:function(d){d.statefulName&&d.fullName&&(d.name=e.createFieldNameFromSource(d,d.statefulName.charAt(0)),d.templateName=d.templateName.substr(0,d.templateName.lastIndexOf(".")+1)+d.name)},getFieldInfoAlias:function(d){return d?d.script?d.script.alias:d.hasVariable?d.alias:f.getFieldLabel(d.name):null}};return e})},"esri/dijit/geoenrichment/utils/MaskUtil":function(){define([],
function(){function h(f,e){return"string"!==typeof f?f:String(f).replace(/[^\x20-\x7f]/g,function(d){d=d.charCodeAt(0).toString(16).toUpperCase();return e(d)})}return{maskWithUnicode:function(f){return h(f,function(e){return"\\u000".substr(0,6-e.length)+e})},maskWithUnicodeXML:function(f){return h(f,function(e){return"\x26#x000".substr(0,7-e.length)+e+";"})},removeUnicode:function(f,e){return h(f,function(d){return e||""})},removeXMLMasks:function(f,e){return f.replace(/&#x.*?;/g,e||"")}}})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/DocumentOptions":function(){define(["dojo/_base/lang",
"esri/dijit/geoenrichment/utils/PageUnitsConverter","../themes/ThemeLibrary"],function(h,f,e){var d={},c={a:[[841,1189],[594,841],[420,594],[297,420],[210,297],[148,210],[105,148],[74,105],[52,74],[37,52],[26,37]],b:[[1E3,1414],[707,1E3],[500,707],[353,500],[250,353],[176,250],[125,176],[88,125],[62,88],[44,62],[31,44]],c:[[917,1297],[648,917],[458,648],[324,458],[229,324],[162,229],[114,162],[81,114],[57,81],[40,57],[28,40]],letter:[216,279],legal:[216,356],tabloid:[279,432],ledger:[432,279]};d.PAPER_SIZES=
c;var b={};"a3 a4 a5 b4 b5 c4 c5 letter legal tabloid ledger".split(" ").forEach(function(a){var g;g=2===a.length?c[a[0]][a[1]]:c[a];b[a]={portrait:{w:f.mmToIn(g[0]),h:f.mmToIn(g[1])},landscape:{w:f.mmToIn(g[1]),h:f.mmToIn(g[0])}}});d.SIZE_TYPE_TO_DIM_HASH=b;d.hasStandardSize=function(a){return b[a]};d.getSupportedPageSizes=function(){var a=[],b;for(b in c)1===b.length?c[b].forEach(function(c,g){a.push(b+g)}):a.push(b);return a};d.getPageDim=function(a,c,d){b[a]?a=b[a][c||"portrait"]:(a=a.split("x"),
a={w:f.ptToIn(Number(a[0])),h:f.ptToIn(Number(a[1]))});d&&(a=h.clone(a),f.roundNDigitsObj(a,d.places));return a};d.getPageBox=function(a){if(!a)return null;var b=d.getPageDim(a.pagesize,a.orientation),c=f.inToPx(b.w),b=f.inToPx(b.h);return{w:c,h:b,contentW:c-(a.left||0)-(a.right||0),contentH:b-(a.top||0)-(a.bottom||0)}};d.combineCustomSizeString=function(a,b,c){return f.convert(a,c,"pt",5)+"x"+f.convert(b,c,"pt",5)};d.getDefaultDocumentOptions=function(a){return h.mixin({pagesize:"letter",orientation:"portrait",
left:21.07,right:22.6,top:19.2,bottom:9.6,align:"left",lineSpacing:1.493,fontSize:10,fontFamily:e.DEFAULT_FONT_FAMILY_CLASSIC},a)};d.getDefaultDocumentOptionsGraphicReport=function(a){return h.mixin({pagesize:"letter",orientation:"landscape",left:21.07,right:22.6,top:19.2,bottom:9.6,align:"left",lineSpacing:1.493,fontSize:10,fontFamily:e.DEFAULT_FONT_FAMILY_GRAPHIC},a)};d.getClosestStandrdSizes=function(a,c){function g(a){var b=a.w/e.w;a=a.h/e.h;return Math.max(1-(1<b?1/b:b),1-(1<a?1/a:a))}c=void 0===
c?.4:c;var e=d.getPageDim(a.pagesize,a.orientation);a=[];for(var f in b){var n=b[f];a.push({pagesize:f,orientation:"portrait",score:g(n.portrait)});a.push({pagesize:f,orientation:"landscape",score:g(n.landscape)})}a=a.filter(function(a){return a.score<=c});a.sort(function(a,b){return a.score-b.score});return a};d.tryGetStandardPageSize=function(a,b){function c(a){var c="portrait"===b?1:0;return a["portrait"===b?0:1]===e&&a[c]===n}if(d.SIZE_TYPE_TO_DIM_HASH[a])return a;var g=a.split("x"),e=f.convert(Number(g[0]),
"pt","mm",0),n=f.convert(Number(g[1]),"pt","mm",0),m,q;for(q in d.PAPER_SIZES)if(g=d.PAPER_SIZES[q],1===q.length){if(g.some(function(a,b){if(c(a))return m=q+b,!0}))break}else if(c(g)){m=q;break}return m||a};return d})},"esri/dijit/geoenrichment/utils/PageUnitsConverter":function(){define(["dojo/_base/lang"],function(h){function f(c,b,a){a&&(c=h.mixin({},c));for(var g in c){var d=c[g];null!==d&&""!==d&&"boolean"!=typeof d&&("object"==typeof d?c[g]=f(d,b,a):(d=Number(d),isNaN(d)||(c[g]=b(d))))}return c}
var e={},d="px pt mm cm in twip".split(" ");d.forEach(function(c){d.forEach(function(b){if(c!==b){var a=c+"To"+b.charAt(0).toUpperCase()+b.substr(1);e[a]=function(a,d){return e.convert(a,c,b,void 0!==d?d:5)}}})});e.convert=function(c,b,a,g){c=Number(c)||0;switch(b){case "in":c*=72;break;case "px":c*=.75;break;case "mm":c=c/25.4*72;break;case "cm":c=c/2.54*72;break;case "twip":c/=20}switch(a){case "in":c/=72;break;case "px":c/=.75;break;case "mm":c=c/72*25.4;break;case "cm":c=c/72*2.54;break;case "twip":c=
Math.round(20*c)}void 0!==g&&(c=e.roundNDigits(c,g));return c};e.pxToPtObj=function(c,b){return f(c,e.pxToPt,!b)};e.ptToPxObj=function(c,b){return f(c,e.ptToPx,!b)};e.roundNDigits=function(c,b){return Number(Number(c).toFixed(b))};e.roundNDigitsObj=function(c,b){for(var a in c){var g=c[a];"object"==typeof g?e.roundNDigitsObj(g,b):c[a]=e.roundNDigits(g,b)}};return e})},"esri/dijit/geoenrichment/ReportPlayer/core/themes/ThemeLibrary":function(){define("dojo/_base/lang ./PageBorderStyles ../charts/utils/ChartLineStyles ./ReportThemes ./ThemeUtil esri/dijit/geoenrichment/utils/ObjectUtil dojo/i18n!esri/nls/jsapi".split(" "),
function(h,f,e,d,c,b,a){function g(a){a=a||{};a=a.defaultFontFamilty||"Avenir Next";return{backgroundColor:"#FFFFFF",padding:5,icon:{backgroundColor:"#56a5d8"},highlightedIcon:{backgroundColor:"#D6851A"},iconBarBackground:{backgroundColor:"#AAAAAA",borderColor:"#AAAAAA"},titleLine:{color:"#A8A7A8"},titleStyle:{fontFamily:a,color:"#828282",fontSize:16,backgroundColor:"transparent"},variableLabelStyle:{fontFamily:a,color:"#56a5d8",fontSize:24,backgroundColor:"transparent"},variableLabelStyleHighlighted:{fontFamily:a,
fontSize:24},variableLabelStyleContrast:{fontFamily:a,fontSize:24},variableDescriptionStyle:{fontFamily:a,color:"#828282",fontSize:13,backgroundColor:"transparent"}}}function k(){return{style:f.ALL,lineStyle:"dashed",thickness:1,color:"#b2b2b2"}}function l(a){a=a||{};var b=a.defaultFontFamilty||"Avenir Next",c=a.defaultFontSize||13;return{document:{fontSize:c,fontFamily:b,backgroundImage:{data:null,position:"center",repeat:!1,scale:!0,opacity:1,size:null},border:k()},icon:{backgroundColor:"#56a5d8"},
highlightedIcon:{backgroundColor:"#D6851A"},table:{dataTablePadding:5,tooltip:{color:"#4c4c4c",backgroundColor:"#FFFFFF"},tooltipLink:{color:"#4c4c4c"}},chart:{renderSingleDataSeriesWithSameColor:!0,outlineStyle:e.SOLID,titleStyle:{fontFamily:b,fontSize:16},xAxis:{gridLinesStyle:e.SOLID,axisStyle:{fontFamily:b,fontSize:9},titleStyle:{fontFamily:b,fontSize:c}},yAxis:{gridLinesStyle:e.SOLID,baseLineStyle:e.SOLID,axisStyle:{fontFamily:b,fontSize:9},titleStyle:{fontFamily:b,fontSize:c}},dataLabelsStyle:{fontFamily:b,
fontSize:10},legendStyle:{fontFamily:b,fontSize:10},minMaxLegend:{titleStyle:{fontFamily:b,fontSize:10},minVariableLabelStyle:{fontFamily:b,fontSize:16},maxVariableLabelStyle:{fontFamily:b,fontSize:16}},icon:{backgroundColor:"#56a5d8"},line:{},column:{},bar:{},pie:{},donut:{},ring:{},pictureColumn:{},pictureBar:{},gauge:{dataLabelStyle:{fontFamily:b}},waffle:{dataValueStyle:{fontFamily:b,fontSize:30},dataLabelStyle:{fontFamily:b,fontSize:16}},tooltip:{color:"#4c4c4c",backgroundColor:"#FFFFFF"},tooltipLink:{color:"#4c4c4c"}},
infographic:{staticInfographic:g(a)}}}var p={DEFAULT_FONT_FAMILY_CLASSIC:"Verdana",DEFAULT_FONT_FAMILY_GRAPHIC:"Avenir Next",DEFAULT_FONT_SIZE_CLASSIC:10,DEFAULT_FONT_SIZE_GRAPHIC:13,CHART_DATA_FONT_SIZE:10,defaultStaticInfographic:g(),standardRamps:[{id:d.CLASSIC,colors:["#FFFFFF","#13729F","#DEA429"],additional:{table:{overrideStyles:{Default:{color:"#4C4C4C",backgroundColor:"#FFFFFF"},ReportTitle:{color:"#FFFFFF",backgroundColor:"#00436D"},TableHeader:{color:"#4C4C4C",backgroundColor:"#CCCCCC"},
GreyText:{color:"#AAAAAA",backgroundColor:"#FFFFFF"},BlueText:{color:"#00436D",backgroundColor:"#FFFFFF"},AlternatingRow:{color:"#4C4C4C",backgroundColor:"#EEEEEE"}}},chart:{renderSingleDataSeriesWithSameColor:!1,colors:"#13729F #DEA429 #6A9741 #A75523 #456E35 #D7DF22 #868686 #3C546D #829AB3 #DEDEDE #03406E #B1B1B1".split(" ")}}},{id:d.GRAPHIC,colors:["#FFFFFF","#56A5D8","#D6851A"],additional:{chart:{colors3series:["#56A5D8","#AED6F1","#2874A6"],colors:"#AED6F1 #85C1E9 #5DADE2 #3498DB #2E86C1 #2874A6 #21618C #1B4F72".split(" ")}}},
{id:"red",colors:["#d3d3d3","#8b4513","#ff4500"],additional:{chart:{colors3series:["#8b4513","#F1948A","#E74C3C"],colors:"#8b4513 #F1948A #EC7063 #E74C3C #CB4335 #B03A2E #943126 #78281F".split(" ")}}},{id:"dark",colors:["#6A6A6A","#FFFFFF","#EEEEEE"],additional:{chart:{colors3series:["#FFFFFF","#CACFD2","#A6ACAF"],colors:"#FFFFFF #D7DBDD #CACFD2 #BDC3C7 #A6ACAF #909497 #797D7F #626567 #4d4d4d #3e3e3e #262626".split(" ")}}},{id:"green",colors:["#556b2f","#90ee90","#ffffe0"],additional:{chart:{colors3series:["#E9F7EF",
"#A9DFBF","#27AE60"],colors:"#E9F7EF #A9DFBF #7DCEA0 #52BE80 #27AE60 #229954 #1E8449 #196F3D #145A32".split(" ")}}},{id:"green2",colors:["#FFFFFF","#0B7AC0","#35AC46"],additional:{chart:{colors3series:["#56A5D8","#AED6F1","#2874A6"],colors:"#56A5D8 #AED6F1 #85C1E9 #5DADE2 #3498DB #2E86C1 #2874A6 #21618C #1B4F72".split(" ")}}}]},n={};p.standardRamps.forEach(function(a){var g=h.mixin({},a.additional);g.id=a.id;var k=l({defaultFontFamilty:a.id===d.CLASSIC?"Verdana":"Avenir Next",defaultFontSize:a.id===
d.CLASSIC?10:13});c.applyThemeColorsToTheme({theme:k,colors:a.colors});b.populateObject(k,g,!0);p[a.id]=k;n[a.id]=k});p.TABLE_STYLES="Default ReportTitle TableHeader GreyText BlueText AlternatingRow".split(" ");p.getReportThemeById=function(a){return n[a]};p.isStandardTheme=function(a){return!!n[a]};p.getStandardThemes=function(){return Object.keys(n).map(function(a){return n[a]})};p.getDefaultStaticInfographicSettings=function(){return h.clone(p.defaultStaticInfographic)};p.getDefaultBorderSettings=
function(){return k()};p.getDefaultTheme=function(a){return l(a)};return p})},"esri/dijit/geoenrichment/ReportPlayer/core/themes/PageBorderStyles":function(){define([],function(){var h={NONE:"none",ALL:"all",INNER_ONLY:"innerOnly",OUTER_ONLY:"outerOnly",HORIZONTAL_INNER_ONLY:"horizontalInnerOnly",VERTICAL_INNER_ONLY:"verticalInnerOnly",isSupported:function(f){for(var e in h)if(h[e]===f)return!0;return!1},toSupportedValue:function(f){return h.isSupported(f)?f:h.ALL}};return h})},"esri/dijit/geoenrichment/ReportPlayer/core/charts/utils/ChartLineStyles":function(){define([],
function(){var h={SOLID:"Solid",DASHED:"Dashed",DOTTED:"Dotted",isSupported:function(f){for(var e in h)if(h[e]===f)return!0;return!1},toGFXValue:function(f,e){switch(f){case "Dashed":return 1>e?"LongDash":"Dash";case "Dotted":return 1>e?"Dash":"Dot";default:return"Solid"}}};return h})},"esri/dijit/geoenrichment/ReportPlayer/core/themes/ReportThemes":function(){define([],function(){return{GRAPHIC:"graphic",CLASSIC:"classic",COMPARISON:"comparison"}})},"esri/dijit/geoenrichment/ReportPlayer/core/themes/ThemeUtil":function(){define(["dojo/_base/lang",
"esri/dijit/geoenrichment/utils/ColorUtil","esri/dijit/geoenrichment/utils/ObjectUtil"],function(h,f,e){function d(a){var b=f.isLightColor(a);return f.transform(a,{dv:b?-7:7}).toHex()}var c={getPanelTitleColor:function(a){var b=f.isLightColor(a);return f.transform(a,{dv:b?-50:50}).toHex()},getChartElementBackgroundColor:function(a){var b=f.isLightColor(a);return f.transform(a,{dv:b?-13:13}).toHex()}},b={getThemeColors:function(a){return[a.document.backgroundColor,a.icon.backgroundColor,a.highlightedIcon.backgroundColor]},
generateChartColors:function(a,b,c){c=c||{};var d=c.gradientFactor||1,g=[b,f.transform(b,{dv:-20*d}).toHex(),f.transform(b,{dv:-40*d}).toHex(),f.transform(b,{dv:-50*d}).toHex(),f.transform(b,{dv:-55*d}).toHex(),f.transform(b,{dv:-60*d}).toHex(),f.transform(b,{dv:-65*d}).toHex(),f.transform(b,{dv:-70*d}).toHex()];if(c.numLighterColors)for(var e=0;e<c.numLighterColors;e++)g.unshift(f.transform(b,{dv:20*d*(e+1),ds:-20*(e+1)}).toHex());a&&a!==b&&g.unshift(a);var k={};return g.filter(function(a){return k[a]?
!1:k[a]=!0})},applyThemeColorsToTheme:function(a){var g=a.theme,l=a.colors,p=a.preserveForegroundColor,n=a.chartColors,m=a.colors3series;a=a.preprocessGeneratedThemeFunc;var q=l[0],h=l[1],l=l[2],t=p&&g.chart&&g.chart.dataLabelsStyle&&g.chart.dataLabelsStyle.color||f.getContrastColor(q).toHex(),p=p&&g.document.color||("#FFFFFF"===q.toUpperCase()?"#4C4C4C":t),w=f.isLightColor(q),u=c.getChartElementBackgroundColor(q),v=c.getPanelTitleColor(q),y=f.transform(q,{dv:w?-33:33}).toHex(),A={overrideStyles:{Default:{color:p,
backgroundColor:"transparent"},TableHeader:{color:f.getContrastColor(h,void 0,void 0,200).toHex(),backgroundColor:h},AlternatingRow:{color:p,backgroundColor:f.transform(q,{dv:w?-7:7}).toHex()},ReportTitle:{color:l,backgroundColor:"transparent"},GreyText:{color:y,backgroundColor:"transparent"},BlueText:{color:"#56A5D8",backgroundColor:"transparent"}}},z={lineColor:t,gridLinesColor:t,gridStripesColor:d(q),gridStripesColorAlt:"transparent",axisStyle:{color:t},titleStyle:{color:t}},D={lineColor:t,gridLinesColor:t,
gridStripesColor:d(q),gridStripesColorAlt:"transparent",baseLineColor:t,axisStyle:{color:t},titleStyle:{color:t}},B=f.isLightColor(q),q={document:{color:p,backgroundColor:q,border:{color:y}},icon:{backgroundColor:h},highlightedIcon:{backgroundColor:l},table:A,chart:{backgroundColor:"transparent",outlineColor:void 0,titleStyle:{color:v},dataLabelsAltColor:t,dataLabelsStyle:{color:t},xAxis:z,yAxis:D,legendStyle:{color:t,backgroundColor:"transparent"},minMaxLegend:{titleStyle:{color:t}},comparisonInfo:{lineColor:B?
"#666666":"#BBBBBB"},icon:{backgroundColor:h},ring:{ringBackground:{backgroundColor:u}},gauge:{dataLabelStyle:{color:h},othersColor:u,arrowIndicator:{lineColor:v,backgroundColor:v}},waffle:{dataValueStyle:{color:h},dataLabelStyle:{color:h},othersColor:u},columnBarBackground:{backgroundColor:u}},infographic:{backgroundColor:"transparent",agePyramid:{theme:w?"light":"common",male:{backgroundColor:h},female:{backgroundColor:l}},staticInfographic:{backgroundColor:"transparent",icon:{backgroundColor:h},
highlightedIcon:{backgroundColor:l},iconBarBackground:{},titleLine:{color:f.transform(q,{dv:w?-40:40}).toHex()},titleStyle:{color:v},variableLabelStyle:{color:h},variableLabelStyleHighlighted:{color:l},variableLabelStyleContrast:{color:q},variableDescriptionStyle:{color:f.transform(q,{dv:w?-50:50}).toHex()}}}};a&&a(q);e.populateObject(g,q,!0);g.chart.colors=n&&n.length?n:b.generateChartColors(h,l);g.chart.colors3series=m},applyTextStyleToTheme:function(a,c){function d(a,b){var d=h.mixin({},c);a&&
delete d.color;b||delete d.fontSize;return d}c=b.filterTextStyles(c);var g={document:d(!1,!0),table:{overrideStyles:{Default:d(!1,!0),TableHeader:d(!1,!0),AlternatingRow:d(!1,!0),ReportTitle:d(!1,!0),GreyText:d(!1,!0),BlueText:d(!1,!0)}},chart:{titleStyle:d(),dataLabelsStyle:d(),xAxis:{axisStyle:d(),titleStyle:d()},yAxis:{axisStyle:d(),titleStyle:d()},legendStyle:d(),minMaxLegend:{titleStyle:d(),minVariableLabelStyle:d(!0),maxVariableLabelStyle:d(!0)},gauge:{dataLabelStyle:d()},waffle:{dataValueStyle:d(),
dataLabelStyle:d()}},infographic:{staticInfographic:{titleStyle:d(),variableLabelStyle:d(),variableLabelStyleHighlighted:d(),variableLabelStyleContrast:d(),variableDescriptionStyle:d()}}};e.populateObject(a,g,!0)}},a={fontFamily:1,fontSize:1,fontWeight:1,fontStyle:1,textDecoration:1,color:1};b.filterTextStyles=function(b){var c={},d;for(d in a){var g=b[d];void 0!==g&&(c[d]=g)}return c};return b})},"esri/dijit/geoenrichment/utils/ColorUtil":function(){define(["dojo/_base/Color","dojox/color/_base",
"dojox/color/Palette"],function(h,f,e){function d(b,a,c){return Math.round((b&255)*(1-c)+(a&255)*c)}var c={toCSSColor:function(b,a,d){"string"!==typeof b||/^0x/i.test(b)||(b=h.fromString(b));if(b instanceof h)return a||1===b.a?b.toHex():b.toCss(!0);if(null==b||isNaN(b))return d?c.toCSSColor(d,a):"#000000";b="00000"+Number(b).toString(16);return"#"+b.substr(b.length-6)},toColor:function(b,a){return"object"===typeof b?(new h).setColor(b):h.fromString(c.toCSSColor(b,!1,a))},getCSSColorWithAlpha:function(b,
a){return c.toCSSColor(c.getColorWithAlpha(b,a))},getColorWithAlpha:function(b,a){b=(new h).setColor(b);b.a=a;return b},transform:function(b,a){var c=new e;c.colors=[new h(b)];return c.transform({use:void 0!==a.dl?"hsl":"hsv",dh:a.dh||0,ds:a.ds||0,dv:a.dv||0,dl:a.dl||0}).colors[0]},generateAnalogousColorScheme:function(b,a,c){return e.generators.analogous({base:b,high:a,low:c}).colors},applyColorHue:function(b,a){b=new f.Color(b);a=new f.Color(a);b=b.toHsl();var c=a.toHsl();b=f.fromHsl({h:b.h,s:0===
b.s?0:0===c.s?b.s:c.s,l:c.l});b.a=a.a;return b},getColorParams:function(b){b=new f.Color(b);var a=b.toHsv();a.l=b.toHsl().l;return a},generateGradient:function(b,a){b=b.map(c.toRGBColor);var d=[];if(0===b.length-1||1===a){b=b[0];for(var e=0;e<a;e++)d.push(b);return d}for(var l=1/(a-1),e=0;e<a;e++)d.push(c.getGradientRGBColor(b,e*l));return d},getGradientRGBColor:function(b,a,d){var g=b.length-1,e=1>g||0>=a?0:1<=a?g:-1;if(0<=e)return b[e];a*=g;e=Math.floor(a);e===g&&e--;return c.mixRGBColors(b[e],
b[e+1],a-e,d)},mixRGBColors:function(b,a,c,e){1<c?c=1:0>c&&(c=0);var g=d(b,a,c),k=d(b>>8,a>>8,c),f=d(b>>16,a>>16,c);return((e?d(b>>24,a>>24,c):0)<<24)+(f<<16)+(k<<8)+g},toRGBColor:function(b,a){b=c.toCSSColor(b,!0,a);return parseInt("0x"+b.substr(1))},getContrastColor:function(b,a,d,e){return c.isLightColor(b,e)?c.toColor(a,"#000000"):c.toColor(d,"#FFFFFF")},getHighlightColor:function(b,a){a=a||{};b=new f.Color(b);x=b.toHsl();if("darker"===a.method)x.l=50>x.l?x.l+30:x.l-20,0<x.s&&(x.s+=30);else{var c=
a.saturation||100,d=a.luminosity1||75;a=a.luminosity2||50;0===x.s?x.l=50>x.l?x.l+30:x.l-20:(x.s=c,x.l=x.l<a?d:x.l>d?a:x.l-a>d-x.l?a:d)}a=f.fromHsl(x);a.a=b.a;return a},getLightness:function(b){b=c.toRGBColor(b);return(299*(b>>16&255)+587*(b>>8&255)+114*(b&255))/1E3},isLightColor:function(b,a){return c.getLightness(b)>=(void 0===a?128:a)},colorsEqual:function(b,a){b instanceof h||(b=c.toColor(b));a instanceof h||(a=c.toColor(a));return b.a==a.a&&b.r==a.r&&b.g==a.g&&b.b==a.b},isTransparent:function(b){b=
c.toCSSColor(b);return"rgba(0,0,0,0)"===b.toLowerCase().replace(/\s/g,"")},generateRandomColor:function(b){function a(){return c+Math.round((d-c)*Math.random())}b=b||{};var c=b.min||0,d=b.max||255,e=b.randomizeAlpha?a():1;return b.grayScheme?(b=a(),new h([b,b,b,e])):new h([a(),a(),a(),e])}};return c})},"dojox/color/_base":function(){define(["../main","dojo/_base/lang","dojo/_base/Color","dojo/colors"],function(h,f,e,d){h=f.getObject("color",!0,h);h.Color=e;h.blend=e.blendColors;h.fromRgb=e.fromRgb;
h.fromHex=e.fromHex;h.fromArray=e.fromArray;h.fromString=e.fromString;h.greyscale=d.makeGrey;f.mixin(h,{fromCmy:function(c,b,a){f.isArray(c)?(b=c[1],a=c[2],c=c[0]):f.isObject(c)&&(b=c.m,a=c.y,c=c.c);return new e({r:Math.round(255*(1-c/100)),g:Math.round(255*(1-b/100)),b:Math.round(255*(1-a/100))})},fromCmyk:function(c,b,a,d){f.isArray(c)?(b=c[1],a=c[2],d=c[3],c=c[0]):f.isObject(c)&&(b=c.m,a=c.y,d=c.b,c=c.c);d/=100;return new e({r:Math.round(255*(1-Math.min(1,c/100*(1-d)+d))),g:Math.round(255*(1-Math.min(1,
b/100*(1-d)+d))),b:Math.round(255*(1-Math.min(1,a/100*(1-d)+d)))})},fromHsl:function(c,b,a){f.isArray(c)?(b=c[1],a=c[2],c=c[0]):f.isObject(c)&&(b=c.s,a=c.l,c=c.h);b/=100;for(a/=100;0>c;)c+=360;for(;360<=c;)c-=360;var d,k;120>c?(d=(120-c)/60,k=c/60,c=0):240>c?(d=0,k=(240-c)/60,c=(c-120)/60):(d=(c-240)/60,k=0,c=(360-c)/60);d=2*b*Math.min(d,1)+(1-b);k=2*b*Math.min(k,1)+(1-b);c=2*b*Math.min(c,1)+(1-b);.5>a?(d*=a,k*=a,c*=a):(d=(1-a)*d+2*a-1,k=(1-a)*k+2*a-1,c=(1-a)*c+2*a-1);return new e({r:Math.round(255*
d),g:Math.round(255*k),b:Math.round(255*c)})}});h.fromHsv=function(c,b,a){f.isArray(c)?(b=c[1],a=c[2],c=c[0]):f.isObject(c)&&(b=c.s,a=c.v,c=c.h);360==c&&(c=0);b/=100;a/=100;var d,k,l;if(0==b)k=l=d=a;else{var p=c/60;c=Math.floor(p);var n=p-c,p=a*(1-b),m=a*(1-b*n);b=a*(1-b*(1-n));switch(c){case 0:d=a;k=b;l=p;break;case 1:d=m;k=a;l=p;break;case 2:d=p;k=a;l=b;break;case 3:d=p;k=m;l=a;break;case 4:d=b;k=p;l=a;break;case 5:d=a,k=p,l=m}}return new e({r:Math.round(255*d),g:Math.round(255*k),b:Math.round(255*
l)})};f.extend(e,{toCmy:function(){return{c:Math.round(100*(1-this.r/255)),m:Math.round(100*(1-this.g/255)),y:Math.round(100*(1-this.b/255))}},toCmyk:function(){var c,b=this.r/255,a=this.g/255,d=this.b/255;c=Math.min(1-b,1-a,1-d);return{c:Math.round((1-b-c)/(1-c)*100),m:Math.round((1-a-c)/(1-c)*100),y:Math.round((1-d-c)/(1-c)*100),b:Math.round(100*c)}},toHsl:function(){var c=this.r/255,b=this.g/255,a=this.b/255,d=Math.min(c,a,b),e=Math.max(c,b,a),l=e-d,f=0,n=0,d=(d+e)/2;0<d&&1>d&&(n=l/(.5>d?2*d:2-
2*d));0<l&&(e==c&&e!=b&&(f+=(b-a)/l),e==b&&e!=a&&(f+=2+(a-c)/l),e==a&&e!=c&&(f+=4+(c-b)/l),f*=60);return{h:f,s:Math.round(100*n),l:Math.round(100*d)}},toHsv:function(){var c=this.r/255,b=this.g/255,a=this.b/255,d=Math.max(c,b,a),e=d-Math.min(c,a,b),l=null,f=0==d?0:e/d;0==f?l=0:(l=c==d?60*(b-a)/e:b==d?120+60*(a-c)/e:240+60*(c-b)/e,0>l&&(l+=360));return{h:l,s:Math.round(100*f),v:Math.round(100*d)}}});return h})},"dojox/main":function(){define(["dojo/_base/kernel"],function(h){return h.dojox})},"dojo/colors":function(){define(["./_base/kernel",
"./_base/lang","./_base/Color","./_base/array"],function(h,f,e,d){var c={};f.setObject("dojo.colors",c);var b=function(a,b,c){0>c&&++c;1<c&&--c;var d=6*c;return 1>d?a+(b-a)*d:1>2*c?b:2>3*c?a+(b-a)*(2/3-c)*6:a};h.colorFromRgb=e.fromRgb=function(a,c){var g=a.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(g){a=g[2].split(/\s*,\s*/);var k=a.length,g=g[1];if("rgb"==g&&3==k||"rgba"==g&&4==k)return g=a[0],"%"==g.charAt(g.length-1)?(g=d.map(a,function(a){return 2.56*parseFloat(a)}),4==k&&(g[3]=
a[3]),e.fromArray(g,c)):e.fromArray(a,c);if("hsl"==g&&3==k||"hsla"==g&&4==k){var g=(parseFloat(a[0])%360+360)%360/360,f=parseFloat(a[1])/100,m=parseFloat(a[2])/100,f=.5>=m?m*(f+1):m+f-m*f,m=2*m-f,g=[256*b(m,f,g+1/3),256*b(m,f,g),256*b(m,f,g-1/3),1];4==k&&(g[3]=a[3]);return e.fromArray(g,c)}}return null};var a=function(a,b,c){a=Number(a);return isNaN(a)?c:a<b?b:a>c?c:a};e.prototype.sanitize=function(){this.r=Math.round(a(this.r,0,255));this.g=Math.round(a(this.g,0,255));this.b=Math.round(a(this.b,
0,255));this.a=a(this.a,0,1);return this};c.makeGrey=e.makeGrey=function(a,b){return e.fromArray([a,a,a,b])};f.mixin(e.named,{aliceblue:[240,248,255],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,205],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,
20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,
191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,
205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],mediumaquamarine:[102,205,170],mediumblue:[0,
0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,
238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],
tan:[210,180,140],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]});return e})},"dojox/color/Palette":function(){define(["dojo/_base/lang","dojo/_base/array","./_base"],function(h,f,e){function d(a,b,c){var d=new e.Palette;d.colors=[];f.forEach(a.colors,function(a){d.colors.push(new e.Color({r:Math.min(255,Math.max(0,"dr"==b?a.r+c:a.r)),g:Math.min(255,Math.max(0,"dg"==b?a.g+c:a.g)),b:Math.min(255,
Math.max(0,"db"==b?a.b+c:a.b)),a:Math.min(1,Math.max(0,"da"==b?a.a+c:a.a))}))});return d}function c(a,b,c){var d=new e.Palette;d.colors=[];f.forEach(a.colors,function(a){a=a.toCmy();d.colors.push(e.fromCmy(Math.min(100,Math.max(0,"dc"==b?a.c+c:a.c)),Math.min(100,Math.max(0,"dm"==b?a.m+c:a.m)),Math.min(100,Math.max(0,"dy"==b?a.y+c:a.y))))});return d}function b(a,b,c){var d=new e.Palette;d.colors=[];f.forEach(a.colors,function(a){a=a.toCmyk();d.colors.push(e.fromCmyk(Math.min(100,Math.max(0,"dc"==b?
a.c+c:a.c)),Math.min(100,Math.max(0,"dm"==b?a.m+c:a.m)),Math.min(100,Math.max(0,"dy"==b?a.y+c:a.y)),Math.min(100,Math.max(0,"dk"==b?a.b+c:a.b))))});return d}function a(a,b,c){var d=new e.Palette;d.colors=[];f.forEach(a.colors,function(a){a=a.toHsl();d.colors.push(e.fromHsl(("dh"==b?a.h+c:a.h)%360,Math.min(100,Math.max(0,"ds"==b?a.s+c:a.s)),Math.min(100,Math.max(0,"dl"==b?a.l+c:a.l))))});return d}function g(a,b,c){var d=new e.Palette;d.colors=[];f.forEach(a.colors,function(a){a=a.toHsv();d.colors.push(e.fromHsv(("dh"==
b?a.h+c:a.h)%360,Math.min(100,Math.max(0,"ds"==b?a.s+c:a.s)),Math.min(100,Math.max(0,"dv"==b?a.v+c:a.v))))});return d}e.Palette=function(a){this.colors=[];a instanceof e.Palette?this.colors=a.colors.slice(0):a instanceof e.Color?this.colors=[null,null,a,null,null]:h.isArray(a)?this.colors=f.map(a.slice(0),function(a){return h.isString(a)?new e.Color(a):a}):h.isString(a)&&(this.colors=[null,null,new e.Color(a),null,null])};h.extend(e.Palette,{transform:function(e){var k=d;if(e.use){var f=e.use.toLowerCase();
0==f.indexOf("hs")?k="l"==f.charAt(2)?a:g:0==f.indexOf("cmy")&&(k="k"==f.charAt(3)?b:c)}else if("dc"in e||"dm"in e||"dy"in e)k="dk"in e?b:c;else if("dh"in e||"ds"in e)k="dv"in e?g:a;var f=this,n;for(n in e)"use"!=n&&(f=k(f,n,e[n]));return f},clone:function(){return new e.Palette(this)}});h.mixin(e.Palette,{generators:{analogous:function(a){var b=a.high||60,c=a.low||18;a=(h.isString(a.base)?new e.Color(a.base):a.base).toHsv();var d=Math.max(10,95>=a.s?a.s+5:100-(a.s-95)),g=92<=a.v?a.v-9:Math.max(a.v+
9,20),k=90>=a.v?Math.max(a.v+5,20):95+Math.ceil((a.v-90)/2),r=[d,1<a.s?a.s-1:21-a.s,a.s,d,d],t=[g,k,a.v,g,k];return new e.Palette(f.map([(a.h+c+360)%360,(a.h+Math.round(c/2)+360)%360,a.h,(a.h-Math.round(b/2)+360)%360,(a.h-b+360)%360],function(a,b){return e.fromHsv(a,r[b],t[b])}))},monochromatic:function(a){a=h.isString(a.base)?new e.Color(a.base):a.base;var b=a.toHsv(),c=9<b.s-30?b.s-30:b.s+30,d=b.s,g=20<b.v-20?b.v-20:b.v+60,k=20<b.v-50?b.v-50:b.v+30;return new e.Palette([e.fromHsv(b.h,c,100-.8*(100-
b.v)),e.fromHsv(b.h,d,k),a,e.fromHsv(b.h,c,k),e.fromHsv(b.h,d,g)])},triadic:function(a){a=h.isString(a.base)?new e.Color(a.base):a.base;var b=a.toHsv(),c=(b.h-157+360)%360,d=90<b.s?b.s-10:b.s+10,g=95<b.s?b.s-5:b.s+5,f=20<b.v-20?b.v-20:b.v+20,k=20<b.v-30?b.v-30:b.v+30,t=70<b.v-30?b.v-30:b.v+30;return new e.Palette([e.fromHsv((b.h+57+360)%360,20<b.s?b.s-10:b.s+10,b.v),e.fromHsv(b.h,d,k),a,e.fromHsv(c,d,f),e.fromHsv(c,g,t)])},complementary:function(a){a=h.isString(a.base)?new e.Color(a.base):a.base;
var b=a.toHsv(),c=360>2*b.h+137?2*b.h+137:Math.floor(b.h/2)-137,d=100-.9*(100-b.s),g=Math.min(100,b.s+20),f=20<b.v?b.v-30:b.v+30;return new e.Palette([e.fromHsv(b.h,Math.max(b.s-10,0),Math.min(100,b.v+30)),e.fromHsv(b.h,d,f),a,e.fromHsv(c,g,f),e.fromHsv(c,b.s,b.v)])},splitComplementary:function(a){var b=h.isString(a.base)?new e.Color(a.base):a.base,c=a.da||30;a=b.toHsv();var d=360>2*a.h+137?2*a.h+137:Math.floor(a.h/2)-137,g=(d-c+360)%360,c=(d+c)%360,d=100-.9*(100-a.s),f=Math.min(100,a.s+20),k=20<
a.v?a.v-30:a.v+30;return new e.Palette([e.fromHsv(g,Math.max(a.s-10,0),Math.min(100,a.v+30)),e.fromHsv(g,d,k),b,e.fromHsv(c,f,k),e.fromHsv(c,a.s,a.v)])},compound:function(a){a=h.isString(a.base)?new e.Color(a.base):a.base;var b=a.toHsv(),c=360>2*b.h+18?2*b.h+18:Math.floor(b.h/2)-18,d=360>2*b.h+120?2*b.h+120:Math.floor(b.h/2)-120,g=360>2*b.h+99?2*b.h+99:Math.floor(b.h/2)-99,f=80<b.s-10?b.s-10:b.s+10,k=10<b.s-25?b.s-25:b.s+25,t=80<b.v-20?b.v-20:b.v+20,w=Math.max(b.v,20);return new e.Palette([e.fromHsv(c,
10<b.s-40?b.s-40:b.s+40,10<b.v-40?b.v-40:b.v+40),e.fromHsv(c,f,t),a,e.fromHsv(d,k,w),e.fromHsv(g,f,t)])},shades:function(a){a=h.isString(a.base)?new e.Color(a.base):a.base;var b=a.toHsv(),c=100==b.s&&0==b.v?0:b.s,d=20<=b.v-25?b.v-25:b.v+55,g=20<=b.v-75?b.v-75:b.v+5,f=Math.max(b.v-10,20);return new e.Palette([new e.fromHsv(b.h,c,20<b.v-50?b.v-50:b.v+30),new e.fromHsv(b.h,c,d),a,new e.fromHsv(b.h,c,g),new e.fromHsv(b.h,c,f)])}},generate:function(a,b){if(h.isFunction(b))return b({base:a});if(e.Palette.generators[b])return e.Palette.generators[b]({base:a});
throw Error("dojox.color.Palette.generate: the specified generator ('"+b+"') does not exist.");}});return e.Palette})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/tasks/parsers/AttrUtil":function(){define([],function(){var h={},f="ID OBJECTID AREA_ID STORE_ID HasData aggregationMethod sourceCountry radiusIndex".split(" ");h.cleanUpAttrs=function(e,d){e&&f.forEach(function(c){d&&d[c]||delete e[c]})};return h})},"esri/dijit/geoenrichment/utils/ArrayUtil":function(){define(["dojo/_base/array"],
function(h){var f={},e={}.toString();f.arraysEqual=function(d,c){if(!d&&!c)return!0;if(!d||!c||d.length!==c.length)return!1;for(var b=0;b<d.length;b++)if(d[b]!==c[b])return!1;return!0};f.composeIdentityFunction=function(d,c){var b="function"===typeof d?d:d?function(a){return a[d]}:function(a){return a};return function(a){return(a=b(a))&&a.toString?a.toString():c&&void 0===a?a:String(a)}};f.removeDuplicates=function(d,c){var b=[],a={};c=f.composeIdentityFunction(c,!0);h.forEach(d,function(d,f){var g=
c(d);g===e&&(void 0===d["__ArrayUtil.js_uniqueKey__"]&&(d["__ArrayUtil.js_uniqueKey__"]="__ArrayUtil.js_uniqueKey__"+f),g=d["__ArrayUtil.js_uniqueKey__"]);void 0===g||g in a||(a[g]=d,b.push(d))});return b};f.splitArrayToBunches=function(d,c){c=c||100;for(var b=[],a,g=0,e=d.length;g<e;g++)a&&a.length!==c||(a=[],b.push(a)),a.push(d[g]);return b};return f})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/data/AreaCalculatorsUtil":function(){define(["./AreaDataUtil","../../../core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoNameUtil",
"../tasks/parsers/FeatureSetParser"],function(h,f,e){return{addFeatureAttributesCalculator:function(d,c,b){b=b||f.AREA_ATTRIBUTES_CALCULATOR_NAME;for(var a in d.attributes)h.setAreaDataObjectValue(a,d.attributes[a],c,b)},addAreaInfoCalculator:function(d,c,b){b=b||f.AREA_ATTRIBUTES_CALCULATOR_NAME;h.setAreaDataObjectValue("SITE_NAME",d.locationName||d.name,c,b);h.setAreaDataObjectValue("STORE_NAME",d.locationName||d.name,c,b);h.setAreaDataObjectValue("AREA_DESC",d.shortName||d.name,c,b);h.setAreaDataObjectValue("AREA_DESC2",
d.description||d.name,c,b);h.setAreaDataObjectValue("AREA_DESC3",d.description||d.name,c,b);h.setAreaDataObjectValue("STORE_ADDR",d.address||"",c,b);h.setAreaDataObjectValue("STORE_LAT",d.latitude||"",c,b);h.setAreaDataObjectValue("STORE_LONG",d.longitude||"",c,b)},addEnrichFeatures:function(d,c,b,a){var g={},k={},l;for(l in c)g[l.toLowerCase()]=c[l],k[l.toUpperCase()]=c[l];d=e.parse(d,b||f.ENRICHED_DATA_NO_LEVELS,function(a){return c[a]||g[a.toLowerCase()]||k[a.toUpperCase()]});h.mergeAreaData(d,
a)}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/tasks/parsers/FeatureSetParser":function(){define(["./AttrUtil"],function(h){var f={ID_FIELDS:["ID","AREA_ID","IDFNDFIELD"],KNOWN_ATTRIBUTES:{StdGeographyLevel:1,StdGeographyName:1,StdGeographyID:1},parse:function(e,d,c){if(!e)return[];e=e.features||e;if(!e.length)return[];var b=[],a={},g=0;e.forEach(function(e){var k=e.attributes[f.ID_FIELDS[0]]||e.attributes[f.ID_FIELDS[1]];if(k){void 0===a[k]&&(a[k]=g++);var p={},n;for(n in e.attributes){var m=
f.KNOWN_ATTRIBUTES[n]?n:c?c(n):n;m&&(p[m]=e.attributes[n])}h.cleanUpAttrs(p);e={name:d,attrs:p,areaIndex:a[k]}}else e=null;e&&(k=b[e.areaIndex]=b[e.areaIndex]||{},k[e.name]?k[e.name].comparisonLevels.push(e.attrs):k[e.name]={data:e.attrs,comparisonLevels:[]})});console.log("FeatureSetPareser.js \x3d\x3e areaData:");console.log(b);return b}};return f})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/data/VariablesUtil":function(){define(["../dataCollections/DataCollectionsLoader"],
function(h){var f={preprocessVariables:function(e,d){var c=f.convertForEnrich(f._splitVariables(e)).filter(function(b){return b.itemid});return h.loadCustomDataVariables(c,{forceLowerCase:!0,portalUrl:d}).then(function(b){return f._splitVariables(e,b)})},_splitVariables:function(e,d){var c=[],b={};e.forEach(function(a){"string"===typeof a?c.push(a.toLowerCase()):a&&a.outFields&&a.outFields.forEach(function(g,e){e=a.itemid+"."+g;e=e.toLowerCase();c.push(e);b[e]={itemid:a.itemid,url:a.url,token:a.token,
variable:d?d.fullNameToVariableCache[e]:{id:g}}})});return{fullNames:c,customDataMapping:b}},convertForEnrich:function(e){var d={},c=[];e.fullNames.forEach(function(b){var a=e.customDataMapping[b];a?(b=d[a.itemid],b||(b={itemid:a.itemid,url:a.url,token:a.token,outFields:[]},b.url||delete b.url,b.token||delete b.token),b.outFields.push(a.variable.id),d[b.itemid]||(d[b.itemid]=b,c.push(b))):c.push(b)});return c}};return f})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/dataCollections/DataCollectionsLoader":function(){define(["esri/dijit/geoenrichment/promise/all",
"../GEUtil","../ReportTemplateData","esri/dijit/geoenrichment/utils/JsonXmlConverter","esri/dijit/geoenrichment/utils/UrlUtil"],function(h,f,e,d,c){return{_cache:{},canLoad:function(){return f.canMakeRequests()},loadVariables:function(b){var a="*"===b.outFields,c=a?["*"]:b.outFields,d=b.countryID+";"+b.hierarchy+";"+c.join(";")+";"+!!b.forceLowerCase;this._cache[d]||(a||(c=c.slice(),-1===c.indexOf("id")&&c.push("id")),this._cache[d]=f.getDataCollections(b.countryID,b.hierarchy,{f:"json",outFields:a?
"*":JSON.stringify(c),suppressNullValues:!0,AddDerivativeVariables:"all"}).then(function(d){var g={dataCollections:d,idToVariableCache:{},fullNameToVariableCache:{}};d.forEach(function(d){d.data.forEach(function(e){function f(a){return b.forceLowerCase?a.toLowerCase():a}function k(b){if(a)return Object.keys(b).length;var d=0;c.forEach(function(a){void 0!==b[a]&&d++});return d}var m=g.idToVariableCache[f(e.id)];if(!m||k(e)>k(m))g.idToVariableCache[f(e.id)]=e;g.fullNameToVariableCache[f(d.dataCollectionID+
"."+e.id)]=e})});return g}));return this._cache[d]},loadCustomDataVariables:function(b,a){a=a||{};var g={idToVariableCache:{},fullNameToVariableCache:{}};return h(b.map(function(b){var f=c.combineMulti([b.url||a.portalUrl,"sharing/rest/content/items",b.itemid,"resources/metadata.xml"]);return e.loadResource(f,b.token||c.getToken(a.portalUrl)).then(function(c){var e=d.parseXml(c.data);c=[];var f=d.queryJson(e,"Fields")[0];f&&(c=c.concat(d.queryJson(f,"Field")));(e=d.queryJson(e,"CalculatedFields")[0])&&
(c=c.concat(d.queryJson(e,"Script")));c.forEach(function(c){function d(b){return a.forceLowerCase?b.toLowerCase():b}c=c.attributes;c={id:c.Name,fullName:b.itemid+"."+c.Name,alias:c.Alias,description:c.Alias,type:"esriFieldType"+c.Type,precision:c.Precision?Number(c.Precision):void 0,vintage:c.Vintage};g.idToVariableCache[d(c.id)]=c;g.fullNameToVariableCache[d(c.fullName)]=c})})})).then(function(){return g})}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/ReportTemplateData":function(){define("dojo/_base/declare dojo/_base/lang dojo/request/xhr esri/dijit/geoenrichment/promise/all esri/kernel esri/request esri/urlUtils esri/dijit/geoenrichment/utils/DataUtil esri/dijit/geoenrichment/utils/PortalUtil esri/dijit/geoenrichment/utils/UrlUtil esri/dijit/geoenrichment/utils/requests/FileContent esri/dijit/geoenrichment/utils/requests/UniversalClient".split(" "),
function(h,f,e,d,c,b,a,g,k,l,p,n){function m(b,c){var d=b.substr(b.lastIndexOf("/")+1),f=a.getProxyRule(b);return e(f&&f.proxyUrl?f.proxyUrl+"?"+b:b,{method:"POST",handleAs:"arraybuffer",data:"token\x3d"+c,headers:{"X-Requested-With":null,"Content-Type":"application/x-www-form-urlencoded; charset\x3dutf-8"}}).then(function(a){var b=!/\.xml$|\.txt$|\.json$/i.test(d);return{name:d,data:b?g.base64FromByteSource(a):decodeURIComponent(escape(g.binaryStringFromByteSource(a)))}})}h=h(null,{id:null,_portalUrl:null,
_baseUrl:null,constructor:function(a,b){this.id=a.id;this._portalUrl=b;this._baseUrl=l.combine(this._portalUrl,"sharing/rest")},getFiles:function(){var a=this;return this._getResources().then(function(b){var c=[];b.map(function(b){b=b.resource;"thumbnail.png"!==b&&c.push(a.getFileByName(b))});return d(c)})},getFileByName:function(a){return m(this.getItemResourceUrl(a,!1),this._getToken())},getItemResourceUrl:function(a,b){a=this._baseUrl+"/"+this._contentItemPath(this.id+"/resources/"+a);return b?
l.addQueryPart(a,"token\x3d"+this._getToken()):a},updateFile:function(a,b){var c=this;return n.request({url:this._baseUrl,urlSuffix:"content/items/"+this.id}).then(function(d){var g=p.fromFileData(a,b);return n.request({url:c._baseUrl,urlSuffix:"content/users/"+d.owner+"/"+d.ownerFolder+"/items/"+c.id+"/updateResources"},{content:{file:g,filename:a}})})},_contentItemPath:function(a){return"content/items/"+a},_getToken:function(){var a=c.id.findCredential(this._portalUrl)||c.id.credentials[0];return a&&
a.token},_getResources:function(){var a=this;return k.query(function(c){return b({url:a._baseUrl+"/"+a._contentItemPath(a.id+"/resources"),content:f.mixin({f:"json",token:a._getToken()},c),handleAs:"json"},{usePost:!0})},null,"resources").then(function(a){return a.resources})},getPortalUrl:function(a){return a?/[^:]+:\/\/(.+)$/i.exec(this._portalUrl)[1]:this._portalUrl}});h.loadResource=m;return h})},"esri/dijit/geoenrichment/utils/PortalUtil":function(){define(["dojo/_base/lang","esri/kernel","esri/request",
"./requests/EveryRequest"],function(h,f,e,d){var c={query:function(b,a,c,e){a=a||{};c=c||"results";e=e||100;var g="number"===typeof a.num?a.num:-1,f=a.num=0>g||a.num>e?e:a.num;a.start=a.start||1;return b(a).then(function(e){var k=e[c],l=e.total-a.start+1;0<=g&&l>g&&(l=g);l-=f;if(0>=l)return e;a.num=f;for(var n=[];0<l;)a.start+=f,n.push(b.bind(null,h.mixin({},a))),l-=f;return d(n,{stopOnError:!0}).then(function(a){a.forEach(function(a){Array.prototype.push.apply(k,a[c])});return e})})},queryCommon:function(b,
a){return c.query(function(c){var d=f.id.findCredential(b)||f.id.credentials[0];return e({url:b,content:h.mixin({f:"json",token:d.token},a,c),handleAs:"json"},{usePost:!0})}).then(function(a){return a.results})}};return c})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/CustomReportsManager":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when ./PortalManager ./ReportTemplateData ./StandardGraphicReportTemplates esri/dijit/geoenrichment/utils/PortalUtil esri/dijit/geoenrichment/utils/PortalQueryUtil esri/dijit/geoenrichment/utils/UrlUtil ../../config ../../countryConfig".split(" "),
function(h,f,e,d,c,b,a,g,k,l,p,n){var m=h(null,{cache:null,constructor:function(){this.cache={}}});h={TEMPLATE_TYPE:"Report Template",PLAYER_STANDARD_INFOGRAPHIC_TYPEKEYWORD:"esriReportPlayerStandardInfographic",GALLERY_INFOGRAPHIC_TYPEKEYWORD:"esriWebGalleryInfographicReport",MOBILE_INFOGRAPHIC_TYPEKEYWORD:"esriMobileFactsInfographicReport",GALLERY_INFOGRAPHIC_USER:"esri_reports",_reportsCache:null,resetCache:function(){this._reportsCache=new m},getCustomReports:function(a){var b=this,e=l.getPortalUrl(a.portalUrl);
return d(c.getPortalInfo(e),function(c){var d=c.user.username,d={q:k.combineQueryString({type:"Report Template",typeKeywords:a.typeKeywords,owner:!a.publicOnly&&d}),sortField:"modified",sortOrder:"desc"};return g.queryCommon(l.combine(e,"sharing/rest/search"),d).then(function(d){d=d.map(function(d){return b.prepareCustomReportFromItem(d,c.portal.url,a)});return b._getCountryReports(d,a.countryID)})})},_getCountryReports:function(a,b){return a&&("*"===b?a:a.filter(function(a){return!a.countries||a.countries.split(",").some(function(a){return b===
a.trim()})}))},prepareCustomReportFromItem:function(a,c,d){function g(a){return"string"===typeof a?"true"===a:!!a}var e=f.mixin({},a.properties||a.details);e.isGraphicReport=g(e.isGraphicReport);e.isMultiFeature=g(e.isMultiFeature);e.reportID=a.id;c={title:a.title,templateData:c&&new b(a,c),modified:a.modified instanceof Date?a.modified.getTime():a.modified};d&&d.attachItemProperty&&(c[d.attachItemProperty]=a);f.mixin(c,e);return c},getCustomReportByID:function(a){var b=this,g=this._reportsCache.cache[a.reportID];
if(g)return g;g=l.getPortalUrl(a.portalUrl);return this._reportsCache.cache[a.reportID]=d(c.getPortalInfo(g),function(c){return c.user.getItem(a.reportID).then(function(d){return d&&b.prepareCustomReportFromItem(d,c.portal.url,a)})}).otherwise(function(c){delete b._reportsCache.cache[a.reportID];return a.ignoreError?null:(new e).reject(c)})},tryFindReportIdByAlias:function(b){var c=this,g=a.aliasToID(b.countryID,b.reportID);if(!g)return null;var e=l.getPortalUrl(b.portalUrl);return d(this.getCustomReportByID({reportID:g,
portalUrl:e,ignoreError:!0,attachItemProperty:b.attachItemProperty}),function(a){return a?a&&(b.returnObject?a:a.reportID):d(c.getCustomReports({portalUrl:e,countryID:b.countryID,typeKeywords:"esriReportPlayerStandardInfographic",publicOnly:!0,attachItemProperty:b.attachItemProperty}),function(a){function c(a){a=a.split(".");return Number((Number(a[0])+Number(a[1])/100).toFixed(2))}var d=c(p.jsapiVersion),g,e,f=-Infinity,k=Infinity;a.forEach(function(a){if(a.playerAlias===b.reportID){var m=c(a.jsapiVersion);
d>=m&&m>f&&(f=m,g=a);d<m&&m<k&&(k=m,e=a)}});a=g||e;b.strictVersionCheck&&a&&a.jsapiVersion!==p.jsapiVersion&&(a=null);return a&&(b.returnObject?a:a.reportID)})})},itemUpdated:function(a){delete this._reportsCache.cache[a]},getFakeCustomReportByContext:function(a){return{title:"Generic template",type:"esriReportTemplateStandard",coverage:a.countryID,countries:a.countryID,hierarchy:a.hierarchy||n.getHierarchyID(),isGraphicReport:!0,isMultiFeature:!1,reportID:null}}};h.resetCache();return h})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/StandardGraphicReportTemplates":function(){define(["dojo/_base/lang",
"../../config","dojo/i18n!esri/nls/jsapi"],function(h,f,e){function d(){return a?a:a={"3.25":{"US.census":[{id:"e2a6868f979f4e37896b631581ae4918",alias:"demographic-summary"},{id:"88420f4a98bb45cbacacbad67e23266e",alias:"key-facts"},{id:"efb6bee0a80d4801887ec4cf73aa67fc",alias:"marketing-profile"},{id:"12867e4a89d5461fbbe3b9c6c181993a",alias:"at-risk-population"},{id:"6637be1fbddf4e948fbd09ce6a7a7888",alias:"portrait-property-flyer"},{id:"02c1124e916847249aa91b9ce48c2552",alias:"skyscraper"},{id:"3afd4c5089584b089af5b0037d74a9d1",
alias:"transportation-to-work"},{id:"a696eae378974ed5a63510fa70bed011",alias:"health-care"},{id:"c931fc6ebdb440189a8bc6bd34115807",alias:"executive-summary-call-outs"},{id:"96096c8afa4847dea936942b1f89acb5",alias:"tapestry-profile"},{id:"7a20b92b48cc4e63bf7ba956295de948",alias:"nearby-restaurants"}],"CA.census":[{id:"6c467040a8a64c33972045cf091bca5b",alias:"key-facts"}],"*.census":[{id:"11c4cec3c0d34c4aa51cd8877e2db4ef",alias:"key-facts"}]},"3.26":{"US.census":[{id:"a5161c2ca50d44429daf2bf9dbe73eb5",
alias:"demographic-summary"},{id:"693269bfbf6c4851901a3c9c56550294",alias:"key-facts"},{id:"aceee34210e748ba95cb9cae21e196b9",alias:"marketing-profile"},{id:"a7936c5ce77c4d698140db21ab1a7858",alias:"at-risk-population"},{id:"8d42e32b12154bc580af89483c208d56",alias:"portrait-property-flyer"},{id:"7be44b15e29847a383906aac5699cf00",alias:"skyscraper"},{id:"537230b385fb45d9a8d6e59265e36fbf",alias:"transportation-to-work"},{id:"89c6ff4d96de4acaa024b7a408f186b0",alias:"health-care"},{id:"0fa71e0a74294e7b8265e4cd507c7d17",
alias:"executive-summary-call-outs"},{id:"f2754d21223a491798dbc0ef2c71858f",alias:"tapestry-profile"},{id:"866e6a839ee348dfae5a8ee9bdafbfc0",alias:"nearby-restaurants"},{id:"f808dfceddd149ff85a9d8825d4e5a5f",alias:"multi-ring-comparison"}],"CA.census":[{id:"f982018306a34cc58756ce0ed78c6b0c",alias:"key-facts"},{id:"c47fa8d040364abe80d288bb606da576",alias:"multi-ring-comparison"}],"*.census":[{id:"3813621424fc4443af1dcecab65be89c",alias:"key-facts"},{id:"dd1fa81faaf94541831cae16788393ab",alias:"multi-ring-comparison"}]},
"3.27":{"US.census":[{id:"3c6959a7c7c4450f9bdcc7063c9023d5",alias:"demographic-summary"},{id:"4cc0a5e007d946d5909524fcf80bc666",alias:"key-facts"},{id:"fb9b9a501c974540a52ab6d1027a8bcc",alias:"marketing-profile"},{id:"b0f05d5926d6444da40d6bf0c5c9846e",alias:"at-risk-population"},{id:"5cf609b26ce24633a2edc58d7ebeb3fd",alias:"portrait-property-flyer"},{id:"686d7af60bcb410db051ec8465889231",alias:"skyscraper"},{id:"a79a099ab7be4c34a9b0b28831b1aa9c",alias:"transportation-to-work"},{id:"6f64bb63647246dcb5d268fc301614f6",
alias:"health-care"},{id:"99e919a7e9fd4fa2b55779f0dc118da8",alias:"executive-summary-call-outs"},{id:"f32b961757f347e2976ba011ee20cb13",alias:"tapestry-profile"},{id:"a266260cc3ec46c1b66c86f263feb8e4",alias:"nearby-restaurants"},{id:"dab290529fd44063a2d83e03a8dc49eb",alias:"multi-ring-comparison"},{id:"1499719e83754c81ae1477223c0dde39",alias:"property-details"},{id:"9c441f80f80348c8b5b747e2cf2a2ccd",alias:"employment-overview"},{id:"bb59cd9292ec47a0928900c5fb9c17b8",alias:"office-market-profile"},
{id:"6f75892c4a5f4f5ba3d0edb4d8a0b13b",alias:"health-care-and-insurance"},{id:"a7524b019e1f482493e43f32ab9568a0",alias:"demographic-profile"},{id:"45d528a3865547bb89792d4517db2e7a",alias:"commute-profile"},{id:"acf5c12b54b64550ad7f582c9c97ed28",alias:"target-market-summary"},{id:"489d923d29d44c2681171a590fb37742",alias:"coronavirus-impact-planning"}],"CA.census":[{id:"91d1e8c9d0ea482b9947dfe4bdfbe0ba",alias:"key-facts"},{id:"e05eb227df9b4ceba0ace202b1d0c1e2",alias:"multi-ring-comparison"}],"NL.NLD_4orange":[{id:"77e9461032b24e47b6c6b643cf02381f",
alias:"housing-profile"},{id:"b80fd38e5f43448da530521832e0dfba",alias:"insurance-profile"},{id:"d36520d68d8e449c9f300be0e800f698",alias:"media-profile"},{id:"bad567fdf36e48e9a5108b66c96bf0ae",alias:"personicx-segmentation"},{id:"5726fe6cad4c491a863eff64e538231c",alias:"spending-profile"}],"JP.EsriJapan":[{id:"e4bd37bb10c74798a3600ca7484846ac",alias:"base-demographic-profile"},{id:"a5d7db5138644a9e95d9af1b40b31bb9",alias:"demographic-comparison-profile"},{id:"205b45f626f84650a1ca948be4f97411",alias:"future-population-profile"},
{id:"ee12a9d9a2e04fb6b93628f075719bc9",alias:"population-households-profile"},{id:"3f857a2a8d14488abfcec383197e5a0b",alias:"consumer-spending-profile"},{id:"77369125467c4c9a8f3b9a628eda3347",alias:"base-demographic-profile-ja"},{id:"08abfdb8b8174846bd3723f094a88d86",alias:"demographic-comparison-profile-ja"},{id:"e5db2ced023d4c53a0ef9fe231d7fd15",alias:"future-population-profile-ja"},{id:"4c55f8ddb53345298e59bccfeb45e489",alias:"population-households-profile-ja"},{id:"24c8ef9a8c5d45c78791a84445eed29d",
alias:"consumer-spending-profile-ja"}],"DE.DEU_Nexiga":[{id:"7aa819f9816a494ab28ab7604553f488",alias:"base-demographic-profile"},{id:"710051b492c3481a83e01bd6bf3dd3bf",alias:"household-profile"}],"ES.ESP_AIS":[{id:"3d046bf33ce04b598afd391a0dd195c9",alias:"base-demographic-profile"}],"PR.PRI_ACS_2020":[{id:"d8b9f282034d47db808175fef56a15e2",alias:"at-risk-population"},{id:"eab5646a29324a6282db3b8ca47bf2b3",alias:"commute-profile"},{id:"ed6b5a0736aa4e04862a1a4307c608cc",alias:"demographic-summary"},
{id:"a4c64a9006544751ad18ce75a401112e",alias:"health-care-and-insurance"},{id:"96d00aefd766428394d6ee6698a56591",alias:"coronavirus-impact-planning"}],"*.census":[{id:"365d52e6bac147a68a12eee229eb9b6b",alias:"key-facts"},{id:"0f7d2ba850fa40579cae1342001d80d7",alias:"multi-ring-comparison"}]},"3.28":{"US.census":[{id:"45cb423066194f5f98c6f4ff81124db3",alias:"demographic-summary"},{id:"98d5848a944b4787b2ca038256c7878d",alias:"key-facts"},{id:"879849b937ec4eb0bef31ff2861251f2",alias:"marketing-profile"},
{id:"456d7a22adc8439a93d4164ed3846243",alias:"at-risk-population"},{id:"c7e01c953c7e4b70a46ca6408c3ed000",alias:"portrait-property-flyer"},{id:"34330a47546f412d9d09632347da11d3",alias:"skyscraper"},{id:"d349b23334454274ab2a7a20a0a9a55d",alias:"transportation-to-work"},{id:"02086fe6b92b4ff5a9a7a8d172540fc9",alias:"health-care"},{id:"5d8b51e2b27b4832b193d9932bc6f862",alias:"executive-summary-call-outs"},{id:"1b07c48d4b58423990023b43150d7e99",alias:"tapestry-profile"},{id:"c21dd81cd9064649a4bb454530f12790",
alias:"nearby-restaurants"},{id:"4d8c102ca7324d09931cfe65ab3a1168",alias:"multi-area-comparison"},{id:"9ed3b5dba02d4b46a3e063c8405fd0cc",alias:"property-details"},{id:"db0606e41ee7485f88122069e74a9b6b",alias:"employment-overview"},{id:"2a43c204c1dd4a758087372d7d7d786b",alias:"office-market-profile"},{id:"f59a3621583d44bbafa14035c2ae3947",alias:"health-care-and-insurance"},{id:"ad58f06a480c4b16aadcff789f543cca",alias:"demographic-profile"},{id:"bd7390ab31dc485489733d22475db0ed",alias:"commute-profile"},
{id:"38eab30d7e6840da869fee264ca9fc40",alias:"target-market-summary"},{id:"03b420681f6a466fb14e254669583244",alias:"coronavirus-impact-planning"}],"CA.census":[{id:"6c0a945e91d44640a08776e5bed1b297",alias:"key-facts"},{id:"7464708f379b463c8eec8aed1315989f",alias:"multi-area-comparison"},{id:"425150e63a5346659721bfc0be94511b",alias:"prizm-profile"}],"NL.NLD_4orange":[{id:"e602295128e34ea2b2b50a1aa04253bf",alias:"housing-profile"},{id:"3d0f7e63256b43a59fcf037502380685",alias:"insurance-profile"},{id:"fbc685a8837945eb82cde447acfda982",
alias:"media-profile"},{id:"da063bf765e341708fad9eeec07b09c7",alias:"personicx-segmentation"},{id:"5003049227804e5cba6ad3bfdbf2dba7",alias:"spending-profile"}],"JP.EsriJapan":[{id:"bd9685651f484488ba24c2838a6a9000",alias:"base-demographic-profile"},{id:"f36b1cc0b9d84ea4b4db1742e875ff80",alias:"demographic-comparison-profile"},{id:"99a48ec44af94af290ab0e6d691a31c7",alias:"future-population-profile"},{id:"b29af5c2e6754f61ba38ad3128668095",alias:"population-households-profile"},{id:"d568dd78527c462e83eb68cb9ca02f09",
alias:"consumer-spending-profile"},{id:"a29c9143bd044dad9475e6b6ee292e46",alias:"base-demographic-profile-ja"},{id:"3bb56ea4c4bd4a2aaa124e2e3a0fad60",alias:"demographic-comparison-profile-ja"},{id:"28ef1772bd884db5ae8885731318e503",alias:"future-population-profile-ja"},{id:"7896c8adf89e4f47ab6e0acc7759a1cd",alias:"population-households-profile-ja"},{id:"6c28a650baaa40cda26f4fb372b14d0f",alias:"consumer-spending-profile-ja"}],"DE.DEU_Nexiga":[{id:"31cf6eac0339433f8b4b5f8b62e47554",alias:"base-demographic-profile"},
{id:"ccf6bc8472ae4ca8852fec621197fec3",alias:"household-profile"}],"ES.ESP_AIS":[{id:"5b60de05c1694a78b6b6ce8e10a48cd4",alias:"base-demographic-profile"}],"PR.PRI_ACS_2020":[{id:"f1d79448541642648293f4b75d7b595a",alias:"at-risk-population"},{id:"7943a0c2f1ca4cad967bb0bfeb8af3a4",alias:"commute-profile"},{id:"ef0579311aac4d14a771389f23263445",alias:"demographic-summary"},{id:"4edd44657989475493ca92a69e80f08c",alias:"health-care-and-insurance"},{id:"c440f0c671264732b16c39f6326a5987",alias:"coronavirus-impact-planning"}],
"*.census":[{id:"5886dbf41f984a0a8ec4eb4b5e231584",alias:"key-facts"},{id:"41727f86773c4cf2a37fd99446ea83fc",alias:"multi-area-comparison"}]},"3.29":{"US.census":[{id:"368e2bf603fb42c4aa3dac0fce50cdf8",alias:"demographic-summary"},{id:"a32be4a9e51d4affa4cc1ddc812cb629",alias:"key-facts"},{id:"df985e2579004a3292c3d00615d53c39",alias:"marketing-profile"},{id:"8c56287427f84ae8b59142fc5bf1df4c",alias:"at-risk-population"},{id:"d95e40c3c93d480ab4d1d0b0adbbc5d4",alias:"portrait-property-flyer"},{id:"f989f9b820cd44d390187402447051b4",
alias:"skyscraper"},{id:"0d322ac073584079a8cd6a1bda981fe7",alias:"transportation-to-work"},{id:"2b9f186425844ec390584b739ffca026",alias:"health-care"},{id:"3e9ccce6cca64e70be19ed789de5f290",alias:"executive-summary-call-outs"},{id:"2a812da4de404ceba3969472d32c42e7",alias:"tapestry-profile"},{id:"2cc25f7b5f194012b39c90b5f9bdb8d3",alias:"nearby-restaurants"},{id:"72d1e9e4cdf94bf9a2020f8214bef9ca",alias:"multi-area-comparison"},{id:"27034d31ab124b9bbe4e63b7df2a0d90",alias:"property-details"},{id:"4a59e329df06480eaa534513eb15f465",
alias:"employment-overview"},{id:"d4fe343c4d6f4bea840a715f5b033d2d",alias:"office-market-profile"},{id:"cb2224cc9cb24ce288da729f0650ebf0",alias:"health-care-and-insurance"},{id:"484825ed241c49d58eaf718d46772051",alias:"demographic-profile"},{id:"afee0a2eb16e46cc9bc61b5d82133249",alias:"commute-profile"},{id:"1d32fabd95b446e99049aa0a04f5508e",alias:"target-market-summary"},{id:"783847f3f03f402d855985b45a8bf2df",alias:"population-trends"},{id:"83aef26e61ca41da9b269c06cc418d79",alias:"coronavirus-impact-planning"}],
"CA.census":[{id:"73f1c835b1624ff0b29a6a364f7ba6dc",alias:"key-facts"},{id:"84b05aed2d2f478eb6bb1e4749811cf1",alias:"multi-area-comparison"},{id:"ea0737e1e7554c5caf2be381c28369cc",alias:"prizm-profile"}],"NL.NLD_4orange":[{id:"3d8cb941742d4fffbaca48c65b4bd5b5",alias:"housing-profile"},{id:"f126395e7bcc494899cfc1a13a34be1f",alias:"insurance-profile"},{id:"8da901e5729e457683f2e4f7081b1bda",alias:"media-profile"},{id:"f9ba90b373a245e1b8fd14a027cf1ba5",alias:"personicx-segmentation"},{id:"81fc53b93a0c4269848ce2ae22ec19e2",
alias:"spending-profile"}],"JP.EsriJapan":[{id:"79b2394ea50d44f3b4c1b4bdabed6cc2",alias:"base-demographic-profile"},{id:"9e824283a8954639ab0c0ac237b9e14d",alias:"demographic-comparison-profile"},{id:"f5812c2f542644368c0ff34eef7b731c",alias:"future-population-profile"},{id:"b51d7dde64c34a9796418c1788a6762d",alias:"population-households-profile"},{id:"48a993403d30431784b7bf47a06e4261",alias:"consumer-spending-profile"},{id:"531c59f55de646d5a78fef6c903a678f",alias:"base-demographic-profile-ja"},{id:"cf553f2090a64662a1f9efa8a355964c",
alias:"demographic-comparison-profile-ja"},{id:"321150c8ac1049fc9cd253cb12c0b0bc",alias:"future-population-profile-ja"},{id:"e0d6dea7667c47b49f159c207fc311e9",alias:"population-households-profile-ja"},{id:"ba5f50bd617e4519a9322ec24b9cd5b1",alias:"consumer-spending-profile-ja"}],"DE.DEU_Nexiga":[{id:"60ec4173caac4f87a831447d5bf7b450",alias:"base-demographic-profile"},{id:"98d3d99aadba47a8ab53b0dcd4eebf22",alias:"household-profile"}],"ES.ESP_AIS":[{id:"3978b02fbc354acca14d4e959fa5b531",alias:"base-demographic-profile"}],
"PR.PRI_ACS_2020":[{id:"e2141ddd911c4aadb403db1e858edb51",alias:"at-risk-population"},{id:"78360505668743e0a39ac0d085612dfa",alias:"commute-profile"},{id:"f296deceb6204f85853ac85e98ba3552",alias:"demographic-summary"},{id:"8a1c4d55a77c4cf9805cec380727fc5a",alias:"health-care-and-insurance"},{id:"8dd9de996ba0491d82a2ee8f01cd55b0",alias:"coronavirus-impact-planning"}],"*.census":[{id:"5645a1d6023c4d8a9d02943ad57a7ab2",alias:"key-facts"},{id:"e29f56b6d67447e08a45d08981db987c",alias:"multi-area-comparison"}]},
"3.30":{"US.census":[{id:"981382ffe90c40bbb60318b1ce338ba4",alias:"demographic-summary"},{id:"f62dec6c9750496796fdc0619c4c107f",alias:"key-facts"},{id:"f737236a8b644f1597a4457862fa169c",alias:"marketing-profile"},{id:"4746caa1254e4d93af121ce74e9aa8d6",alias:"at-risk-population"},{id:"0bcd882dd7a34fd39ace173243534df0",alias:"portrait-property-flyer"},{id:"4a340b8e642945f6bb7a381d07fb26b6",alias:"skyscraper"},{id:"3e2a42b2d03e42cf91e9727f67273ec3",alias:"transportation-to-work"},{id:"c26e9577d48b4499a07b75215c97c394",
alias:"health-care"},{id:"cbc348e601104d0c9bbe971c0297142a",alias:"executive-summary-call-outs"},{id:"d65aaa42b9824864b40eb1a75f2e4cbd",alias:"tapestry-profile"},{id:"d6242e8dd02142bdb98b85f094d5cd9b",alias:"nearby-restaurants"},{id:"aed9e00873fa4010881daaa90e7e8d71",alias:"multi-area-comparison"},{id:"eb0e0df0856e43cdb874f96945c566ac",alias:"property-details"},{id:"e29ebec17c2c4f42a1a929c40163bb90",alias:"employment-overview"},{id:"b84d0f0f5c69461ea52ce2702f7327d6",alias:"office-market-profile"},
{id:"5eba537af36e4490869917ee888bacc4",alias:"health-care-and-insurance"},{id:"afb01a3f91374f65ba4c6be9229f2c15",alias:"demographic-profile"},{id:"8074d1bbbfed4858bb24400a0c7bf224",alias:"commute-profile"},{id:"33621d85b1df4547851c904aaa7d44d2",alias:"target-market-summary"},{id:"440170eaae5240e79abbb0bb7de22b27",alias:"population-trends"},{id:"0576deee38714cc69357de9675ab39ae",alias:"coronavirus-impact-planning"}],"CA.census":[{id:"e054928366604fc7b401dcb4a343cd4c",alias:"key-facts"},{id:"986bc92490234c2697d5771b9771166e",
alias:"multi-area-comparison"},{id:"52233708250449bc84f906d86616cace",alias:"prizm-profile"}],"NL.NLD_4orange":[{id:"22a86d0f982d4b10934f32129f2674f9",alias:"housing-profile"},{id:"9811b2babd5f4283822782867476b92c",alias:"insurance-profile"},{id:"59957cc0524344449fc6035053bb6c4a",alias:"media-profile"},{id:"2511035fed0140b8a7eb7ec7240e41eb",alias:"personicx-segmentation"},{id:"defc390648e543508be22704f1db659c",alias:"spending-profile"}],"JP.EsriJapan":[{id:"91a180442f614c4d96fb40e33aa30948",alias:"base-demographic-profile"},
{id:"e7415b6c9ff74922850851eac65ddbc6",alias:"demographic-comparison-profile"},{id:"12e9eb63e4834d3681e15196bfc64642",alias:"future-population-profile"},{id:"291cc1bc2cee455483c96f50e5916f1d",alias:"population-households-profile"},{id:"217c72b7d0534ebc81658c71917c3e15",alias:"consumer-spending-profile"},{id:"48d5baf8e5574abda8fd776219fa0eb6",alias:"base-demographic-profile-ja"},{id:"01a7a0cbacf948b3b715e4f6c55aa5f2",alias:"demographic-comparison-profile-ja"},{id:"0317412d6fb541c9b4067923e314cad3",
alias:"future-population-profile-ja"},{id:"0c826ce1e2de415aa2f7af3e615b1fe8",alias:"population-households-profile-ja"},{id:"201211e23758432db4a841dae8ba9428",alias:"consumer-spending-profile-ja"}],"DE.DEU_Nexiga":[{id:"ec6477ce41fa464fb38a360cad0d3da3",alias:"base-demographic-profile"},{id:"e53b2c145f544efaa7d7b4e802c3d747",alias:"household-profile"}],"ES.ESP_AIS":[{id:"4483924cb42043ec85486c58e61a99ef",alias:"base-demographic-profile"}],"PR.PRI_ACS_2020":[{id:"7e3b955c4d904624b4cea5d015e693a0",alias:"at-risk-population"},
{id:"8927492627124fd0845de8c0dc02bd3f",alias:"commute-profile"},{id:"a308a300f3b4482ea57b4ea4a54ea5ef",alias:"demographic-summary"},{id:"5800acd3784e4a6d88e3228e1af1164f",alias:"health-care-and-insurance"},{id:"d40e2ba95fec40c6ad68ceddde4e160b",alias:"coronavirus-impact-planning"}],"*.census":[{id:"b9d1ca815d9a4a3ab35196ec299f0917",alias:"key-facts"},{id:"6f6d601c2eef4bd1a87baa2652e7bb0b",alias:"multi-area-comparison"}]},"3.31":{"US.census":[{id:"784d0b69c02c4cac862b89b0e44cd8fb",alias:"demographic-summary"},
{id:"f1bb3a222fab470dbb96a79a51496b2b",alias:"key-facts"},{id:"1780d5b264734757b86e4655d779b213",alias:"at-risk-population"},{id:"8c34121585894e91a50c493c360912f0",alias:"skyscraper"},{id:"1c314d9d06844d44b408caba6099b56b",alias:"executive-summary-call-outs"},{id:"4ee838a250084c9bad84f094895c793c",alias:"tapestry-profile"},{id:"dfba27ac04694513aee257cdd185c8c2",alias:"nearby-restaurants"},{id:"d7cfb836282747199cf0febea42627cc",alias:"multi-area-comparison"},{id:"3a34213116a340a0bbd0d463025444a2",
alias:"property-details"},{id:"b277b8572469425fa54c5506c3dbcdf3",alias:"employment-overview"},{id:"eaf35c41f5714f48a1aa61fcbd6ae05f",alias:"office-market-profile"},{id:"688f86931cc345f796154717dc6d0a15",alias:"health-care-and-insurance"},{id:"cb4edb43a1ae473ca651388b5c3fa54f",alias:"demographic-profile"},{id:"49224c10d4ac4c7ab0f8e016165ce235",alias:"commute-profile"},{id:"db67445e4dfa4b6c8c1e5fd30b229c92",alias:"target-market-summary"},{id:"6c9360bfec9041ddba0f03440cb446ca",alias:"population-trends"},
{id:"2ae07567c78847abacb14773ffe9dede",alias:"coronavirus-impact-planning"}],"CA.census":[{id:"0704defc6960439ea5b9c484af15eb4c",alias:"key-facts"},{id:"ee01fe05db964878bc6fb627e55dc9b1",alias:"multi-area-comparison"},{id:"a426bb6d944a46658640aee2ba480866",alias:"prizm-profile"}],"NL.NLD_4orange":[{id:"710037ca0f024ec5abbe4cf9fecad23f",alias:"housing-profile"},{id:"83bc643ea48344c892a8e9636e3677dd",alias:"insurance-profile"},{id:"53f63e3a9e854a8fa5e2c0222df6f848",alias:"media-profile"},{id:"ca9d66bf4bf940918129d0d5c97e0b50",
alias:"personicx-segmentation"},{id:"ab19f90750fd469aa702f961b12eaee8",alias:"spending-profile"}],"JP.EsriJapan":[{id:"7f7c37e8f1fa4ab18b88368c12058eff",alias:"base-demographic-profile"},{id:"25a71f196b7e4db182be346264b442dd",alias:"demographic-comparison-profile"},{id:"e1075eaada7744a59ecabfc445dcd877",alias:"future-population-profile"},{id:"8e2746d993584a7d94d0e66ca6dabdaa",alias:"population-households-profile"},{id:"bc9b91d7ae2c41a5bdece1d322ef6b88",alias:"consumer-spending-profile"},{id:"4f4736d5b2f842faaee83c57417c56b6",
alias:"base-demographic-profile-ja"},{id:"bc400448bf3347619349cb7d4ccb3d87",alias:"demographic-comparison-profile-ja"},{id:"00ad3ad05e384d7ea764b356a950356d",alias:"future-population-profile-ja"},{id:"db94d6af598f48778c4471f9fa0d6e4f",alias:"population-households-profile-ja"},{id:"c5f602a9d6714dd6bd6a2b720eced874",alias:"consumer-spending-profile-ja"}],"DE.DEU_Nexiga":[{id:"b0cd9df36d0747ecac2bc34f055f5583",alias:"base-demographic-profile"},{id:"1751ab1998db4e6fb79f484069605cfd",alias:"household-profile"}],
"ES.ESP_AIS":[{id:"3d17356c9a5549dbaa4096365e7eb703",alias:"base-demographic-profile"}],"PR.PRI_ACS_2020":[{id:"7923818907d248ff8dcd7a5941e89b57",alias:"at-risk-population"},{id:"c0b28d710379405eac4ecb6a64d817b4",alias:"commute-profile"},{id:"4b64ec164a3d4830ae8a4cedf067f55a",alias:"demographic-summary"},{id:"5e47986d4c4644a29a28c92c077919f2",alias:"health-care-and-insurance"},{id:"11c43309216b4d4a8fbd9a03cbcc22ec",alias:"coronavirus-impact-planning"}],"*.census":[{id:"f2d46b136acc46e2a2220388ddc43be0",
alias:"key-facts"},{id:"228155af0095410c961cc82f33cdcf49",alias:"multi-area-comparison"}]},"3.32":{"US.census":[{id:"2ff58abf55554be4b19006c1e607afaa",alias:"demographic-summary"},{id:"a19b321e3adc441886e706bb9704005c",alias:"key-facts"},{id:"f1e3b0c93e1d44e299eb0b752f93b7db",alias:"at-risk-population"},{id:"3bbc96da4ca142c7b80b082b0f986110",alias:"skyscraper"},{id:"1302184a2f584b86943b6c51d40acace",alias:"executive-summary-call-outs"},{id:"58035dcee74b4875bcd951b9174155d1",alias:"tapestry-profile"},
{id:"4da5867dfda046ddb4b82ab01b7cb568",alias:"nearby-restaurants"},{id:"4498b9e35665480cafe3985f788ca61d",alias:"multi-area-comparison"},{id:"83a11d5f38f84e709ff1e24786e963b4",alias:"property-details"},{id:"0a0354d2d0d842d8bd8e05d40545fc5b",alias:"employment-overview"},{id:"400924aa9d5f4bee8b9dd0c0af21dfbb",alias:"office-market-profile"},{id:"0a502ea9be8a43fdb6cd2fb5ff7503bc",alias:"health-care-and-insurance"},{id:"6147ac21718149a69ce15831f12181ed",alias:"demographic-profile"},{id:"4cdaddd947064ca690ebc06eec06ea57",
alias:"commute-profile"},{id:"a8fe08a9c5114260a2a6f7ca436d36f6",alias:"target-market-summary"},{id:"34a17e1fceb646228e94089ec5e0890f",alias:"population-trends"},{id:"eb5d984d78364a6596cd97e0bf7901a5",alias:"coronavirus-impact-planning"}],"CA.census":[{id:"5f6e17f3729145959fb38ed2cd508970",alias:"key-facts"},{id:"c86709cbd72043708e09e4a641adfbd0",alias:"multi-area-comparison"},{id:"bd9e3a17678843d4b1fa0716af91c231",alias:"prizm-profile"}],"NL.NLD_4orange":[{id:"470686f333d140c7b516294465eea037",alias:"housing-profile"},
{id:"ab11f2f11ea3439197769a8189451bea",alias:"insurance-profile"},{id:"f0e6736d0f364d4b88ea613746e57c81",alias:"media-profile"},{id:"bfe0814bc0604a8faa48d01b026ef7a5",alias:"personicx-segmentation"},{id:"bd1d4c7be5ad41ae909267b5e9c5f2dc",alias:"spending-profile"}],"JP.EsriJapan":[{id:"b9dcbb9f31fd4be7bd96a2f89ce66a1c",alias:"base-demographic-profile"},{id:"830ddad066c14c0dad27367a1b2ef132",alias:"demographic-comparison-profile"},{id:"7574f89d591f432da6ffdb94dcfdac52",alias:"future-population-profile"},
{id:"ec8785d4c9cb446394e07fa7dd8451fd",alias:"population-households-profile"},{id:"9ac85d73187548b2bb0d0b4a73f88199",alias:"consumer-spending-profile"},{id:"e99eee823684452fbe564fe42dac9535",alias:"base-demographic-profile-ja"},{id:"8598d6a8550d46aebd3fd598ceaefae7",alias:"demographic-comparison-profile-ja"},{id:"fdf81ddffb374e3f898006ffa59e259e",alias:"future-population-profile-ja"},{id:"f2468c2fef314427bd0865b460ef554f",alias:"population-households-profile-ja"},{id:"a96f28fb67024109b7c33161f3c9b308",
alias:"consumer-spending-profile-ja"}],"DE.DEU_Nexiga":[{id:"40a5ba79d1204e78ac6deaa633ccd59b",alias:"base-demographic-profile"},{id:"2e647098c613476bbd92b1e07331cb86",alias:"household-profile"}],"ES.ESP_AIS":[{id:"7d82cae4b3fc4575bab56ec82f51c368",alias:"base-demographic-profile"}],"PR.PRI_ACS_2020":[{id:"aa65005b75ba4e158afe63baa4bc5fe2",alias:"at-risk-population"},{id:"292a269a813e4d7797baf88a76c11a8c",alias:"commute-profile"},{id:"b1d50628f2484689b9e39d49fc2e16a0",alias:"demographic-summary"},
{id:"64839b7a81be45e287e805afc145652e",alias:"health-care-and-insurance"},{id:"44be3c42b70c4aee840fdeb4656b7922",alias:"coronavirus-impact-planning"}],"*.census":[{id:"ce57630d5cc24759809dd54bc1f82c91",alias:"key-facts"},{id:"c48ee0f58c8645bf8d689eb0db2d2936",alias:"multi-area-comparison"}]},"3.33":{"US.census":[{id:"55689c3ee7c1490e83accae002a8d164",alias:"demographic-summary"},{id:"173e40bebc9d426a8e4680242acafea4",alias:"key-facts"},{id:"218eba57314e476ba16d1d5d40bb0182",alias:"at-risk-population"},
{id:"3d470c82d8664e34b5026675596a7a87",alias:"skyscraper"},{id:"b9381f481f9f417f9647e0a2c8686979",alias:"executive-summary-call-outs"},{id:"d2800b578d1c4dd38ac95ce36882d881",alias:"tapestry-profile"},{id:"d9d8109c537943a78a24d65110291b43",alias:"nearby-restaurants"},{id:"2e835e58629a4f1e8192a729792b638f",alias:"multi-area-comparison"},{id:"6f3c32ed18834a4ea34b200e32ad7c33",alias:"property-details"},{id:"6b1267be3fcb401bbcb49afd221713cf",alias:"employment-overview"},{id:"67e6efc15cb142c2a7cc30a48a59c769",
alias:"office-market-profile"},{id:"9d8b447adc634228b24deb315107c0f0",alias:"health-care-and-insurance"},{id:"e45f96db738140869981b7443b6e2658",alias:"demographic-profile"},{id:"88d896eada3340dc8f8f1a2406bd48f9",alias:"commute-profile"},{id:"61492956f89a43ee86d245fca92858a2",alias:"target-market-summary"},{id:"91de69dede414856892dfdd94d2c4bab",alias:"population-trends"},{id:"ee9c6fdc902e4ea09509e4d1bf1582b5",alias:"coronavirus-impact-planning"}],"CA.census":[{id:"dfb663da790248fe89504c662c42aae3",
alias:"key-facts"},{id:"9873fcafe7194fcf9dffa8bbb8e001a1",alias:"multi-area-comparison"},{id:"4766ad797ef84968be4b4d0d54b98416",alias:"prizm-profile"}],"NL.NLD_4orange":[{id:"2212ff30c72143e6bcd9b8f26b01c47f",alias:"housing-profile"},{id:"c5efcef364ac4d8f82a6d54010ff75c7",alias:"insurance-profile"},{id:"e00894c000a94c42aefce551fe4e48c2",alias:"media-profile"},{id:"9d1da1c80e93407cb94589cee43a0f5a",alias:"personicx-segmentation"},{id:"578199262aa646bf8b0713f3f2160af6",alias:"spending-profile"}],"JP.EsriJapan":[{id:"00bd747c0e48477d8df692848560a8a2",
alias:"base-demographic-profile"},{id:"8ac4bd99dd1848dc98967419ab8d299c",alias:"demographic-comparison-profile"},{id:"88f94b5e3b6d414d913957b46e9f8394",alias:"future-population-profile"},{id:"41864cea64f3432a90006eb9a1f97608",alias:"population-households-profile"},{id:"44333ddcda38473d9a24010ed387eda7",alias:"consumer-spending-profile"},{id:"c35ebbeffb3b47fc9bbe3fc6283aaa7b",alias:"base-demographic-profile-ja"},{id:"6c8a565d12954927b83daaad81409a25",alias:"demographic-comparison-profile-ja"},{id:"fcba5d5750514c9c93b2cb5222609d98",
alias:"future-population-profile-ja"},{id:"7ad858351b6b4268b791b6cc24bf4e0f",alias:"population-households-profile-ja"},{id:"7d94fec6df6b4bff9ad14f5b711f18c6",alias:"consumer-spending-profile-ja"}],"DE.DEU_Nexiga":[{id:"571f323738c44d5a8b85d6d1e78d9c52",alias:"base-demographic-profile"},{id:"ef7624e051b6407488d8ad59b7979fc4",alias:"household-profile"}],"ES.ESP_AIS":[{id:"46e9329c7b2042fa84dfc1444f7decc0",alias:"base-demographic-profile"}],"PR.PRI_ACS_2020":[{id:"0cb7ba4d407640ff967829ae7dd39396",alias:"at-risk-population"},
{id:"7598826f28124abf9134801a607d56ce",alias:"commute-profile"},{id:"848c5cc8a4284065a0055b047a106adf",alias:"demographic-summary"},{id:"ecfc8db522004ea6848667e43589efd9",alias:"health-care-and-insurance"},{id:"4685d4c6c51e4ef392bdab89c0af8979",alias:"coronavirus-impact-planning"}],"*.census":[{id:"e4d3d1675d0044089f98a0f85ea16c8b",alias:"key-facts"},{id:"33b6e27f43644811b8a58f15c0832a67",alias:"multi-area-comparison"}]}}}function c(a){a=a||f.jsapiVersion;var b={};a=d()[a];for(var c in a){var g={};
a[c].forEach(function(a){g[a.alias]=a.id});var e=c.substr(0,c.indexOf("."));b[e]=g}return b}function b(a,b){b=c(b);return h.mixin({},b["*"],b[a])}e=e.geoenrichment.dijit.ReportPlayer.StandardTemplates;var a,g={"demographic-summary":e.demographicSummary,"key-facts":e.keyFacts,"marketing-profile":e.marketingProfile,"at-risk-population":e.atRiskPopulation,"portrait-property-flyer":e.portraitPropertyFlyer,skyscraper:e.skyscraper,"transportation-to-work":e.transportationToWork,"health-care":e.healthCare,
"executive-summary-call-outs":e.executiveSummaryCallOuts,"tapestry-profile":e.tapestryProfile,"nearby-restaurants":e.nearbyRestaurants,"multi-area-comparison":e.multiAreaComparison,"property-details":e.propertyDetails,"employment-overview":e.employmentOverview,"office-market-profile":e.officeMarketProfile,"health-care-and-insurance":e.healthCareAndInsuranceStatistics,"demographic-profile":e.demographicProfile,"commute-profile":e.commuteProfile,"target-market-summary":e.targetMarketSummary,"population-trends":e.populationTrends,
"coronavirus-impact-planning":e.coronavirusImpactPlanning,"prizm-profile":e.prizmProfile,"housing-profile":e.housingProfile,"insurance-profile":e.insuranceProfile,"media-profile":e.mediaProfile,"personicx-segmentation":e.personicxSegmentation,"spending-profile":e.spendingProfile,"base-demographic-profile":e.baseDemographicProfile,"demographic-comparison-profile":e.demographicComparisonProfile,"future-population-profile":e.futurePopulationProfile,"population-households-profile":e.populationHouseholdsProfile,
"consumer-spending-profile":e.consumerSpendingProfile,"base-demographic-profile-ja":"\u57fa\u672c\u7d71\u8a08\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb","demographic-comparison-profile-ja":"\u4eba\u53e3\u7d71\u8a08\u6bd4\u8f03\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb","future-population-profile-ja":"\u5c06\u6765\u4eba\u53e3\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb","population-households-profile-ja":"\u4eba\u53e3\u30fb\u4e16\u5e2f\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb","consumer-spending-profile-ja":"\u6d88\u8cbb\u984d\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb",
"household-profile":e.householdProfile},k={portalUrl:"http://www.arcgis.com",user:"esri_reports",query:"http://www.arcgis.com/home/search.html?q\x3downer%3Aesri_reports",aliasToID:function(a,c,d){return b(a,d)[c]},aliasToLabel:function(a){return g[a]},getAliases:function(a,c){a=Object.keys(b(a,c));a.sort(function(a,b){return a.localeCompare(b)});return a},getListOptions:function(a,b){return k.getAliases(a,b).map(function(c){return{value:k.aliasToID(a,c,b),label:g[c]}})},getSupportedCountries:function(a){return Object.keys(c(a)).map(function(a){return"*"===
a?"AU":a})},getLibrary:function(){var a=h.clone(d()),b;for(b in a){var c=a[b];c["AU.census"]=c["*.census"];delete c["*.census"]}return a}};return k})},"esri/dijit/geoenrichment/utils/PortalQueryUtil":function(){define([],function(){var h={combineQueryString:function(f){var e="";f.type&&(e+='type:"'+f.type+'"');f.typeKeywords?e=Array.isArray(f.typeKeywords[0])?e+(" typekeywords:("+f.typeKeywords.map(function(d){return h.combineTypeKeywords(d)}).join(" OR ")+")"):e+(" typekeywords:"+h.combineTypeKeywords(f.typeKeywords,
f.typeKeywordsNot)):f.typeKeywordsNot&&(e+=" typekeywords:"+h.combineTypeKeywords(null,f.typeKeywordsNot));f.owner&&(e+=" owner:"+f.owner);f.isShared&&(e+=f.orgId?" ((orgid:"+f.orgId+' AND access:"public") OR access:"shared" OR access:"org")':' (access:"shared" OR access:"org")');f.ownerNot&&(e+=" NOT owner:"+f.ownerNot);return e},combineTypeKeywords:function(f,e){f=f?h._combineArray(f):"";return e?(e=h._combineArray(e),"("+f+" NOT "+e+")"):f},_combineArray:function(f){return"string"===typeof f?"("===
f.charAt(0)||'"'===f.charAt(0)?f:'"'+f+'"':1===f.length?'"'+f[0]+'"':"("+f.map(function(e){return'"'+e+'"'}).join(" ")+")"}};return h})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/TemplateJsonAnalyzer":function(){define(["./query/TemplateJsonQueryUtil"],function(h){return{collectVariablesStats:function(f){var e={};h.processTemplateFieldInfos(f,function(d){d.infographicJson&&d.infographicJson.variables?d.infographicJson.variables.forEach(function(c){e[c]=1}):d.hasVariable&&
(d.usedMapTos?d.usedMapTos.forEach(function(c){e[c]=1}):d.fullName&&(e[d.fullName]=1))});return e}}})},"esri/dijit/geoenrichment/ReportPlayer/core/infographics/utils/InfographicJsonUtil":function(){define(["esri/dijit/geoenrichment/config","esri/dijit/geoenrichment/utils/ArrayUtil"],function(h,f){var e={getDefaultLevels:function(){var d=h.levels.slice();d.push(h.highestLevel);return d},getLevels:function(d){d=d.levels&&d.levels.length?d.levels:e.getDefaultLevels();return f.removeDuplicates(d)},getSubLevels:function(d){d=
e.getLevels(d);d.pop();return d},getHighestLevel:function(d){d=e.getLevels(d);return d[d.length-1]},setLevels:function(d,c){c=f.removeDuplicates(c||[]);d.levels=c.length?c:e.getDefaultLevels()},getDataDrilling:function(d,c){"string"!==typeof c&&(c=(c=d.variableTables&&d.variableTables[c])&&c.variable.fieldInfo&&c.variable.fieldInfo.templateName);return d.dataDrilling&&d.dataDrilling[c]},setDataDrilling:function(d,c,b){c&&(d.dataDrilling=d.dataDrilling||{},b?d.dataDrilling[c]=b:delete d.dataDrilling[c])},
validateDataDrilling:function(d){var c=d.dataDrilling;if(c){var b={};d.variableTables.forEach(function(a){a.variable&&a.variable.fieldInfo&&a.variable.fieldInfo.templateName&&(b[a.variable.fieldInfo.templateName]=!0)});Object.keys(c).forEach(function(a){b[a]||delete c[a]})}},analyzeVariables:function(d){d=d.fieldInfos?d.fieldInfos.map(function(a){return a.fullName}):d.variables;if(1===d.length&&-1!==d[0].indexOf(".*"))return{dataCollectionID:d[0].substr(0,d[0].indexOf("."))};var c={},b,a;d.forEach(function(d,
e){c[d.substr(0,d.indexOf("."))]=1;b=d.substr(d.indexOf(".")+1);a=d});return{dataCollectionID:1===Object.keys(c).length?Object.keys(c)[0]:null,variableID:1===d.length?b:null,fullName:1===d.length?a:null}}};return e})},"esri/dijit/geoenrichment/config":function(){define(["esri/urlUtils"],function(h){h=h.getProtocolForWebResource();return{portalUrl:h+"//arcgis.com",server:h+"//geoenrich.arcgis.com/arcgis/rest/services/World/GeoenrichmentServer",levels:["Admin3","Admin2"],highestLevel:"Admin1",locatorUrl:h+
"//geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer",addressFormat:"${Address}, ${City}, ${Region} ${Postal}"}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/areas/AreasPreprocessor":function(){define("dojo/_base/lang esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all dojo/string esri/graphic esri/symbols/jsonUtils ./FeatureNameUtil ../tasks/EnrichAreasTask esri/dijit/geoenrichment/utils/GeometryUtil esri/dijit/geoenrichment/ReportPlayer/config dojo/i18n!esri/nls/jsapi".split(" "),
function(h,f,e,d,c,b,a,g,k,l,p){var n={preprocessAreas:function(b,c){c=c||{};b.analysisAreas=b.analysisAreas.filter(function(a){return a.feature&&a.feature.geometry&&"polygon"===a.feature.geometry.type||a.geographies&&a.geographies.length||a.buffer});-1!==c.analysisAreasLimit&&(c.analysisAreasLimit=c.analysisAreasLimit||20,b.analysisAreas.length=Math.min(b.analysisAreas.length,c.analysisAreasLimit));n.provideAreasIndexes(b);b.analysisAreas.forEach(function(a){a.feature&&!a.feature.attributes&&(a.feature.attributes=
{})});b.analysisAreas.forEach(function(b){b.name=b.name||b.shortName;if(!b.name&&b.feature){var c=a.guessFeatureName(b.feature);c&&(b.name=b.shortName=c)}});return f(m.generalize(b.analysisAreas),function(){return e([q.provideGeographyFeatures(b),r.provideBufferFeatures(b)])})},provideAreasIndexes:function(a){var b=a.combinedAreasInfo.groups,c=b&&b.length;a.analysisAreas.forEach(function(a,d){a.index=d;b&&(b.forEach(function(b,c){-1!==b.indexes.indexOf(d)&&(a.isGrouped=!0,a.groupIndex=c)}),"number"!==
typeof a.groupIndex&&(a.isGrouped=!1,a.groupIndex=c++))})},removeGroupInfo:function(a){a.forEach(function(a){delete a.isGrouped;delete a.groupIndex})}},m={generalize:function(a){var b=[],d=[];a.forEach(function(a,c){!a.feature||a.geographies&&a.geographies.length||(b.push(a.feature),d.push(c))});return f(function(a){function b(a){var b=0;a.geometry.rings.forEach(function(a){b+=a.length});return b}var d,g,e=k.needGeneralizeGeometry(a,l.generalization.factor,l.generalization.maxVerticesInAllFeatures,
l.generalization.numVerticesPerFeature),m;e&&(d=!0,g=[],a=a.map(function(a){g.push(b(a));return new c(a.geometry,a.symbol,a.attributes)}),m=k.generalizeGeometry(a,e,l.generalization.numVerticesPerFeature,!0));return f(m,function(){d&&(console.log("Generalize features:"),a.forEach(function(a,c){console.log("#"+c+" "+g[c]+" \x3d\x3e "+b(a))}));return a})}(b),function(b){d.forEach(function(c){a[c].feature=b.shift()})})}},q={provideGeographyFeatures:function(a){return e(a.analysisAreas.map(function(c){if(!c.feature&&
c.geographies&&c.geographies.length)return(new g).createFeatureForGeographies(c.geographies,{countryID:a.countryID,hierarchy:a.hierarchy}).then(function(a){c.feature=a;c.name=c.name||c.feature.attributes.StdGeographyName;c.description=c.description||p.geoenrichment.dijit.ReportPlayer.ReportPlayer.geography;c.address=c.address||c.name;c.geographies[0].attributes&&h.mixin(c.feature.attributes,c.geographies[0].attributes);if(a=c.geographies[0].symbol)a=a.toJson?a:b.fromJson(a),c.feature.setSymbol(a)})}))}},
r={provideBufferFeatures:function(a){var b=this,c=a.analysisAreas.filter(function(a){return!a.feature&&a.buffer}),d=c.map(function(a){return a.buffer});return(new g).createFeaturesForBuffers(d,{countryID:a.countryID}).then(function(a){a.forEach(function(a,d){d=c[d];d.feature=a;b._applyBufferParamsToArea(d)})})},_applyBufferParamsToArea:function(a){var c=a.buffer;if(!a.name){var g=p.geoenrichment.dijit.bufferTitle.pointRing;g[c.units]&&(a.name=d.substitute(g[c.units],{radius:c.radius}))}a.description=
a.description||"Ring";c.attributes&&h.mixin(a.feature.attributes,c.attributes);if(c=c.symbol)c=c.toJson?c:b.fromJson(c),a.feature.setSymbol(c)}};return n})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/areas/FeatureNameUtil":function(){define([],function(){return{_nameScores:[/^name$/i,/^title$/i,/(^name)|(name$)/i,/(^title)|(title$)/i],guessFeatureName:function(h){var f=Object.keys(h.attributes),e;this._nameScores.some(function(d){return f.some(function(c){if(d.test(c))return e=
c,!0})});return h.attributes[e]||""}}})},"esri/dijit/geoenrichment/utils/GeometryUtil":function(){define("dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/geometry/Polygon esri/workers/WorkerClient ./PolygonUtil ./GeometryUtil_base".split(" "),function(h,f,e,d,c,b){function a(a,b,c){var g=new f,e=new d("./mutableWorker",function(){e.importScripts(["../dijit/geoenrichment/utils/GeometryUtil_worker","../dijit/geoenrichment/utils/GeometryUtil_base"]).then(function(){e.postMessage({rings:a,maxAllowableOffset:c}).then(function(a){var c=
a.rings;b.forEach(function(a){for(var b=a.source.length=0;b<a.count;b++)a.source.push(c.shift())});g.resolve();e.terminate()})})},!0);return g.promise}var g=h.mixin({},b);g.calculateMaxAllowableOffset=function(a,b){void 0===b&&(b=1);return a.extent.getWidth()/a.width*b};g.getNumberOfPoints=c.getNumberOfPoints;g.needGeneralizeGeometry=function(a,b,c,d){if(!a||!b)return!1;d=d||(c?c/10:500);c=c||5E3;Array.isArray(a)||(a=[a]);var e=0>b,f=0,k=Math.abs(b)/100,l=0,n=0,h;a.forEach(function(a){a=a.geometry||
a;if(!a.rings||!a.getExtent)return!1;var d=a.getExtent();if(d=d.getWidth()*d.getHeight())d=Math.sqrt(d),a=g.getNumberOfPoints(a),l+=a,n=Math.max(n,a),e&&(f=Math.max(f,d*k)),h||(h=e?l>c:a*b>4*d)});return h&&n>d?f||b:0};g.generalizeGeometry=function(b,c,d,f){if(!b||!c||0>c)return!1;d=d||500;Array.isArray(b)||(b=[b]);var k=[],l=[];b.map(function(a){var b=a.geometry||a;if(b!=a&&b.rings){a.geometry=new e;a.geometry.setSpatialReference(b.spatialReference);var c=a.geometry.rings}c&&b.rings.forEach(function(a){c.push(a.slice())});
g.getNumberOfPoints(b)>d&&(a=c||b.rings,k=k.concat(a),l.push({source:a,count:a.length}))});if(f&&window.Worker)return a(k,l,c);k.forEach(function(a){(new g.RingInfo(a)).generalize(c,.8)})};return g})},"esri/workers/WorkerClient":function(){define("dojo/Evented dojo/_base/declare dojo/Deferred dojo/_base/lang dojo/request ../sniff ../kernel ../urlUtils require".split(" "),function(h,f,e,d,c,b,a,g,k){var l=window.Blob||window.webkitBlob||window.mozBlob,p=window.URL||window.webkitURL||window.mozURL;
h=f([h],{declaredClass:"esri.workers.WorkerClient",worker:null,returnDeferreds:!1,_queue:null,constructor:function(a,c,g){this._isIE=b("ie");this.returnDeferreds=!!g;this._queue={};this._acceptMessage=d.hitch(this,this._acceptMessage);this._errorMessage=d.hitch(this,this._errorMessage);a&&this.setWorker(a,d.hitch(this,function(a){this.worker=a;c(a)}))},setWorker:function(a,b){if(a instanceof Array){var c=a;a=c.shift()}var e=this._getUrl(a),e=g.normalize(e);a=!g.hasSameOrigin(e,location.href);var f;
if(!1===e)return console.log("Can not resolve worker path"),!1;this.worker&&(f=this.worker,f.removeEventListener("message",this._acceptMessage,!1),f.removeEventListener("error",this._errorMessage,!1),f.terminate(),f=null);if(a){a=this._getUrl("./mutableWorker",!0);try{this._getRemoteText(a,d.hitch(this,function(a){a=p.createObjectURL(new l([a],{type:"text/javascript"}));b(this._createWorker(a,e))}))}catch(w){try{a=g.getProxyUrl(a).path+"?"+encodeURI(a),this._useProxy=!0,b(this._createWorker(a,c))}catch(u){return console.log("Can not create worker"),
!1}}}else setTimeout(d.hitch(this,function(){b(this._createWorker(e,c))}),0)},_createWorker:function(a,b){a=new Worker(a);a.addEventListener("message",this._acceptMessage,!1);a.addEventListener("error",this._errorMessage,!1);this.worker=a;b&&this.importScripts(b);return a},postMessage:function(a,b){if(a instanceof Array||"object"!=typeof a)a={data:a};var c=Math.floor(64E9*Math.random()).toString(36);a.msgId=c;c=this._queue[c]=new e;this.worker?(b?this.worker.postMessage(a,b):this.worker.postMessage(a),
this.emit("start-message",{target:this,message:a})):c.reject({message:"No worker was set."});return this.returnDeferreds?c:c.promise||c},terminate:function(){var a=Object.keys(this._queue);this.worker&&this.worker.terminate();for(var b=a.length-1;0<=b;b--)this._queue[a[b]].cancel("terminated"),delete this._queue[a[b]]},addWorkerCallback:function(a,b){var c=this._getUrl(a,!0);!1===c?(b=new e,b.reject({message:"Could not load text from "+a})):(b=this.postMessage({action:"add-callback",url:c,cbName:b||
"main"}),b.then(d.hitch(this,function(a){a.target=this;this.emit("callback-added",a)})));return b},importScripts:function(a){Array.isArray(a)||(a=[a]);a=a.map(function(a){a=this._getUrl(a,!0);this._useProxy&&!g.hasSameOrigin(a,location.href)&&(a=g.getProxyUrl(a).path+"?"+encodeURI(a));return a},this);a=this.postMessage({action:"import-script",url:a});a.then(d.hitch(this,function(a){a.target=this;this.emit("scripts-imported",a)}));return a},_acceptMessage:function(a){var b=a.data,c=b.msgId;if(b.status&&
"debug"==b.status)console[b.showAs||"debug"](b);else if(c&&c in this._queue){var d=this._queue[c];"progress"==b.status?d.progress(a.data):("error"==b.status?d.reject(a.data):d.resolve(a.data),delete this._queue[c])}this.emit("message",{message:a.data,event:a,target:this})},_errorMessage:function(a){this.onerror||this.onError?this.onerror?this.onerror(a):this.onError(a):console.log("Worker Error: "+a.message+"\nIn "+a.filename+" on "+a.lineno)},_getUrl:function(a,b){if(!a)return console.error("can not resolve empty path"),
!1;a.match(/\.js$/)||(a+=".js");a=k.toUrl(a);return b?g.getAbsoluteUrl(a):a},_getRemoteText:function(a,b){(a=this._getUrl(a))&&c.get(a,{sync:!1,handleAs:"text",headers:{"X-Requested-With":"","Content-Type":"text/plain"}}).then(function(a){b(a)})},_startBlobWorker:function(){var a=this._xdSource;a||(a=this._getUrl("./mutableWorker"),a=new l(["if(!self._mutable){importScripts('"+a+"');}"],{type:"text/javascript"}),a=this._xdSource=p.createObjectURL(a));try{return new Worker(a)}catch(m){return console.log(m.message),
!1}}});b("extend-esri")&&d.setObject("workers.WorkerClient",h,a);return h})},"esri/dijit/geoenrichment/utils/GeometryUtil_base":function(){(function(h){function f(a,b){var c=a.length;if(3>c)return 0;b||(b=a[0]);var d=b[0];b=b[1];for(var g=a[c-1],c=g[0]-d,e=g[1]-b,f=0,k=0,h=a.length;k<h;k++)var g=a[k],w=g[0]-d,g=g[1]-b,f=f+(w*e-c*g),c=w,e=g;return f/2}var e={};e.calculateRingArea=f;e.calculateRingCentroid=function(a,b){var c=a.length;if(!c)return null;b||(b=a[0]);var d=b[0];b=b[1];var g=0,e=0,f=0;
if(2<c)for(var k=a[c-1],c=k[0]-d,h=k[1]-b,w=0,u=a.length;w<u;w++)var k=a[w],v=k[0]-d,k=k[1]-b,y=v*h-c*k,g=g+y,e=e+(c+v)*y,f=f+(h+k)*y,c=v,h=k;0==g?e=f=0:(e/=3*g,f/=3*g);return[d+e,b+f]};e.INTERIOR=1;e.EXTERIOR=-1;e.BOUNDARY=0;e.createRingInfo=function(a,c){return new b(a,c)};e.createSegmentCoordinates=function(b){return new a(null,0,0,b)};var d=function(a){return function(){for(var b in a){var c=a[b];this[b]="function"===typeof c?c.bind(this):c}a.ctr.bind(this).apply(this,arguments)}},c=d({xmin:null,
ymin:null,xmax:null,ymax:null,spatialReference:null,ctr:function(a,b,c,d,e){this.xmin=a;this.ymin=b;this.xmax=c;this.ymax=d;this.spatialReference=e},printOut:function(){console.log([this.xmin,this.xmax,this.ymin,this.ymax].join(" "))}}),b=d({ring:null,origin:null,area:0,clockwise:!1,extent:null,_coords:null,ctr:function(a,b){this.ring=a;this.origin=b;a=this.ring.length-1;if(!(0>a)){if(!a)a++;else if(this.ring[a][0]!=this.ring[0][0]||this.ring[a][1]!=this.ring[0][1])a++,this.ring.push(this.ring[0].slice());
var d=0,g=0;b=!b;this.extent=new c(this.ring[0][0],this.ring[0][1],this.ring[0][0],this.ring[0][1]);for(var e=0;e<a;e++){var k=this.ring[e],h=k[0];b&&(d+=h);h<this.extent.xmin?this.extent.xmin=h:h>this.extent.xmax&&(this.extent.xmax=h);h=k[1];b&&(g+=h);h<this.extent.ymin?this.extent.ymin=h:h>this.extent.ymax&&(this.extent.ymax=h)}b&&(this.origin=[d/a,g/a]);this.area=f(this.ring,this.origin);0>=this.area?this.area=-this.area:this.clockwise=!0}},setDirection:function(a){this.clockwise==!a&&(this.ring.reverse(),
this.clockwise=!this.clockwise,this._coords=null)},testPoint:function(a,b){a=this.getRingCoordinates(b).testPoint(a[0]-this.origin[0],a[1]-this.origin[1]);return this.clockwise?a:-a},generalize:function(a,b,c){function d(c,d,g){v=c;y=d;if(g||D<u)u=a,A=v-h,z=y-h,D=Math.sqrt(A*A+z*z),D>a*b?(A/=D,z/=D):D=0;u*=b}function g(){if(!D)return!0;var a=e.dx,b=e.dy,c=Math.sqrt(a*a+b*b);return c-a*A-b*z>=.9*c}b=b||.75;var e=this.getRingCoordinates(a),k=e.xs,l=e.ys,h=k[0],w=l[0],u,v,y,A,z,D=0,B=k.length-1;d(k[B],
l[B],!0);for(var G=this,F=this.clockwise?function(a){G.ring.splice(a,1)}:function(a){G.ring.splice(-a-1,1)};0<B--&&4<k.length;){var E=k[B],C=l[B];e.setSegment(h,w,E,C)&&e.testPointOnTouch(v,y,u)&&g()?(k.splice(B+1,1),l.splice(B+1,1),F(B+1),d(E,C)):(h=v,w=y,d(E,C,!0))}this._coords=null;c&&(this.area=f(this.ring,this.origin),this.clockwise||(this.area=-this.area))},getRingCoordinates:function(b,c){if(c)return new a(this.ring,c[0],c[1],b,this.extent,this.clockwise);this._coords&&this._coords.eps==b||
(this._coords=new a(this.ring,this.origin[0],this.origin[1],b,this.extent,this.clockwise));return this._coords}});e.RingInfo=b;var a=d({xs:null,ys:null,extent:null,eps:NaN,dx:null,dy:null,_sx:null,_sy:null,ctr:function(a,b,d,e,f,m){this.xs=[];this.ys=[];a||(a=[]);void 0===b&&(b=0);void 0===d&&(d=0);void 0===e&&(e=0);this.eps=Math.max(e,0);f&&(e=this.eps/2,this.extent=new c(f.xmin-b-e,f.ymin-d-e,f.xmax-b+e,f.ymax-d+e));var g=a.length-1;if(!(0>g))for(f=g?a[g][0]==a[0][0]&&a[g][1]==a[0][1]?g:g+1:1,e=
m?1:-1,m=m?0:g;f--;m+=e)g=a[m],this.xs.push(g[0]-b),this.ys.push(g[1]-d)},testPoint:function(a,b){if(!this._pointBelongsToExtent(a,b))return-1;var c=this.xs.length,d=!1;this.dy=this.ys[0]-this.ys[c-1];if(0==this.dy){for(d=c;1<d--&&(this.dy=this.ys[d]-this.ys[d-1],0==this.dy););if(0==this.dy)return 0}for(var d=0<this.dy,g=0,e=this.xs[0],f=this.ys[0],k,h,w=1;w<=c;w++,e=k,f=h)if(h=w==c?0:w,k=this.xs[h],h=this.ys[h],this.setSegment(e,f,k,h)){var u=f-b,v=h-b,y=!1;0>u&&(u=-u,v=-v,y=!0);if(!(u>this.eps&&
v>this.eps)){if(this.testPointOnTouch(a,b,this.eps))return 0;0==u?0!==v&&(0>v&&(d=!d),a<e&&d&&g++):0==v?d=y:0>v&&a<e+this.dx/this.dy*(b-f)&&g++}}return 0!=g%2?1:-1},testPointOnTouch:function(a,b,c){var d=this.findIntersectionDelta(a,b,a-this.dy,b+this.dx);a=this._sx+d*this.dx-a;b=this._sy+d*this.dy-b;return a*a+b*b<=c*c},_pointBelongsToExtent:function(a,b){return a>=this.extent.xmin&&a<=this.extent.xmax&&b>=this.extent.ymin&&b<=this.extent.ymax},setSegment:function(a,b,c,d){this._sx=a;this.dx=c-a;
this._sy=b;this.dy=d-b;return 0!=this.dx||0!=this.dy},findIntersectionDelta:function(a,b,c,d,e){void 0===e&&(e=!0);c-=a;d-=b;var g=this.dy*c-this.dx*d;if(0==g)return 0;var f=a-this._sx,k=b-this._sy,l=k*c-f*d,f=e?0:k*this.dx-f*this.dy;0>g&&(g=-g,l=-l,f=-f);return e||(f=0>f?0:f<g?f/g:1,this.testPointOnTouch(a+f*c,b+f*d,this.eps))?0>=l?0:l<g?l/g:1:-1},addPointOfSegmentAt:function(a){this.xs.push(this._sx+a*this.dx);this.ys.push(this._sy+a*this.dy)}});e.RingCoordinates=a;h.document?define(function(){return e}):
h.GeometryUtil_base=e})(this)},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/ReportTemplateTypes":function(){define([],function(){return{STANDARD:"esriReportTemplateStandard",MULTICOLUMN:"esriReportTemplateMultiColumn",MAP:"esriReportTemplateMapReport",FUSION:"esriReportTemplateFusion"}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/PortalToEditorConverter":function(){define("esri/dijit/geoenrichment/when ./portalToEditorUtils/layout/LayoutParser ./portalToEditorUtils/metadata/MetadataParser ./portalToEditorUtils/ImageCollector ./portalToEditorUtils/parsers/Parsers ./portalToEditorUtils/variables/PlayerVariableProvider ../supportClasses/DefaultStyles ../supportClasses/images/ImageDataHolder ../themes/conversion/CssParser esri/dijit/geoenrichment/utils/async/AsyncQueue esri/dijit/geoenrichment/utils/DelayUtil".split(" "),
function(h,f,e,d,c,b,a,g,k,l,p){return{provideEditorJson:function(n,m){function q(){function a(a,b,c){return h(m.preProcessFile&&m.preProcessFile(a,b,r),function(d){if(!1!==d)return h(c&&c(),function(){return m.postProcessFile&&m.postProcessFile(a,b,r)})})}if(t&&t.files&&t.files){var b=m.filesToProcess||["theme.css.txt","metadata.xml","report.xml"],d={"theme.css.txt":function(b){return a(b,"theme.css.txt",function(){r.theme=k.fromCssText(b.data,m)})},"metadata.xml":function(b){return a(b,"metadata.xml",
function(){return e.parseMetadataXML(b,r,m)})},"report.xml":function(b){return a(b,"report.xml",function(){return f.parseReportXML({report:n,parsers:c,file:b,templateJson:r,variableProvider:m.variableProvider,useVariableProviderToCollectOnly:m.useVariableProviderToCollectOnly,tableDefaultStyles:m.tableDefaultStyles,processFileName:u,putImageData:function(a,b){a=u(a);b=b||w[a];g.putImageData(a,b);return b},log:v,queryMetaDataFunc:function(a){return m.queryMetaDataFunc&&m.queryMetaDataFunc(a,r)},postProcessChartJson:function(a,
b){m.postProcessChartJson&&m.postProcessChartJson(r,a,b)},postProcessMapJson:function(a,b){m.postProcessMapJson&&m.postProcessMapJson(r,a,b)},postProcessInfographicJson:function(a,b){m.postProcessInfographicJson&&m.postProcessInfographicJson(r,a,b)},postProcessTableInSection:function(a,b){m.postProcessTableInSection&&m.postProcessTableInSection(r,a,b)}})})},generic:function(b,c){return a(b,c)}},q=new l;b.forEach(function(a){var b=t.files.filter(function(b){return b.name===a})[0],c=b&&(d[a]||d.generic);
c&&q.add(function(){return h(p.delay(50),function(){return c(b,a)}).otherwise(function(a){r.metadata.parseErrors.push(a);console.log(a)})})});return q.getPromise()}}m=m||{};m.variableProvider=m.variableProvider||new b;m.tableDefaultStyles=m.tableDefaultStyles||new a;var r={documentOptions:{},metadata:{specialTradeAreaCalculatorName:null,parseErrors:[],mapImageInfosHash:{},comparisonCalculatorsHash:{},locatorCalculatorsHash:{}},theme:null},t=n.portalJson,w={};m.getImageData=function(a){return w[u(a)]};
var u=function(a){return a?a.toLowerCase():""},v=m.log||function(a){};return h(c.initialize(),function(){return h(d.collectImageResources(t,w,u),function(){for(var a in w)g.putImageData(a,w[a]);return h(q(),function(){r.metadata.parseErrors.length||(n.templateJson=r)})})})}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/layout/LayoutParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter","./GraphicReportSectionsParser","./ClassicReportSectionsParser"],
function(h,f,e){return{parseReportXML:function(d){d.log(d.file.data);var c=h.parseXml(d.file.data);d.parsers.getParser("document").parseDocument(c,d);d.report.isGraphicReport?(d.templateJson.sectionsTables=[],f.parseSectionsGraphic(c,d)):(d.templateJson.sections=[],e.parseSectionsClassic(c,d))}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/layout/GraphicReportSectionsParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter"],function(h){return{parseSectionsGraphic:function(f,
e){h.queryTopJson(f,"table").forEach(function(d){try{e.templateJson.sectionsTables.push(e.parsers.getParser("section").parseTable(d,e,{fixTableWidthsForPage:!0}))}catch(c){console.log(c)}})}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/layout/ClassicReportSectionsParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter"],function(h){return{parseSectionsClassic:function(f,e){h.queryTopJson(f,"section").forEach(function(d){e.templateJson.sections.push(e.parsers.getParser("section").parseSection(d,
e,{fixTableWidthsForPage:!0}))});this._splitSections(e)},_splitSections:function(f){f=f.templateJson;var e=[];f.sections.forEach(function(d){function c(){b={type:d.type,stack:[]};e.push(b)}var b;c();d.stack.forEach(function(a){if("hr"===a.id){var d=!!b.stack.length;b.stack.push(a);d&&c()}else"table"===a.id?(b.stack.some(function(a){return"table"===a.id})&&c(),b.stack.push(a)):"pageBreak"===a.id?(b.stack.length&&c(),b.stack.push(a),c()):b.stack.push(a)})});e=e.filter(function(d){return!!d.stack.length});
f.sections=e}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/MetadataParser":function(){define("esri/dijit/geoenrichment/promise/all esri/dijit/geoenrichment/utils/JsonXmlConverter ./DataCollectionsCalculatorsParser ./ScriptsCalculatorsParser ./LocatorCalculatorsParser ./map/MapCalculatorsParser ./TradeAreaCalculatorsParser".split(" "),function(h,f,e,d,c,b,a){return{parseMetadataXML:function(g,k,l){l.log&&l.log(g.data);var p=f.parseXml(g.data);if(p&&p.tags)return h([a.parseTradeAreaCalculators(p,
k,l),e.parseDataCollectionsCalculators(p,k,l),d.parseScriptsCalculators(p,k,l),c.parseLocatorCalculators(p,k,l)]).then(function(){return b.parseMapCalculators(p,k,l)})}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/DataCollectionsCalculatorsParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter","./VariableScriptCollector","../../../../_devConfig"],function(h,f,e){return{parseDataCollectionsCalculators:function(d,c,b){h.queryJson(d,"DataCollections").forEach(function(a){var d=
h.queryJson(a,"ComparisonLevel");if(e.emulateErrors.metadataParseError)throw Error("Error test: something crashed during the parsing of the metadata!");var k;if(b.variableProvider.isPlayerOnly||d.length)k=f.getObjects(a);d.length&&(a={calculatorName:a.attributes.Name,levels:d.map(function(a){return a.attributes.Name}).filter(function(a){return!b.validateGeographyLevelFunc||b.validateGeographyLevelFunc(a)}),variableObjects:k.variableObjects},c&&(c.metadata.comparisonCalculatorsHash[a.calculatorName]=
a));b.variableProvider.isPlayerOnly&&(k.variableObjects.forEach(function(a){b.variableProvider.addVariable(a)}),k.scriptObjects.forEach(function(a){b.variableProvider.addScriptVariable(a)}))})}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/VariableScriptCollector":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter","../variables/VariableUtil"],function(h,f){var e={getObjects:function(d,c){c=e._getVariableInfo(d,c);d=e._getScriptObjects(d,
c.fieldNameToVariableCache);return{variables:c.variables,variableObjects:c.variableObjects,scriptObjects:d}},_getVariableInfo:function(d,c){var b=[];h.queryJson(d,c?/^(RawFields|Fields)$/:"Fields").forEach(function(a){b=b.concat(h.queryJson(a,/^(Field|PortalField)$/))});var a=[],g=[],e={};b.forEach(function(b){a.push(b.attributes.MapTo);if(b=f.fieldTagToVariable(b,d.attributes.Name))e[b.fieldName]=b,g.push(b)});return{variables:a,variableObjects:g,fieldNameToVariableCache:e}},_getScriptObjects:function(d,
c){var b=h.queryJson(d,"Scripts"===d.name?"Fields":"CalculatedFields")[0],b=b&&h.queryJson(b,"Script")||[];"Scripts"===d.name&&(b=b.filter(function(a){return!("STORE_ID"===a.attributes.Name||"AREA_ID"===a.attributes.Name)}));return b.map(function(a){var b=f.scriptTagToVariable(a,d.attributes.Name);b.usedFields&&(b.usedMapTos=[],b.usedFields.forEach(function(a){var d=c[a];d?d.usedMapTos?b.usedMapTos=b.usedMapTos.concat(d.usedMapTos):b.usedMapTos.push(d.fullName):console.log("Error parsing used fields for "+
a)}),c[b.fieldName]=b);return b})}};return e})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/variables/VariableUtil":function(){define([],function(){var h={getType:function(f,e){return f?0===f.indexOf("esriFieldType")?f:"esriFieldType"+f:e},fieldTagToVariable:function(f,e){return f.attributes.MapTo&&"AREA_ID"!==f.attributes.Name?{id:f.attributes.MapTo.substr(f.attributes.MapTo.lastIndexOf(".")+1),fullName:f.attributes.MapTo,alias:f.attributes.Alias,fieldName:f.attributes.Name,
precision:Number(f.attributes.Decimals)||0,calculatorName:e,templateName:e+"."+f.attributes.Name,type:h.getType(f.attributes.Type,f.attributes.Decimals?"esriFieldTypeDouble":"esriFieldTypeString"),vintage:null,source:null}:null},scriptTagToVariable:function(f,e){return{id:f.attributes.Name,fullName:e+"."+f.attributes.Name,fieldName:f.attributes.Name,alias:f.attributes.Alias,precision:Number(f.attributes.Decimals)||0,usedFields:f.attributes.usedFields?f.attributes.usedFields.split(","):[],usedMapTos:null,
expressionText:f.tags[0].text,calculatorName:e,templateName:e+"."+f.attributes.Name,type:h.getType(f.attributes.Type,f.attributes.Decimals?"esriFieldTypeDouble":"esriFieldTypeString")}}};return h})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/ScriptsCalculatorsParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter","./VariableScriptCollector"],function(h,f){return{parseScriptsCalculators:function(e,d,c){h.queryJson(e,"Scripts").forEach(function(b){c.variableProvider.isPlayerOnly&&
(b=f.getObjects(b),b.variableObjects.forEach(function(a){c.variableProvider.addVariable(a)}),b.scriptObjects.forEach(function(a){c.variableProvider.addScriptVariable(a)}))})}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/LocatorCalculatorsParser":function(){define(["esri/dijit/geoenrichment/promise/all","esri/dijit/geoenrichment/when","esri/dijit/geoenrichment/utils/JsonXmlConverter","../variables/VariableUtil"],function(h,f,e,d){return{parseLocatorCalculators:function(c,
b,a){c=e.queryJson(c,"Locator");return h(c.map(function(c){var g=[];e.queryJson(c,/^(PointFields|Fields)$/).forEach(function(a){g=g.concat(e.queryJson(a,/^(Field|Direction|Distance)$/))});var l=[];g.forEach(function(a){"Direction"===a.name?a.attributes.MapTo="DIRECTION":"Distance"===a.name&&(a.attributes.MapTo="DISTANCE");(a=d.fieldTagToVariable(a,c.attributes.Name))&&l.push(a)});var h={calculatorName:c.attributes.Name,variableObjects:l,layerID:null,layerUrl:null,layerName:c.attributes.LayerName};
c.attributes.Points&&0===c.attributes.Points.indexOf("std:")?h.layerID=c.attributes.Points.replace("std:",""):h.layerUrl=c.attributes.Layer;b.metadata.locatorCalculatorsHash[c.attributes.Name]=h;a.variableProvider.isPlayerOnly&&l.forEach(function(b){a.variableProvider.addVariable(b)});return f(!a.validateLocatorCalculator||a.validateLocatorCalculator(h.layerID,h.layerUrl),function(a){h.isValid=a})}))}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/map/MapCalculatorsParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter",
"./MetadataToRendererParser","./MapTagsUtil","esri/dijit/geoenrichment/utils/ImageUtil"],function(h,f,e,d){var c={parseMapCalculators:function(b,a,d){h.queryJson(b,"Maps").forEach(function(b){h.queryJson(b,"Map").forEach(function(e){var g=c._parsePortalLayers(e),f=c._parseStudyAreas(e),g={fieldName:e.attributes.Name,width:Number(e.attributes.Width),height:Number(e.attributes.Height),defaultBasemapId:g.defaultBasemapId,webMapId:g.webMapId,additionalLayerInfos:c._parseAdditionalLayers(e,a),pinSymbolJson:c._parseSiteLayerPinSymbol(e,
d),areaSymbolJsons:f.symbolJsons,areaSymbolRamp:f.ramp,mapScale:Number(e.attributes.Scale)||null};a&&(a.metadata.mapImageInfosHash[b.attributes.Name+"."+e.attributes.Name]=g)})})},_parsePortalLayers:function(b){var a;b=h.queryJson(b,"Layer").filter(function(a){return!!a.attributes.PortalItemId});1<b.length&&(a=b.shift());b=b.shift();return{defaultBasemapId:a&&a.attributes.PortalItemId,webMapId:b&&b.attributes.PortalItemId}},_parseAdditionalLayers:function(b,a){var c=[];h.queryJson(b,/^(Layer|LocatorResultsLayer|ComparisonResultsLayer)$/).filter(function(a){return!!a.attributes.ServiceUrl||
"LocatorResultsLayer"===a.name||"ComparisonResultsLayer"===a.name}).forEach(function(b){if(b.attributes.ServiceUrl)c.push({url:b.attributes.ServiceUrl});else if("LocatorResultsLayer"===b.name){var d=b.tags&&b.tags.filter(function(a){return"Renderer"===a.name})[0],e=a.metadata.locatorCalculatorsHash[b.attributes.CalculatorName];e.isValid&&c.push({isLocatorLayer:!0,layerName:b.attributes.LayerName,calculatorName:b.attributes.CalculatorName,calculatorInfo:e,rendererJson:d&&f.parseRendererJson(d)})}else"ComparisonResultsLayer"===
b.name&&((d=(d=b.tags&&b.tags.filter(function(a){return"Renderer"===a.name})[0])&&f.parseRendererJson(d))&&"esriTS"===d.uniqueValueInfos[0].symbol.type?c[c.length-1].labelRendererJson=d:(e=(e=b.tags&&b.tags.filter(function(a){return"LabelingInfo"===a.name})[0])&&f.parseLabelRendererJson(e),c.push({isComparisonLayer:!0,calculatorName:b.attributes.CalculatorName,rendererJson:d,labelRendererJson:e})))});return c.length&&c},_parseSiteLayerPinSymbol:function(b,a){var c;if(b=h.queryJson(b,"SiteLayer")[0])if((b=
h.queryJson(b,"Symbol")[0])&&"Image"===b.attributes.Type)(a=a.getImageData(b.attributes.Name))&&(c={type:"esriPMS",contentType:d.getContentType(a),imageData:d.base64DataFromDataURL(a),url:b.attributes.Url,width:Number(b.attributes.Width),height:Number(b.attributes.Height),angle:Number(b.attributes.Angle)||0,xoffset:Number(b.attributes.XOffset)||0,yoffset:Number(b.attributes.YOffset)||0});else if(b&&"Marker"===b.attributes.Type){c=(c=h.queryJson(b,"Fill")[0])&&h.queryJson(c,"Color")[0];var f=(a=h.queryJson(b,
"Outline")[0])&&h.queryJson(a,"Color")[0];c={type:"esriSMS",style:"esriSMS"+(b.attributes.Style||"Circle"),size:Number(b.attributes.Size),angle:Number(b.attributes.Angle)||0,xoffset:Number(b.attributes.XOffset)||0,yoffset:Number(b.attributes.YOffset)||0,color:e.parseColorTag(c),outline:a&&{type:"esriSLS",color:e.parseColorTag(f),style:"esriSLS"+(a.attributes.Style||"Solid"),width:void 0===a.attributes.Width?0:Number(a.attributes.Width)}}}return c},_parseStudyAreas:function(b){var a=(b=h.queryJson(b,
"StudyAreasLayer")[0])&&h.queryTopJson(b,"SymbolsPalette")[0];b=(a&&h.queryTopJson(a,"Symbol")||[]).map(c._parseAreaSymbol);var d=a&&h.queryTopJson(a,"SymbolRamp")[0],e;d&&(a=h.queryTopJson(d,"First")[0],d=h.queryTopJson(d,"Last")[0],a=a&&h.queryTopJson(a,"Symbol")[0],d=d&&h.queryTopJson(d,"Symbol")[0],a&&d&&(e=[a,d].map(c._parseAreaSymbol)));return{ramp:e,symbolJsons:b}},_parseAreaSymbol:function(b){var a=h.queryJson(b,"Fill")[0],a=a&&h.queryJson(a,"Color")[0],c=(b=h.queryJson(b,"Outline")[0])&&
h.queryJson(b,"Color")[0];return{type:"esriSFS",style:"esriSFSSolid",color:e.parseColorTag(a)||[0,0,0,1],outline:b&&{type:"esriSLS",color:e.parseColorTag(c),style:"esriSLS"+(b.attributes.Style||"Solid"),width:void 0===b.attributes.Width?0:Number(b.attributes.Width)}}}};return c})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/map/MetadataToRendererParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlTypedConverter","esri/dijit/geoenrichment/utils/JsonXmlConverter"],
function(h,f){return{parseRendererJson:function(e){return h.parseXml(f.parseJson(e))},parseLabelRendererJson:function(e){return{type:"uniqueValue",field1:"StdGeographyLevel",uniqueValueInfos:h.parseXml(f.parseJson(e)).map(function(d){return{value:d.where.match(/StdGeographyLevel='(.*?)'/)[1],symbol:d.symbol}})}}}})},"esri/dijit/geoenrichment/utils/JsonXmlTypedConverter":function(){define(["dojo/_base/declare","./RegExpUtil"],function(h,f){var e=h(null,{parseJson:function(d,c){function b(c,d){if("string"===
typeof c)k+="\x3c"+d+' type\x3d"string"\x3e'+f.encodeXML(c,!1)+"\x3c/"+d+"\x3e";else if("number"===typeof c)k+="\x3c"+d+' type\x3d"number"\x3e'+c+"\x3c/"+d+"\x3e";else if("boolean"===typeof c)k+="\x3c"+d+' type\x3d"boolean"\x3e'+c+"\x3c/"+d+"\x3e";else if(Array.isArray(c))a(c,d);else if(c&&"object"===typeof c){k+="\x3c"+d+' type\x3d"object"\x3e';for(var e in c)b(c[e],e);k+="\x3c/"+d+"\x3e"}}function a(a,c){k+="\x3c"+c+' type\x3d"array"\x3e';a.forEach(function(a){b(a,"item")});k+="\x3c/"+c+"\x3e"}
var e=c&&c.rootName||"root",k="";c&&c.addDocumentOptions&&(k+='\x3c?xml version\x3d"1.0" encoding\x3d"utf-8"?\x3e');b(d,e);return k=decodeURIComponent(encodeURIComponent(k).replace("%19",""))},parseXml:function(d){function c(a){if(!a.attributes)return null;for(var b=0;b<a.attributes.length;b++){var c=a.attributes[b];if("type"===c.name)return c.value}return null}function b(b,c){if(c.childNodes)for(var d=0,e=c.childNodes.length;d<e;d++){var g=c.childNodes[d],f=a(g);void 0!==f&&(b[g.nodeName]=f)}return b}
function a(a){var d=c(a);if(a.nodeName&&d)switch(d){case "string":return a.childNodes[0]?f.decodeXML(a.childNodes[0].nodeValue):"";case "number":return Number(a.childNodes[0].nodeValue);case "boolean":return"true"===a.childNodes[0].nodeValue;case "object":return b({},a);case "array":return e([],a)}}function e(b,c){if(c.childNodes)for(var d=0,e=c.childNodes.length;d<e;d++)b[d]=a(c.childNodes[d]);return b}var k,l;d=(new DOMParser).parseFromString(d,"text/xml").childNodes;for(var h=0;h<d.length;h++)if(1===
d[h].nodeType){l=d[h];break}l&&(d=c(l),"object"===d?b(k={},l):"array"===d&&e(k=[],l));return k}});h=e();h.runTest=function(){console.log("------------------------------Testing JsonXmlTypedConverter.js------------------------------");var d={type:"uniqueValue",field1:"SubtypeCD",fieldDelimiter:", ",defaultSymbol:{type:"esriSLS",style:"esriSLSSolid",color:[130,130,130,255],width:1},defaultLabel:"\x3cOther values\x3e",uniqueValueInfos:[{value:"1",label:"Duct Bank",description:"Duct Bank description",
symbol:{type:"esriSLS",style:"esriSLSDash",color:[76,0,163,255],width:1}},{value:"2",label:"Trench",description:"Trench description",symbol:{type:"esriSLS",style:"esriSLSDot",color:[115,76,0,255],width:1}}],rotationType:"geographic",rotationExpression:"[Rotation] * 2"},c=new e,d=JSON.parse(JSON.stringify(d));console.log(JSON.stringify(d,void 0,4));var b=c.parseJson(d);console.log(b);var a=c.parseXml(b);console.log(JSON.stringify(a,void 0,4));c=c.parseJson(a);console.log(c);console.log("Compare JSON1 and JSON2: "+
(JSON.stringify(d)===JSON.stringify(a)));console.log("Compare XML1 and XML2: "+(b===c));console.log("------------------------------Testing JsonXmlTypedConverter.js------------------------------")};return h})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/map/MapTagsUtil":function(){define([],function(){return{parseColorTag:function(h){if(!h)return null;h=h.attributes;return[Number(h.Red)||0,Number(h.Green)||0,Number(h.Blue)||0,h.Transparency?255*(1-Number(h.Transparency)/
100):255]}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/TradeAreaCalculatorsParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter","./VariableScriptCollector","../../../supportClasses/templateJsonUtils/fieldInfo/FieldLibrary"],function(h,f,e){return{parseTradeAreaCalculators:function(d,c,b){d=h.queryJson(d,"SpecialTradeAreaFields");c.metadata.specialTradeAreaCalculatorName=d[0]&&d[0].attributes&&d[0].attributes.Name;d.forEach(function(a){b.variableProvider.isPlayerOnly&&
f.getObjects(a,!0).variableObjects.forEach(function(a){a.alias=a.alias||e.getFieldLabel(a.id);b.variableProvider.addVariable(a)})})}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/ImageCollector":function(){define(["esri/dijit/geoenrichment/when","esri/dijit/geoenrichment/promise/all","esri/dijit/geoenrichment/utils/DataUtil","esri/dijit/geoenrichment/utils/ImageUtil","esri/dijit/geoenrichment/utils/ImageInfoUtil"],function(h,f,e,d,c){return{collectImageResources:function(b,
a,g){function k(b){return h(c.getImageInfo(a[b],b),null,function(){delete a[b]})}b&&b.files&&b.files.forEach(function(b){var c=e.getContentType(b.name);c&&"image/"===c.substr(0,6)&&(a[g(b.name)]=d.base64DataToDataURL(b.data,c))});b=[];for(var l in a)b.push(k(l));return f(b)}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/parsers/Parsers":function(){define(["esri/dijit/geoenrichment/Deferred","require"],function(h,f){var e={},d={},c;e.initialize=function(){if(c)return c.promise;
c=new h;f("./DocumentParser ./ChartConverterPtoE ./InfographicConverterPtoE ./SectionParser ./FieldParser ./FilterParser ./SortingParser ../../../supportClasses/templateJsonUtils/fieldInfo/utils".split(" "),function(b,a,e,f,l,h,n,m){d.document=b;d.chart=a;d.infographic=e;d.section=f;d.field=l;d.filter=h;d.sorting=n;m.init().then(c.resolve)});return c.promise};e.getParser=function(b){return d[b]};return e})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/variables/PlayerVariableProvider":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/string","dojo/i18n!esri/nls/jsapi"],function(h,f,e,d){d=d.geoenrichment.dijit.ReportPlayer.Variables;var c=h(null,{variable:null,constructor:function(b){this.variable=b},calculate:function(b){return 0},getCalcType:function(){return"n/"},getAliasWithType:function(){return this.variable.alias},getDescriptionWithType:function(){return this.variable.alias},getDecimals:function(){return this.variable.precision||0}});return h(null,{isPlayerOnly:!0,_fieldNameToVariableCache:null,
_templateNameToVariableCache:null,constructor:function(b){this._templateNameToVariableCache=b&&b.templateNameToVariableCache||{};this._fieldNameToVariableCache={};for(var a in this._templateNameToVariableCache)b=this._templateNameToVariableCache[a],this._fieldNameToVariableCache[b.fieldName]=b},get:function(b){return this._templateNameToVariableCache[b]||this._fieldNameToVariableCache[b]},toCalculator:function(b){return(b=this.get(b))&&new c(b)},addVariable:function(b){this._fieldNameToVariableCache[b.fieldName]=
b;this._templateNameToVariableCache[b.templateName]=b},addScriptVariable:function(b){this._fieldNameToVariableCache[b.fieldName]=b;this._templateNameToVariableCache[b.templateName]=b},getVariables:function(){return Object.keys(this._fieldNameToVariableCache).map(function(b){return this._fieldNameToVariableCache[b]},this)},getVariablesDataVintageDescription:function(b){var a={},c={},f={};this.getVariables().forEach(function(a){a.fullName&&(f[a.fullName.toLowerCase()]=a)});for(var l in b.usedVariablesCache)if(b=
f[l.toLowerCase()])b.vintage&&(c[b.vintage]=1),b.source&&(a[b.source]=1);if(!Object.keys(a).length&&!Object.keys(c).length)return"";l=[];Object.keys(a).length&&l.push(e.substitute(d.sourcePattern,{source:Object.keys(a).join(", ")}));Object.keys(c).length&&l.push(e.substitute(d.vintagePattern,{vintage:Object.keys(c).join(", ")}));return l.join(" ")},toJson:function(){return{templateNameToVariableCache:f.clone(this._templateNameToVariableCache)}}})})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/DefaultStyles":function(){define(["dojo/_base/declare",
"dojo/_base/lang","esri/dijit/geoenrichment/utils/ColorUtil"],function(h,f,e){return h(null,{_styles:null,_stylesArray:null,constructor:function(d){this._styles={Default:{color:"#4C4C4C",backgroundColor:"#FFFFFF"}};f.mixin(this._styles,d);this._stylesArray=[];for(var c in this._styles)this._stylesArray.push(c)},getStyle:function(d){return this._styles[d]},getStylesArray:function(){return this._stylesArray},tryApplyStyle:function(d,c,b){if(c=this.getStyle(c))for(var a in c)b&&void 0!==d[a]||(d[a]=
c[a])},findDefaultStyle:function(d){var c,b=this;this.getStylesArray().some(function(a){var g=b.getStyle(a),f;for(f in g){if(!d[f])return!1;if("color"===f||"backgroundColor"===f){if(!e.colorsEqual(d[f],g[f]))return!1}else if(d[f]!==g[f])return!1}c=a;return!0});return c}})})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/images/ImageDataHolder":function(){define([],function(){var h={},f={},e={};h.putImageData=function(d,c){if("string"===typeof d&&c){var b=d.toLowerCase();e[b]=d;f[b]=c}else console.error("Invalid image filename or data!")};
h.getImageData=function(d){return"string"!==typeof d?null:f[d.toLowerCase()]};h.findFileNameByData=function(d){for(var c in f)if(d===f[c])return e[c];return null};return h})},"esri/dijit/geoenrichment/ReportPlayer/core/themes/conversion/CssParser":function(){define(["../PageBorderStyles","../ThemeUpdateUtil","../../../_devConfig"],function(h,f,e){var d={"font-size":"fontSize","font-family":"fontFamily","font-style":"fontStyle","font-weight":"fontWeight","text-decoration":"textDecoration",color:"color",
"background-color":"backgroundColor",opacity:"opacity",url:"data","background-position":"position","background-repeat":"repeat","background-size":"scale"},c={colors:1,colors3series:1};return{fromCssText:function(b){function a(a){var b=p;a.split("@").forEach(function(a){b=b[a]=b[a]||{}});return b}function g(a,b){if(b.borderStyle||b.border)if(a.border={},a.border.style=h.toSupportedValue(b.borderStyle),"string"===typeof b.border){var c=b.border.split(" ");3===c.length&&(a.border.thickness=Number(c[0].replace("px",
"")),a.border.lineStyle=c[1],a.border.color=c[2])}for(var e in b)if("border"!==e&&"borderStyle"!==e){var c=b[e],g;g=e;var f=c,m=a;"font-size"===g?(m[d[g]]=k(f.replace("px","")),g=!0):"background-repeat"===g?(m[d[g]]=k("repeat"===f),g=!0):"background-size"===g?(m[d[g]]=k("contain"===f||"cover"===f),m.size="auto"===f?null:f,g=!0):g=!1;g||(a[d[e]||e]=k(c))}}function k(a){if(void 0===a||null===a||"null"===a||"undefined"===a)return"";if("true"===a)return!0;if("false"===a)return!1;if(!0===a)return!0;if(!1===
a)return!1;var b=Number(a);return isNaN(b)?a:b}function l(a){if(e.emulateErrors.themeParseError)throw Error("Error test: something crashed during the parsing of the theme!");if("object"===typeof a)for(var b in a){var d=a[b];if(c[b]){var g=[],f=Object.keys(d);if(f.length){var k=f.every(function(a){return-1!==a.indexOf("_")});f.forEach(function(a,b){g[k?a.split("_")[1]:b]=d[a]})}a[b]=g}else l(d)}}var p={};b=b.replace(/\n/g,"");b=b.replace(/(\w|\d)_(\w|\d)/g,"$1@$2");b=b.replace("data:","dataM");b=b.replace(";base64",
"Mbase64");var n=function(){var a={};(b.match(/\..*?\}/g)||[]).forEach(function(b){var c=b.substring(1,b.indexOf("{")).trim(),d={};b.substring(b.indexOf("{")+1,b.indexOf("}")).trim().split(";").forEach(function(a){if(a=a.trim()){a=a.split(":");var b=a[1].trim(),b=b.replace("dataM","data:"),b=b.replace("Mbase64",";base64");d[a[0].trim()]=b}});a[c]=d});return a}(),m;for(m in n)g(a(m),n[m]);delete p.themeMetadata;l(p);f.populateMissingStyles(p);return p}}})},"esri/dijit/geoenrichment/ReportPlayer/core/themes/ThemeUpdateUtil":function(){define(["dojo/_base/lang",
"esri/dijit/geoenrichment/utils/ObjectUtil","./ThemeLibrary","./ThemeUtil"],function(h,f,e,d){return{populateMissingStyles:function(c){if(c){c.table&&c.table.overrideStyles||(c.table={overrideStyles:h.mixin({},c.table)});c.icon||(c.icon=h.clone(c.infographic.staticInfographic.icon),c.highlightedIcon=h.clone(c.infographic.staticInfographic.highlightedIcon));c.chart.icon||(c.chart.icon=h.clone(c.infographic.staticInfographic.icon));c.chart.xAxis.lineColor||(c.chart.xAxis.lineColor=c.chart.xAxis.axisStyle.color,
c.chart.yAxis.lineColor=c.chart.yAxis.axisStyle.color);var b=d.getThemeColors(c),a=c.chart.colors.slice(),g=c.chart.colors3series&&c.chart.colors3series.slice(),k=e.getDefaultTheme({defaultFontFamilty:c.document.fontFamily,defaultFontSize:c.document.fontSize});d.applyThemeColorsToTheme({theme:k,colors:b,chartColors:a,colors3series:g});f.populateObject(c,k,!1)}}}})},"esri/dijit/geoenrichment/utils/async/AsyncQueue":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when dijit/Destroyable ../DelayUtil".split(" "),
function(h,f,e,d,c,b){var a=h(c,{_lastPromise:null,_isFinished:!1,_isDestroyed:!1,_lastDfd:null,_lastResult:null,constructor:function(a){f.mixin(this,a)},add:function(a,c){c=c||{};var g=this;if(!this._isDestroyed){this._lastDfd||(this.onStarted(),this._lastDfd=new e);this._isFinished=!1;var f=function(){var f=function(){if(!g._isDestroyed)try{return"function"===typeof a?a():a}catch(r){return(new e).reject(r)}},k=0<=c.delayBefore?function(){return b.delay(f,c.delayBefore)}:f;return(0<=c.delayAfter?
function(){return d(k(),function(a){return b.delay(function(){return a},c.delayAfter)})}:k)()};!this._lastPromise||this._lastPromise.isFulfilled()?this._lastPromise=d(f()):this._lastPromise=d(this._lastPromise).then(f);var k=this._lastPromise;d(k,function(a){k!==g._lastPromise||g._isDestroyed||g._isFinished||k&&!k.isFulfilled()||(g._isFinished=!0,g._lastDfd.resolve(a),g._lastResult=a,g._lastDfd=null,g.onFinished(a))},this._lastDfd.reject);return this.getPromise()}},getPromise:function(){return this._isDestroyed?
null:this._lastDfd&&this._lastDfd.promise||this._lastResult},isFinished:function(){return this._isFinished},isDestroyed:function(){return this._isDestroyed},destroy:function(){this._isDestroyed=!0},onStarted:function(){},onFinished:function(a){}});a.executeFunctions=function(b,c,e){e=e||{};var g=new a,f=[];b.forEach(function(a,b){g.add(function(){return d(a(),function(a){f.push(a);return a})},{delayBefore:0===b?void 0:c})});e.onQueueReady&&e.onQueueReady(g);return d(g.getPromise(),function(a){return e.collectResults?
f:a})};a.processArrayInBatches=function(a,b){function c(){if(a.length){for(var e=[],g=0;g<b.batchSize&&a.length;g++)e.push(a.shift());b.processBatch?b.callback(e):e.forEach(b.callback);setTimeout(c,b.timeout||0)}else d.resolve()}a=a.slice();var d=new e;c();return d.promise};return a})},"esri/dijit/geoenrichment/utils/DelayUtil":function(){define(["esri/dijit/geoenrichment/Deferred"],function(h){return{delay:function(f,e){var d=new h,c="function"===typeof f?f:null;setTimeout(d.resolve,("number"===
typeof f?f:e)||0);return d.promise.then(function(){return c&&c()})}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/AttachmentsStoreSerializer":function(){define("esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all ./AttributesUtil ./NotesUtil ./CustomAttachmentsStore esri/dijit/geoenrichment/utils/ImageInfoUtil".split(" "),function(h,f,e,d,c,b){return{getAttachmentsStoreJson:function(a,c){function g(a){if(c.noCache)return a;n=n||{};for(var b in n)if(n[b]===
a)return b;b="image_"+p++;n[b]=a;return b}function l(){return f([c.saveImages&&a.getImages(),a.getAttributes(),a.getNotes()]).then(function(a){var c=a[0]||[],k=a[1]||[],m=a[2]||[];return f(c.map(function(a){return f([h(a.getThumbnail(),function(a){return b.ensureDataUrlForRemoveImage(a)}),h(a.getUrl(),function(a){return b.ensureDataUrlForRemoveImage(a)})]).then(function(b){a.__thumbnail=g(b[0]);a.__url=g(b[1])})})).then(function(){return{images:c.map(function(a){var b=a.__thumbnail,c=a.__url;delete a.__thumbnail;
delete a.__url;return{description:a.description,thumbnail:b,url:c,filename:a.filename,imageViewType:a.imageViewType}}),attributes:k.map(function(a){return e.attributeToJson(a)}),notes:m.map(function(a){return d.noteToJson(a)})}})})}if(!a)return null;var p=0,n,m=[],q=[];if(a.supportsMultipleAreas)for(var r=0;r<c.numAreas;r++)a.setCurrentAnalysisAreaIndex(r),q.push(h(l(),function(a){m.push(a)}));else q.push(h(l(),function(a){m.push(a)}));return f(q).then(function(){return{supportsMultipleAreas:a.supportsMultipleAreas,
areaAttachments:m,imageDataCache:n}})},getAttachmentsStoreFromJson:function(a){return a&&new c(a)}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/NotesUtil":function(){define([],function(){return{noteToJson:function(h){return{text:h.text}},noteFromJson:function(h){return{text:h.text}}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/CustomAttachmentsStore":function(){define(["dojo/_base/declare","esri/dijit/geoenrichment/when"],
function(h,f){var e={fromJson:function(d){function c(b){return d.imageDataCache&&d.imageDataCache[b]||b}d.areaAttachments=d.areaAttachments||d.areaAttachements;delete d.areaAttachements;return{getImagesForAreaAt:function(b){b=d.supportsMultipleAreas?b:0;return(d.areaAttachments[b]&&(d.areaAttachments[b].images||d.areaAttachments[b].attachments)||[]).map(function(a){return{description:a.description,filename:a.filename,imageViewType:a.imageViewType,getThumbnail:function(){return c(a.thumbnail)},getUrl:function(){return c(a.url)}}})},
getAttributesForAreaAt:function(b){b=d.supportsMultipleAreas?b:0;return d.areaAttachments[b]&&d.areaAttachments[b].attributes||[]},getNotesForAreaAt:function(b){b=d.supportsMultipleAreas?b:0;return d.areaAttachments[b]&&d.areaAttachments[b].notes||[]}}}};return h(null,{supportsMultipleAreas:!1,_currentAreaIndex:0,_provider:null,constructor:function(d){(this._provider=d.getAttachmentsForAreaAt||d.getImagesForAreaAt||d.getAttributesForAreaAt||d.getNotesForAreaAt?d:e.fromJson(d))&&this._provider.getAttachmentsForAreaAt&&
(d.getImagesForAreaAt=function(c){return d.getAttachmentsForAreaAt(c)});this.supportsMultipleAreas=d.supportsMultipleAreas},initialize:function(){},getImages:function(){function d(b){b.forEach(function(a){!a.getUrl&&a.getAttachmentUrl&&(a.getUrl=function(){return a.getAttachmentUrl()})})}var c=this._provider.getImagesForAreaAt?this._provider.getImagesForAreaAt(this._currentAreaIndex):[];return c?Array.isArray(c)?(d(c),c):f(c,function(b){d(b);return b}):c},getAttributes:function(){return this._provider.getAttributesForAreaAt?
this._provider.getAttributesForAreaAt(this._currentAreaIndex):[]},getNotes:function(){return this._provider.getNotesForAreaAt?this._provider.getNotesForAreaAt(this._currentAreaIndex):[]},setCurrentAnalysisAreaIndex:function(d){this._currentAreaIndex=d}})})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/TemplateJsonSerializer":function(){define(["./query/TemplateJsonQueryUtil","../images/ImageDataHolder","../conditionalStyling/ConditionalStyleUtil"],function(h,f,e){return{serialize:function(d){this._attachImagesToTemplateJson(d);
return d},_attachImagesToTemplateJson:function(d){function c(a){var c=f.getImageData(a);c&&(b[a]=c)}var b={};h.processTemplateFieldInfos(d,function(a){a.isImage?(c(a.imageJson.fileName),a.triggerJson&&e.collectImageFileNames(a.triggerJson).forEach(c)):a.isInfographic&&a.infographicJson.variableTables&&a.infographicJson.variableTables.forEach(function(a){a.image&&c(a.image.imageJson.fileName)})});h.processSectionElements(d,function(a){"img"===a.id&&c(a.fileName)});d.imageData=b},deserialize:function(d){this._takeImagesFromTemplateJson(d);
return d},_takeImagesFromTemplateJson:function(d){for(var c in d.imageData)f.putImageData(c,d.imageData[c]);delete d.imageData}}})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/conditionalStyling/ConditionalStyleUtil":function(){define(["esri/dijit/geoenrichment/utils/PageUnitsConverter"],function(h){var f={},e={FontSize:"fontSize",FontColor:"fontColor",FontFamily:"fontFamily",ForeColor:"color",BackColor:"backgroundColor"},d={},c;for(c in e)d[e[c]]=c;f.getConditionalStyle=function(a,
b){return(a=f.getMatchedCase(a,b))?f.styleFromSetters(a.setters):null};f.getMatchedCase=function(a,b){if(null!==a&&""!==a&&(a=Number(a),b&&!isNaN(a))){var c;b.cases.some(function(b){if(f._checkValueMatchesCase(a,b))return c=b,!0});return c}};f._checkValueMatchesCase=function(a,b){function c(a,b,c){switch(b){case "\x3d":return a===c;case "\x3c":return a<c;case "\x3e":return a>c;case "\x3c\x3d":return a<=c;case "\x3e\x3d":return a>=c}return!1}return b.compareInfos.length&&b.compareInfos.every(function(b){return c(a,
b.operator,Number(b.value))})};f.styleFromSetters=function(a){if(!a)return null;var b={};a.forEach(function(a){e[a.property]&&(b[e[a.property]]=a.value);"IsBold"===a.property&&(b.fontWeight="True"===a.value?"bold":"normal");"IsItalic"===a.property&&(b.fontStyle="True"===a.value?"italic":"normal");"IsUnderlined"===a.property&&(b.textDecoration="True"===a.value?"underline":"none")});h.ptToPxObj(b);return b};f.settersFromStyle=function(a){var b=[];a=h.pxToPtObj(a,!0);for(var c in a){var e=d[c],f=a[c];
!e||"string"!==typeof f&&isNaN(f)||b.push({property:e,value:f});"fontWeight"===c?b.push({property:"IsBold",value:"bold"===f?"True":"False"}):"fontStyle"===c?b.push({property:"IsItalic",value:"italic"===f?"True":"False"}):"textDecoration"===c&&b.push({property:"IsUnderlined",value:"underline"===f?"True":"False"})}return b};f.processImageJsonForTrigger=function(a,b,c){var d=f.getMatchedCase(b,c);d||c.cases.some(function(a){if("default"===a.compareInfos[0].value)return d=a,!0});d&&(a.fileName=d.setters[0].value)};
f.getStatistics=function(a){var b=Infinity,c=-Infinity,d,e,f;a&&a.cases.forEach(function(a){a.compareInfos&&a.compareInfos.forEach(function(a){var g=Number(a.value);isNaN(g)||(g<b&&(b=g,e="\x3c"===a.operator||"\x3c\x3d"===a.operator),g>c&&(c=g,f="\x3e"===a.operator||"\x3e\x3d"===a.operator),d=!0)})});return d&&-1E12<b&&1E12>b&&-1E12<c&&1E12>c?{min:b,max:c,canFallBelowMin:e,canFallAboveMax:f}:null};var b=/\.png$/i;f.collectImageFileNames=function(a){var c=[];a&&a.cases&&a.cases.forEach(function(a){a.setters&&
a.setters.forEach(function(a){"Source"===a.property&&b.test(a.value)&&c.push(a.value)})});return c};return f})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/MetadataFromDataBuilder":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter"],function(h){return{recoverMetadataFromAreaData:function(f,e){f=f[0];var d={name:"DataCollection",tags:[{name:"Calculators",tags:[]}]},c;for(c in f){var b=f[c].data,a=f[c].comparisonLevels,g=e.map[c],k=e.locator[c],
k={name:g?"Maps":k?"Locator":"DataCollections",attributes:{Name:c},tags:[]};d.tags[0].tags.push(k);var l=[],p;for(p in b)l.push({name:g?"Map":"Field",attributes:{Name:p,Alias:p,MapTo:"DC."+p,Type:"number"===typeof b[p]?"Double":"String"}});k.tags.push({name:"Fields",tags:l});if(a&&a.length){var n=[],m={};a.forEach(function(a){a.StdGeographyLevel&&!m[a.StdGeographyLevel]&&(m[a.StdGeographyLevel]=1,n.push(a.StdGeographyLevel))});n.length&&k.tags.push({name:"ComparisonLevels",tags:n.map(function(a){return{name:"ComparisonLevel",
attributes:{Name:a}}})})}}return h.parseJson(d)}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/TemplateJsonLoader":function(){define("dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when ./CustomReportsManager ./GenericTemplateGenerator ./dataCollections/DataCollectionsLoader ../../core/conversion/PortalToEditorConverter ../../core/conversion/portalToEditorUtils/variables/PlayerVariableProvider ../../core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoNameUtil ../../core/conversion/portalToEditorUtils/parsers/_FieldInfoBuilder".split(" "),
function(h,f,e,d,c,b,a,g,k,l){var p={_templatesCache:{},getCachedTemplateJsonPromise:function(a,b){return(a=this._templatesCache[a+";"+b.reportID])&&a.modified===b.modified?a.promise.then(function(a){return{templateJson:h.clone(a.templateJson),templateVariableProvider:a.templateVariableProvider}}):null},putCachedTemplateJsonPromise:function(a,b,c){this._templatesCache[b+";"+c.reportID]={modified:c.modified,promise:a}}};return{getTemplateJsonByID:function(b,c){var k=this,m=new f;e(d.getCustomReportByID(b),
function(d){if(d){var f=c&&p.getCachedTemplateJsonPromise(b.countryID,d);f?f.then(m.resolve,m.reject):(f=k._loadCustomReportData(d).then(function(){var b=new g;return e(a.provideEditorJson(d,{variableProvider:b}),function(){var a=d.templateJson;d.portalJson=null;d.templateJson=null;return{templateJson:a,templateVariableProvider:b}})}),c?(p.putCachedTemplateJsonPromise(f,b.countryID,d),p.getCachedTemplateJsonPromise(b.countryID,d).then(m.resolve,m.reject)):f.then(m.resolve,m.reject))}else m.reject("Can't find a report")},
m.reject);return m.promise},_loadCustomReportData:function(a){a.portalJson=null;return a.templateData.getFiles().then(function(b){a.portalJson={files:b}})},createTemplateJsonFromVariables:function(a){return b.loadVariables({countryID:a.countryID,outFields:["description","precision","type","vintage"],forceLowerCase:!0}).then(function(b){var d=new g,e=b.fullNameToVariableCache;b=a.variables.fullNames.map(function(b){var c=k.createFieldNameFromSource(b),g=a.variables.customDataMapping[b],g=g?g.variable:
e[b];b={id:g.id.toLowerCase(),fullName:b,alias:g.description,fieldName:c,precision:g.precision,calculatorName:k.DATA_COLLECTIONS_CALCULATOR_NAME,templateName:k.DATA_COLLECTIONS_CALCULATOR_NAME+"."+c,type:g.type,vintage:g.vintage};d.addVariable(b);return l.getCalculatorOrScriptFieldInfo(b.templateName,{variableProvider:d})});return{templateJson:c.generateTemplatesFromFieldInfos(b,{comparisonLevels:a.comparisonLevels}),templateVariableProvider:d}})}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/GenericTemplateGenerator":function(){define("../../core/supportClasses/templateJsonUtils/BlankTemplateJsonUtil ../../core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoBuilder ../../core/supportClasses/tableJson/TableJsonUtil ../../core/sections/sectionUtils/SectionJsonUtil ../../core/infographics/InfographicTypes ../../core/infographics/utils/InfographicJsonUtil".split(" "),
function(h,f,e,d,c,b){var a={},g={calcNumRowsColumns:function(a){var b;b=2>=a?1:6>=a?2:12>=a?3:Math.ceil(a/4);var c;c=1===a?1:4>=a?2:9>=a?3:4;return{numRows:b,numColumns:c,numVarsInLastRow:c-(b*c-a),lastRowCellIndexes:null,lastRowCellWidths:null}}},k={mergeLastRow:function(a,b,c){2===b.numColumns?1===b.numVarsInLastRow&&(e.modifyTableJson(a,b.numRows-1,0,{columnSpan:2}),b.lastRowCellWidths=[2*c]):3===b.numColumns?1===b.numVarsInLastRow?(e.modifyTableJson(a,b.numRows-1,0,{columnSpan:3}),b.lastRowCellWidths=
[3*c]):2===b.numVarsInLastRow&&(e.modifyTableJson(a,b.numRows-1,0,{cellStyle:{width:1.5*c}}),e.modifyTableJson(a,b.numRows-1,1,{columnSpan:2,cellStyle:{width:.5*c}}),b.lastRowCellWidths=[1.5*c,1.5*c]):4===b.numColumns&&(1===b.numVarsInLastRow?(e.modifyTableJson(a,b.numRows-1,0,{columnSpan:4}),b.lastRowCellWidths=[4*c]):2===b.numVarsInLastRow?(e.modifyTableJson(a,b.numRows-1,0,{columnSpan:2}),e.modifyTableJson(a,b.numRows-1,2,{columnSpan:2}),b.lastRowCellIndexes=[0,2],b.lastRowCellWidths=[2*c,2*c]):
3===b.numVarsInLastRow&&(e.modifyTableJson(a,b.numRows-1,0,{cellStyle:{width:4*c/3}}),e.modifyTableJson(a,b.numRows-1,1,{columnSpan:2,cellStyle:{width:2*c/3}}),e.modifyTableJson(a,b.numRows-1,2,{cellStyle:{width:2*c/3}}),e.modifyTableJson(a,b.numRows-1,3,{cellStyle:{width:4*c/3}}),b.lastRowCellIndexes=[0,1,3],b.lastRowCellWidths=[4*c/3,4*c/3,4*c/3]))}},l={insertNextPanel:function(a,b,c){void 0===b.currentRowIndex&&(b.currentRowIndex=0,b.currentColumnIndex=0);var d=b.currentRowIndex===b.numRows-1;
a.data.data[b.currentRowIndex].fieldInfos["field"+(d&&b.lastRowCellIndexes?b.lastRowCellIndexes[b.currentColumnIndex]:b.currentColumnIndex)]=c(d&&b.lastRowCellWidths&&b.lastRowCellWidths[b.currentColumnIndex]);b.currentColumnIndex++;b.currentColumnIndex>b.numColumns-1&&(b.currentColumnIndex=0,b.currentRowIndex++)}};a.generateTemplatesFromFieldInfos=function(b){var c=g.calcNumRowsColumns(b.length),m=h.createBlankTemplate({elementWidth:500,elementHeight:250,layout:{numRows:c.numRows,numColumns:c.numColumns}}),
q=m.sectionsTables[0];k.mergeLastRow(q,c,500);b.forEach(function(b){l.insertNextPanel(q,c,function(c){var g=a._createInfographicJson(b,c||500,250);c=e.createSingleCellTable({width:c||500,height:250,fieldInfo:f.createFieldInfoFromInfographic(g)});return f.createFieldInfoFromSection(d.wrapInDetailsSectionJson(c))})});return m};a._createInfographicJson=function(a,d,e){return{type:c.ONE_VAR,title:a.alias,style:{width:d,height:e},levels:b.getDefaultLevels(),fieldInfos:[a],calcData:{calculatorName:a.templateName.substr(0,
a.templateName.indexOf(".")),variables:[a.fullName]}}};return a})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/BlankTemplateJsonUtil":function(){define(["esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/DocumentOptions","./TemplateJsonModificationUtil"],function(h,f){return{createBlankTemplate:function(e){var d={},c=e.documentOptions||h.getDefaultDocumentOptionsGraphicReport();c.pagesize=h.combineCustomSizeString(c.left+c.right+e.layout.numColumns*e.elementWidth,
c.top+c.bottom+e.layout.numRows*e.elementHeight,"px");d.documentOptions=c;for(var c={style:{width:e.layout.numColumns*e.elementWidth},data:{columns:[],data:[]}},b=0;b<e.layout.numColumns;b++)c.data.columns.push({field:"field"+b,style:{width:e.elementWidth}});for(b=0;b<e.layout.numRows;b++)c.data.data.push({style:{height:e.elementHeight},fieldInfos:{}});d.sectionsTables=[c];f.adjustDocumentOptions(d);return d}}})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/TemplateJsonModificationUtil":function(){define(["esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/DocumentOptions",
"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/GridLayoutCalculator"],function(h,f){var e={},d={getJsonStat:function(b){var a=0,d=0,e=[];b.sectionsTables.forEach(function(b){var g=0;b.data.columns.forEach(function(a){g+=c.getFieldWidth(b,b.data.data[0],a)});a=Math.max(a,g);var f=0;b.data.data.forEach(function(a){f+=c.getDataHeight(b,a,b.data.columns[0])});d=Math.max(d,f);e.push({totalW:g,totalH:f})});return{tableInfos:e,totalWMax:a,totalHMax:d}}},c={getFieldWidth:function(b,a,c){return f.getFieldWidth({looseResize:!0},
a,c)||c.style.width},getDataHeight:function(b,a,c){return f.getDataHeight({looseResize:!0},a,c.field)},getAverageFieldWidth:function(b,a){var d=0;b.data.data.forEach(function(e){d+=c.getFieldWidth(b,e,a)});return d/b.data.data.length},getAverageDataHeight:function(b,a){var d=0;b.data.columns.forEach(function(e){d+=c.getDataHeight(b,a,e)});return d/b.data.columns.length}};e.adjustDocumentOptions=function(b){if(b.documentOptions){var a=d.getJsonStat(b);a.totalWMax&&a.totalHMax&&!isNaN(a.totalWMax)&&
!isNaN(a.totalHMax)&&(b=b.documentOptions,b.pagesize=h.combineCustomSizeString(b.left+b.right+a.totalWMax,b.top+b.bottom+a.totalHMax,"px"),(a=h.getClosestStandrdSizes(b)[0])&&.001>a.score&&a.orientation===b.orientation&&(b.pagesize=a.pagesize))}};e.JsonStatCollector=d;e.DataUtil=c;return e})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/GridLayoutCalculator":function(){define("dojo/_base/lang ./gridLayoutCalcUtils/GridLayoutCalculatorQueryUtil ./gridLayoutCalcUtils/GridElementBoxCalculator ./gridLayoutCalcUtils/GridCellNodePlacer ./gridLayoutCalcUtils/rows/GridLayoutRowsCalculator ./gridLayoutCalcUtils/columns/GridLayoutColumnsCalculator ./gridLayoutCalcUtils/GridLayoutSnapper ../../supportClasses/tableJson/TableJsonUtil".split(" "),
function(h,f,e,d,c,b,a,g){var k={};e.calculator=k;k.markAsDirty=f.markAsDirty;k.fieldToColumn=f.fieldToColumn;k.dataIdToData=f.dataIdToData;k.getSpannedColumns=f.getSpannedColumns;k.recalcRows=c.recalcRows;k.recalcColumns=b.recalcColumns;k.recalcColumnsTableJson=b.recalcColumnsTableJson;k.recalcRowsToFitHeight=c.recalcRowsToFitHeight;k.adjustColumnWidth=b.adjustColumnWidth;k.getAffectedCellsForColumnAdjust=b.getAffectedCells;k.adjustRowHeight=c.adjustRowHeight;k.getAffectedCellsForRowAdjust=c.getAffectedCells;
k.recalcGridWidth=b.recalcGridWidth;k.calcFieldWidth=b.calcFieldWidth;k.getFieldWidth=b.getFieldWidth;k.setFieldWidth=b.setFieldWidth;k.calcDataHeight=c.calcDataHeight;k.getDataHeight=c.getDataHeight;k.setDataHeight=c.setDataHeight;k.autoSnapLayout=a.autoSnapLayout;k.positionCells=d.positionCells;k.calcFeatureCount=function(a,b,c){return(a-b)/c};k.calcRingIndexForCell=function(a){var b=a.parentGrid;if(!b)return-1;if(b.getNumDynamicRows())return void 0!==a.gridData.currentFeatureIndex?a.gridData.currentFeatureIndex:
a.gridData.index-b.getNumFixedRows();var c=b.getNumFixedColumns();return a.column.index<c?-1:Math.floor((a.column.index-c)/b.getNumDynamicColumns())};k.trimColumnsForNumberOfFeatures=function(a){for(var b=a.viewModel.dynamicReportInfo.fieldData.areaData.length,c=k.recalcGridWidth(a),d=0,e=0;e<a.getNumFixedColumns();e++)d+=a.columns[e].style.width;c-=d;d=k.calcFeatureCount(a.columns.length,a.getNumFixedColumns(),a.getNumDynamicColumns())-b;if(!(0>d)){for(var g=a.columns.slice(),e=g.length=a.getNumFixedColumns(),
f=[],h=0;a.columns[e];){for(var l=0;l<b;l++){var v=a.columns[e++],h=h+v.style.width;f.push(v)}e+=d}var y=c/h;f.forEach(function(a){a.style.width*=y});a.columns=g.concat(f)}};k.adjustRowsForNumberOfFeatures=function(a){var b=a.viewModel.dynamicReportInfo.fieldData.areaData.length;if(!(1>=b)){var c=a.store.data[a.getNumFixedRows()];c.currentFeatureIndex=0;for(var d=1;d<b;d++){var e=h.clone(c);e.currentFeatureIndex=d;a.store.data.push(e)}g.applyDefaultStyling({data:{data:a.store.data,columns:a.columns}})}};
return k})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/GridLayoutCalculatorQueryUtil":function(){define([],function(){var h={markAsDirty:function(f){f._fieldToColumnHash=null;f._dataIdToDataHash=null},_calcGridHashes:function(f){f._fieldToColumnHash={};f.columns.forEach(function(e){f._fieldToColumnHash[e.field]=e});f._dataIdToDataHash={};f.store.data.forEach(function(e){f._dataIdToDataHash[e.id]=e})},fieldToColumn:function(f,e){f._fieldToColumnHash||h._calcGridHashes(f);
return f._fieldToColumnHash&&f._fieldToColumnHash[e]},dataIdToData:function(f,e){f._dataIdToDataHash||h._calcGridHashes(f);return f._dataIdToDataHash&&f._dataIdToDataHash[e]},getSpannedColumns:function(f,e,d){var c=[];if(1>d)return[];var b;f.columns.some(function(a){if(b||a.field===e)c.push(a),b=!0;if(c.length===d)return!0});return c},getColumnSpannedFields:function(f,e,d){var c=null,b=e.fieldToRowSpanSourceDataIndex&&e.fieldToRowSpanSourceDataIndex[d];e=void 0!==b?f.store.data[b]:e;e=e.columnSpans&&
e.columnSpans[d];if(1<e)for(c=[],d=h.fieldToColumn(f,d),b=d=f.columns.indexOf(d);b<d+e;b++)c.push(f.columns[b].field);return c},getRowSpannedData:function(f,e,d){var c=null;d=e.fieldToColumnSpanSourceField&&e.fieldToColumnSpanSourceField[d]||d;d=e.rowSpans&&e.rowSpans[d];if(1<d)for(var c=[],b=e=f.store.data.indexOf(e);b<e+d;b++)c.push(f.store.data[b]);return c},getMovableData:function(f,e,d){return(e=e.movableIndexHashVertical&&e.movableIndexHashVertical[d])&&f.store.data[e]},getMovableColumn:function(f,
e,d){return(e=e.movableFieldsHashHorizontal&&e.movableFieldsHashHorizontal[d])&&h.fieldToColumn(f,e)}};return h})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/GridElementBoxCalculator":function(){define([],function(){function h(e,d,c,b,a){function g(a){return b&&void 0!==b.places?Number(a.toFixed(b.places)):a}if(!d||!c)return null;var k=f.calculator[a?"getFieldWidth":"calcFieldWidth"](e,d,c);a=f.calculator[a?"getDataHeight":"calcDataHeight"](e,d,c);for(var h=0,p=
0,n=f.calculator.fieldToColumn(e,c),m=0;m<n.index;m++)h+=f.calculator.getFieldWidth(e,d,e.columns[m].field);for(m=0;m<d.index;m++)p+=f.calculator.getDataHeight(e,e.store.data[m],c);return{x:g(h),y:g(p),w:g(k),h:g(a)}}var f={calculator:null,calcCellBox:function(e,d){return h(e.parentGrid,e.gridData,e.column.field,d,!1)},calcDataBox:function(e,d,c,b){return h(e,d,c,b,!0)}};return f})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/GridCellNodePlacer":function(){define(["./rows/GridLayoutRowsCalculator",
"./columns/GridLayoutColumnsCalculator"],function(h,f){return{positionCells:function(e){var d={},c={},b={},a={};if(e.store.data.length){e.store.data.forEach(function(g,k){e.columns.forEach(function(m,l){var q=b[l]||0,p=a[k]||0,n=h.getDataHeight(e,g,m.field);m=f.getFieldWidth(e,g,m.field);q+=n;p+=m;c[l+"_"+k]=q;d[l+"_"+k]=p;b[l]=q;a[k]=p})});e.getFieldCells().forEach(function(a){a.domNode.style.left=(d[a.column.index-1+"_"+a.gridData.index]||0)+"px";a.domNode.style.top=(c[a.column.index+"_"+(a.gridData.index-
1)]||0)+"px"});var g=0,k;for(k in b)g=Math.max(g,b[k]);var l=0;for(k in a)l=Math.max(l,a[k]);e.mainNode.style.width=l+"px";e.mainNode.style.height=g+"px";e.domNode.style.width=l+"px";e.domNode.style.height=g+"px";e._width=l;e._height=g}}}})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/rows/GridLayoutRowsCalculator":function(){define(["./RowsProcessor","./RowsScaler","./RowDataUtil","./RowModifier"],function(h,f,e,d){var c={};c.recalcRows=h.recalcRows;c.recalcRowsToFitHeight=
f.recalcRowsToFitHeight;c.adjustRowHeight=d.adjustRowHeight;c.getAffectedCells=d.getAffectedCells;c.getDataHeight=e.getDataHeight;c.setDataHeight=e.setDataHeight;c.calcDataHeight=e.calcDataHeight;return c})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/rows/RowsProcessor":function(){define(["dojox/uuid/generateRandomUuid","./RowDataUtil","../GridLayoutCalculatorQueryUtil"],function(h,f,e){function d(b,a){var c=[],d,f=0;a&&Object.keys(a).forEach(function(c){e.fieldToColumn(b,
c)?f++:delete a[c]});f&&b.columns.some(function(b){if(d||a[b.field])c.push(b),d=!0;a[b.field]&&f--;if(!f)return!0});return c}function c(b,a){var c=[],d,f=0;a&&Object.keys(a).forEach(function(c){e.dataIdToData(b,c)?f++:delete a[c]});f&&b.store.data.some(function(b){if(d||a[b.id])c.push(b),d=!0;a[b.id]&&f--;if(!f)return!0});return c}return{recalcRows:function(b){var a={};b.columns.forEach(function(b,c){a[b.field]=c});var g;b.store.data.forEach(function(c,f){c.index=f;c.style=c.style||{};c.style.fields=
c.style.fields||{};void 0===c.id&&(c.id=h());void 0===c.style.height&&(c.style.height=b.layoutDefaults.defaultRowHeight);delete c.excludedIndexHorizontal;delete c.movableFieldsHashHorizontal;delete c.fieldToColumnSpanSourceField;if(c.columnSpans){c.excludedIndexHorizontal={};c.movableFieldsHashHorizontal={};c.fieldToColumnSpanSourceField={};c._columnSpans=c._columnSpans||{};for(g in c.columnSpans){f=c._columnSpans[g];var k={};f=f?d(b,f):e.getSpannedColumns(b,g,c.columnSpans[g]);1<f.length&&(f.forEach(function(b){k[b.field]=
!0;b.field!==g&&(c.excludedIndexHorizontal[a[b.field]]=!0,c.fieldToColumnSpanSourceField[b.field]=g)}),c.movableFieldsHashHorizontal[g]=f[f.length-1].field);c.columnSpans[g]=f.length;c._columnSpans[g]=k}var l=0;Object.keys(c.columnSpans).forEach(function(a){2>c.columnSpans[a]?(delete c.columnSpans[a],delete c._columnSpans[a]):l++});l||(delete c.columnSpans,delete c._columnSpans)}delete c.excludedIndexVertical;delete c.movableIndexHashVertical;delete c.fieldToRowSpanSourceDataIndex;c.fieldInfos=c.fieldInfos||
{}});b.store.data.forEach(function(d,e){if(d.rowSpans)for(g in d._rowSpans=d._rowSpans||{},d.rowSpans){var f=d._rowSpans[g],k={};k[d.id]=!0;var h=a[g],l=d.rowSpans[g];if(f)f=c(b,f);else for(var f=[],n=e;n<e+l;n++)f.push(b.store.data[n]);1<f.length&&(f.forEach(function(a){if(a.id!==d.id){a.excludedIndexVertical=a.excludedIndexVertical||{};a.excludedIndexVertical[h]=!0;a.fieldToRowSpanSourceDataIndex=a.fieldToRowSpanSourceDataIndex||{};a.fieldToRowSpanSourceDataIndex[g]=d.index;var c=d.columnSpans&&
d.columnSpans[g];if(c)for(var e=1;e<c;e++)a.excludedIndexVertical[h+e]=!0,a.fieldToRowSpanSourceDataIndex[b.columns[h+e].field]=d.index}k[a.id]=!0}),d.movableIndexHashVertical=d.movableIndexHashVertical||{},d.movableIndexHashVertical[g]=e+f.length-1);d.rowSpans[g]=f.length;d._rowSpans[g]=k}});b.store.data.forEach(function(a,c){if(a.rowSpans){for(g in a.rowSpans)a.rowSpans[g]=Math.min(a.rowSpans[g],b.store.data.length-c);var d=0;Object.keys(a.rowSpans).forEach(function(b){2>a.rowSpans[b]?(delete a.rowSpans[b],
a._rowSpans&&delete a._rowSpans[b]):d++});d||(delete a.rowSpans,delete a._rowSpans)}});b.store.data.forEach(function(b,c){b.fieldInfos&&Object.keys(b.fieldInfos).forEach(function(c){void 0===a[c]&&delete b.fieldInfos[c]});b.style&&b.style.fields&&Object.keys(b.style.fields).forEach(function(c){void 0===a[c]&&delete b.style.fields[c]})});if(b.looseResize){b.store.data.forEach(function(a){b.columns.some(function(c){f.getDataHeightOwn(b,a,c.field)||f.setDataHeight(b,a,c.field,a.style.height)})});var k=
b.store.data[b.store.data.length-1],l=f.recalcGridHeight(b);b.columns.some(function(a){var c=0;b.store.data.forEach(function(d){c+=f.getDataHeightOwn(b,d,a.field)});var d=l-c;0!==d&&f.setDataHeight(b,k,a.field,f.getDataHeightOwn(b,k,a.field)+d)})}f.recalcGridHeight(b)}}})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/rows/RowDataUtil":function(){define(["../GridLayoutCalculatorQueryUtil"],function(h){var f={getDataHeight:function(e,d,c){return e.looseResize?f.getDataHeightOwn(e,
d,c)||d.style.height||0:d.style.height||0},getDataHeightOwn:function(e,d,c){if(e.looseResize)return d.style.fields=d.style.fields||{},(d.style.fields[c]=d.style.fields[c]||{}).height},setDataHeight:function(e,d,c,b,a){e.looseResize?(a?h.getColumnSpannedFields(e,d,c)||[c]:[c]).forEach(function(a){d.style.fields=d.style.fields||{};(d.style.fields[a]=d.style.fields[a]||{}).height=b}):d.style.height=b},calcDataHeight:function(e,d,c,b){var a=0,g=d.rowSpans&&d.rowSpans[c];if(1<g)for(var k=d.index;k<d.index+
g;k++)k!==b&&(a+=f.getDataHeight(e,e.store.data[k],c));else a=f.getDataHeight(e,d,c);return a},recalcGridHeight:function(e){e._height=0;var d=e.columns[0].field;e.store.data.forEach(function(c){e._height+=f.getDataHeight(e,c,d)});return e._height}};return f})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/rows/RowsScaler":function(){define(["./RowDataUtil"],function(h){return{recalcRowsToFitHeight:function(f,e){function d(a){a.forEach(function(a){f.columns.some(function(c,
d){if(!f.looseResize&&d)return!0;h.setDataHeight(f,a,c.field,h.getDataHeight(f,a,c.field)*b)})})}var c=h.recalcGridHeight(f),b=e/c;1!==b&&(d(f.store.data),f._getSavedOriginalData()&&d(f._getSavedOriginalData()),h.recalcGridHeight(f))}}})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/rows/RowModifier":function(){define(["../GridLayoutCalculatorQueryUtil","./RowDataUtil","./_RowModifierLoose","./_RowModifierNormal"],function(h,f,e,d){var c={},b={checkHeightLimit:function(a,
b,c,d){if(a.getMaxHeight()){var e=0;a.store.data.forEach(function(d){d!==b&&(e+=f.getDataHeight(a,d,c))});d=Math.min(a.getMaxHeight()-e,d)}return d}},a={findDataToMove:function(a,b,c,d){var e=h.getMovableData(a,b,c);e&&(a=f.calcDataHeight(a,b,c,e.index),d-=a);return{data:e||b,height:d}}},g={finalResizeGridCells:function(a){a.getFieldCells().forEach(function(b){b.setHeight(f.calcDataHeight(a,b.gridData,b.column.field))})}};c.adjustRowHeight=function(c,f,h,n){n=b.checkHeightLimit(c,f,h,n);f=a.findDataToMove(c,
f,h,n);(c.looseResize?e:d).adjustRowHeight(c,f.data,h,f.height);g.finalResizeGridCells(c)};c.getAffectedCells=function(b,c,d){return b.looseResize?e.getAffectedCells(b,a.findDataToMove(b,c,d).data,d):null};return c})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/rows/_RowModifierLoose":function(){define("dojo/_base/lang dojox/uuid/generateRandomUuid ../GridLayoutCalculatorQueryUtil ../GridElementBoxCalculator ./RowDataUtil ../../GridQueryUtil".split(" "),function(h,
f,e,d,c,b){var a={collectRowBoxes:function(a,b){for(var c=[],d=0;d<a.columns.length;){var g=a.columns[d],f=this._createEmptyBox(),g=e.getColumnSpannedFields(a,b,g.field)||[g.field];f.elements=this._getFieldsElements(a,b,g);this._measureBox(f);var k=c[c.length-1];k&&(k.nextSibling=f,f.prevSibling=k);c.push(f);d+=g.length}return c},_createEmptyBox:function(){return{id:f(),box:null,elements:[],overlappingBoxes:[],overlappingBoxesCache:{},prevSibling:null,nextSibling:null}},_getFieldsElements:function(a,
b,c){var e=[];c.forEach(function(c){c={data:b,dataIndex:b.index,field:c,box:d.calcDataBox(a,b,c,{places:2})};e.push(c)});return e},_measureBox:function(a){var b=0;a.elements.forEach(function(a){b+=a.box.w});a.box={x:a.elements[0].box.x,y:a.elements[0].box.y,h:a.elements[0].box.h,w:b}},mergeBoxesForBottomRow:function(a){var b=this._createEmptyBox();a.forEach(function(a){a.elements.forEach(function(a){b.elements.push({data:null,field:a.field,box:h.clone(a.box)})})});this._measureBox(b);b.box.h=1E6;
return[b]},getBoxAtField:function(a,b){return a.filter(function(a){return a.elements[0].field===b})[0]}},g={buildInfluenceTree:function(b,c,d){function e(a,d){(d?c:b).forEach(function(b){var c;if(c=!b.overlappingBoxesCache[a.id]){c=a.box;var d=b.box;c=!(c.x+.5>=d.x+d.w||c.x+c.w<=d.x+.5)}c&&(a.overlappingBoxes.push(b),a.overlappingBoxesCache[b.id]=!0)});a.overlappingBoxes.forEach(function(a){e(a,!d)})}d=a.getBoxAtField(b,d);e(d,!0);return d}},k={applyForce:function(a,b,d){function e(b,d){var f=b.elements[0];
f.data&&c.setDataHeight(a,f.data,f.field,c.getDataHeight(a,f.data,f.field)+(d?-1:1)*g,!0);b.overlappingBoxes.forEach(function(a){e(a,!d)})}var g=this._checkDelta(a,b,d);e(b,!1)},_checkDelta:function(a,b,c){function d(a,b){0!==g&&(b?0>g||(g=Math.min(g,a.box.h-e),a.prevSibling&&(g=Math.min(g,a.prevSibling.box.y+a.prevSibling.box.h-e-a.box.y)),a.nextSibling&&(g=Math.min(g,a.nextSibling.box.y+a.nextSibling.box.h-e-a.box.y))):0<g||(g=Math.max(g,-(a.box.h-e)),a.prevSibling&&(g=Math.max(g,-(a.box.y+a.box.h-
(a.prevSibling.box.y+e)))),a.nextSibling&&(g=Math.max(g,-(a.box.y+a.box.h-(a.nextSibling.box.y+e))))),a.overlappingBoxes.forEach(function(a){d(a,!b)}))}var e=a.layoutDefaults.rowMinHeight;c=Math.max(c,e);var g=c-b.box.h;d(b,!1);return g}},l={_getInluencedStartBox:function(b,c,d){var e=b.store.data[c.index+1];c=a.collectRowBoxes(b,c);b=e?a.collectRowBoxes(b,e):a.mergeBoxesForBottomRow(c);return g.buildInfluenceTree(c,b,d)},getAffectedCells:function(a,c,d){function e(c){if(c.elements[0].data){var d=
b.querySingleCell(a,{rowIndex:c.elements[0].data.index,columnField:c.elements[0].field,considerSpans:!0});d&&g.push(d)}c.overlappingBoxes.forEach(e)}var g=[];c=this._getInluencedStartBox(a,c,d);e(c);return g},adjustRowCell:function(a,b,c,d){b=this._getInluencedStartBox(a,b,c);k.applyForce(a,b,d)}};return{adjustRowHeight:function(a,b,c,d){l.adjustRowCell(a,b,c,d)},getAffectedCells:function(a,b,c){return l.getAffectedCells(a,b,c)}}})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/GridQueryUtil":function(){define(["dojo/dom-geometry",
"./GridDataUtil","esri/dijit/geoenrichment/utils/ArrayUtil","esri/dijit/geoenrichment/utils/DomUtil","esri/dijit/geoenrichment/utils/MouseUtil"],function(h,f,e,d,c){var b={querySingleCell:function(a,c){c.fieldCell&&(c={rowId:c.fieldCell.rowId,columnId:c.fieldCell.columnId});var d;a.getFieldCells().some(function(a){if(a.parentGrid&&a.column&&a.gridData&&!(a.columnId!==c.columnId&&a.column.index!==c.columnIndex&&a.column.field!==c.columnField||a.rowId!==c.rowId&&a.gridData.index!==c.rowIndex))return d=
a,!0});if(d)return d;if(c.considerSpans){var e=b.queryColumn(a,c),g=b.queryData(a,c);if(!e||!g)return null;var f=e.index,h=g.index;a.store.data.some(function(c){return a.columns.some(function(e){var g=e.index,k=e.index+(c.columnSpans&&c.columnSpans[e.field]||0),m=c.index;e=c.index+(c.rowSpans&&c.rowSpans[e.field]||0);if(g<=f&&k>=f&&m<=h&&e>=h)return d=b.querySingleCell(a,{columnIndex:g,rowIndex:m}),!0})})}return d},queryColumn:function(a,b){var c;a.columns.some(function(a){if(a.id===b.columnId||a.index===
b.columnIndex||a.field===b.columnField)return c=a,!0});return c},queryData:function(a,b){var c;a.store.data.some(function(a){if(a.id===b.rowId||a.index===b.rowIndex)return c=a,!0});return c},queryCells:function(a,c){if(c.fieldCell){var d=[],e=c.rowSpan||1,g=c.columnSpan||1;if(c=b.querySingleCell(a,c))for(var f=c.gridData.index;f<c.gridData.index+e;f++)for(var h=c.column.index;h<c.column.index+g;h++){var q=b.querySingleCell(a,{rowIndex:f,columnIndex:h});q&&d.push(q)}return d}return this.queryCellsInArray(a.getFieldCells(),
c)},queryCellsInArray:function(a,b){var c=[];if(!Object.keys(b).length)return c;a.forEach(function(a,d){if(void 0===b.cellIndex||d===b.cellIndex)if(void 0===b.cellIndexes||-1!==b.cellIndexes.indexOf(d))if(void 0===b.columnId||a.columnId===b.columnId)if(void 0===b.columnIds||-1!==b.columnIds.indexOf(a.columnId))if(void 0===b.columnIndex||a.column.index===b.columnIndex)if(void 0===b.columnIndexes||-1!==b.columnIndexes.indexOf(a.column.index))if(void 0===b.columnField||a.column.field===b.columnField)if(void 0===
b.columnFields||-1!==b.columnFields.indexOf(a.column.field))if(void 0===b.rowId||a.rowId===b.rowId)if(void 0===b.rowIds||-1!==b.rowIds.indexOf(a.rowId))if(void 0===b.rowIndex||a.gridData.index===b.rowIndex)void 0!==b.rowIndexes&&-1===b.rowIndexes.indexOf(a.gridData.index)||c.push(a)});return c},getTitleCell:function(a){var c=b.querySingleCell(a,{rowIndex:0,columnIndex:0});if(c&&!f.getFieldInfo(c)&&(1===a.columns.length||f.getColumnSpan(c)===a.columns.length))return c},isDynamicFieldCell:function(a,
b){return a._dynamicBindings&&a._dynamicBindings[b.column.field]},getDynamicallyBoundColumns:function(a,b){return a._dynamicBindings&&a._dynamicBindings[b.field]},getDynamicallyBoundFieldCells:function(a,c){if(c.column){var d=a._dynamicBindings&&a._dynamicBindings[c.column.field];if(!d)return null;var e=[];d.forEach(function(d){(d=d&&b.querySingleCell(a,{columnId:d.id,rowId:c.rowId}))&&e.push(d)});return e}},getAllBoundCells:function(a,c,d){var f=[],g={};c&&c.forEach(function(c){if((!d||d(c))&&!g[c.uniqueId]){g[c.uniqueId]=
!0;var e=b.getDynamicallyBoundFieldCells(a,c);e?e.forEach(function(a){f.push(a);g[a.uniqueId]=!0}):f.push(c)}});return e.removeDuplicates(f,"uniqueId")},trimDynamicBindings:function(a,c){var d=[],e={};c&&c.forEach(function(c){var f=b.getDynamicallyBoundFieldCells(a,c);f&&f.length?(e[f[0].uniqueId]||d.push(f[0]),f.forEach(function(a){e[a.uniqueId]=!0})):d.push(c)});return d},collectFieldInfos:function(a,c){var d=[];c=c||{};var e=c.fieldCells||a.getFieldCells();c.trimDynamicBinding&&e&&(e=b.trimDynamicBindings(a,
e));e&&e.forEach(function(a){(a=f.getFieldInfo(a))&&d.push(a)});return d},cellHasFloatingTableParent:function(a){function b(a){return a.isSection&&a.isDataDrillingView?!1:a.isFloatingTable?!0:a.parentWidget?b(a.parentWidget):!1}return a&&a.parentGrid?b(a.parentGrid):!1},isMouseOver:function(a){return c.isMouseOverBox(b.getBBox(a))},getOverFieldCell:function(a,b){b=b||{};var c=b.cellFilter||function(){return!0},d;a.getForegroundFloatingCells({topFirst:!0}).some(function(a){if(c(a)&&a.isMouseOver())return d=
a,!0});d||a.getFieldCells().some(function(a){if(c(a)&&a.isMouseOver())return d=a,!0});d||a.getBackgroundFloatingCells({topFirst:!0}).some(function(a){if(c(a)&&a.isMouseOver())return d=a,!0});return d},getBBox:function(a,b){var c=a.isSingleCelledTable()&&a.getFirstCell().getAngle();return"number"===typeof c&&0!==c?a.getFirstCell().getBBox(b):b&&b.noTransformation?d.noTransformPosition(a.domNode):h.position(a.domNode)}};return b})},"esri/dijit/geoenrichment/utils/DomUtil":function(){define("dojo/_base/lang dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/query esri/dijit/geoenrichment/Deferred dojo/domReady!".split(" "),
function(h,f,e,d,c,b,a,g){function k(){p||(p=d.create("div",{"class":"esriGEOffscreen"},document.body));return p}var l={isHidden:function(a){return a&&e.contains(a,"esriGEHidden")},hasVisibleChildren:function(a){if(!a||!a.children.length)return!1;for(var b=0;b<a.children.length;b++)if(!l.isHidden(a.children[b]))return!0;return!1},hide:function(a){return l.addTag(a,"esriGEHidden")},show:function(a){return l.removeTag(a,"esriGEHidden")},display:function(a,b){return l[b?"show":"hide"](a)},addTag:function(a,
b){return l.applyCallback(a,function(a){a&&e.add(a,b)})},removeTag:function(a,b){return l.applyCallback(a,function(a){a&&e.remove(a,b)})},applyCallback:function(a,b,c){c&&(b=h.hitch(c,b));Array.isArray(a)?a.forEach(b):b(a);return a},getChildIndex:function(a,b){if(!a||!a.children||!b)return-1;for(var c=0;c<a.children.length;c++)if(a.children[c]===b)return c;return-1},getChildren:function(a){if(!a||!a.children)return null;for(var b=[],c=0;c<a.children.length;c++)b.push(a.children[c]);return b},getChildNodes:function(a){if(!a||
!a.childNodes)return null;for(var b=[],c=0;c<a.childNodes.length;c++)b.push(a.childNodes[c]);return b},isChildOf:function(a,b,c){var d=!1,e=function(a){if(c&&!c(a))return!1;a.parentNode===b?d=!0:a.parentNode&&e(a.parentNode)};a&&e(a);return d},isNodeInLayout:function(a){return l.isChildOf(a,document.body,function(a){return!l.isHidden(a)&&"none"!=b.get(a,"display")&&!e.contains(a,"dijitHidden")})},isNodeVisible:function(a){return l.isChildOf(a,document.body,function(a){return!e.contains(a,"dijitHidden")&&
"hidden"!=b.get(a,"visibility")})},isNodeOnscreen:function(a){return l.isChildOf(a,document.body,function(a){return!e.contains(a,"esriGEOffscreen")})},enableContent:function(a,f,g){if(a){g=g||{};var k=a.children.length-1;if(!(0>k)){k=a.children[k];e.contains(k,"esriGEDisabledContent")||(k=null);if(f)k&&a.removeChild(k);else if(k=k||d.create("div",{"class":"esriGEDisabledContent"+(g.overlayClass?" "+g.overlayClass:"")},a),g.textContent&&(k.textContent=g.textContent),!1!==g.fitParent&&(a=c[g.marginBox?
"getMarginBox":"getContentBox"](a).h))a=a.toString()+"px",b.set(k,{height:a,marginTop:"-"+a});return k}}},enableContentAbsolute:function(a,c,d){if(a){d=d||{};var e=b.get(a,"position");"relative"!==e&&"absolute"!==e&&b.set(a,"position","relative");return l.enableContent(a,c,{overlayClass:"esriGEAbsoluteStretched "+(d.overlayClass||"")+(d.isTransparent?" esriGEDisabledContentTransparent ":""),fitParent:!1,textContent:d.textContent})}}},p;l.hideNodeInBackground=function(a,b){if(a){if(a._hideNodeInBackgroundUndoController)return a._hideNodeInBackgroundUndoController;
var c=d.create("div",null,a,"after"),e=d.create("div",{style:"position: absolute; left: 0px; top: 0px;"},k());d.place(a,e);b="DomUtil.hideNodeInBackground"+(b?"."+b:"");f.set(c,"_bg_memo_node",b);f.set(e,"_bg_temp_node",b);b={undo:function(){c&&(c.parentNode&&d.place(a,c,"replace"),d.destroy(c),d.destroy(e),p.children.length||(d.destroy(p),p=null),c=null,delete a._hideNodeInBackgroundUndoController)},remove:function(){this.undo()}};return a._hideNodeInBackgroundUndoController=b}};l.showNodeFromBackground=
function(a){a&&a._hideNodeInBackgroundUndoController&&a._hideNodeInBackgroundUndoController.undo()};l.noTransformPosition=function(a){function c(a){for(var c={x:0,y:0};a.offsetParent;)c.x+=a.offsetLeft,c.y+=a.offsetTop,a=a.offsetParent,c.x+=b.get(a,"borderLeftWidth"),c.y+=b.get(a,"borderTopWidth");return c}function d(a){return b.get(a,"width")+b.get(a,"paddingLeft")+b.get(a,"paddingRight")+b.get(a,"borderLeftWidth")+b.get(a,"borderRightWidth")}function e(a){return b.get(a,"height")+b.get(a,"paddingTop")+
b.get(a,"paddingBottom")+b.get(a,"borderTopWidth")+b.get(a,"borderBottomWidth")}if(a){var f;if(a instanceof SVGElement&&a.getBBox)return f=(f=a.ownerSVGElement&&a.ownerSVGElement.parentNode)&&c(f),a=a.getBBox(),{x:(a.x||0)+f.x,y:(a.y||0)+f.y,w:a.width||0,h:a.height||0};f=c(a);return{x:f.x,y:f.y,w:d(a),h:e(a)}}};l.uniteNodeBoxes=function(a,b){var c=1E6,d=1E6,e=-1E6,f=-1E6;a.forEach(function(a){a=l.noTransformPosition(a);c=Math.min(c,a.x);d=Math.min(d,a.y);e=Math.max(e,a.x+a.w);f=Math.max(f,a.y+a.h)});
a={x:c,y:d,w:e-c,h:f-d};b&&(b=l.noTransformPosition(b),a.x-=b.x,a.y-=b.y);return a};l.getNodesBox=function(a,b){if(!a||!a.length)return null;for(var d=1E6,e=-1E6,f=1E6,g=-1E6,k=0;k<a.length;k++)var h=a[k],h=b&&b.ignoreTranformation?l.noTransformPosition(h):c.position(h),d=Math.min(d,h.x),f=Math.min(f,h.y),e=Math.max(e,h.x+h.w),g=Math.max(g,h.y+h.h);return{x:d,y:f,w:e-d,h:g-f}};l.traverseChildren=function(a,b){function c(a){if(a&&a.children)for(var d=0;d<a.children.length;d++){var e=a.children[d];
if(b(e))break;c(e)}}c(a)};l.scrollToListNode=function(a,b,c){var d=b.offsetTop+b.clientHeight,e=d-(a.scrollTop+a.clientHeight);0<e&&(a.scrollTop+=e);c&&(d-=b.clientHeight-c.offsetTop,e=a.scrollTop-d,0<e&&(a.scrollTop-=e))};var n;l.getScrollbarSize=function(){if(!n){var a=d.create("div",null,document.body);a.style.width="100px";a.style.height="100px";a.style.overflow="scroll";a.style.position="absolute";a.style.top="9999px";n={w:a.offsetWidth-a.clientWidth,h:a.offsetHeight-a.clientHeight};d.destroy(a)}return n};
l.hasScrollbars=function(a){var c=b.getComputedStyle(a);return{w:"scroll"===c.overflowX||a.offsetWidth>a.clientWidth&&"auto"===c.overflowX,h:"scroll"===c.overflowY||a.offsetHeight>a.clientHeight&&"auto"===c.overflowY}};l.getMeasureContext=function(a){a=a||{};a.style=a.style?a.style+" ":"";a.style+="display: inline-block; position: absolute; left: 0; top: 0;";return{div:d.create("div",a,document.body),measureText:function(a){this.div.innerHTML=a;a=c.getMarginBox(this.div);delete a.l;delete a.t;return a},
destroy:function(){d.destroy(this.div)}}};l.getTextBox=function(a,b){b=l.getMeasureContext(b);a=b.measureText(a);b.destroy();return a};l.getNodeFontFamily=function(a){return(a=b.get(a,"fontFamily")||b.getComputedStyle(a)["font-family"])?a.replace(/'|"/g,"").split(",")[0]:a};l.getNodeFontSize=function(a){return b.toPixelValue(a,b.get(a,"fontSize"))};l.stealFocus=function(){var a=new g;try{var b=d.create("input",{type:"text",style:"position: absolute; left: 0px; top: 0px;"});d.place(b,document.body);
b.select();d.destroy(b)}catch(r){}setTimeout(a.resolve,0);return a.promise};l.getWindowBox=function(){for(var a=[],b=0,c=document.body.children.length;b<c;b++){var d=document.body.children[b];l.isHidden(d)||(l.hide(d),a.push(d))}b={w:document.body.clientWidth,h:document.body.clientHeight};a.forEach(function(a){l.show(a)});return b};l.getBorder=function(a){return{t:b.toPixelValue(a,b.get(a,"borderTopWidth")),r:b.toPixelValue(a,b.get(a,"borderRightWidth")),b:b.toPixelValue(a,b.get(a,"borderBottomWidth")),
l:b.toPixelValue(a,b.get(a,"borderLeftWidth"))}};l.isBodyLtr=function(){return"ltr"===(document.body.dir||"ltr").toLowerCase()};l.setAttribute=function(a,b,c){return 2===arguments.length?f.set(a,b):f.set(a,b,c)};l.getAttribute=function(a,b,c){return 2===arguments.length?f.get(a,b):f.get(a,b,c)};l.addClass=function(a,b){return e.add(a,b)};l.removeClass=function(a,b){return e.remove(a,b)};l.toggleClass=function(a,b,c){return e[c?"add":"remove"](a,b)};l.replaceClass=function(a,b,c){return e.replace(a,
b,c)};l.containsClass=function(a,b){return e.contains(a,b)};l.getStyle=function(a,c){return b.get(a,c)};l.setStyle=function(a,c,d){return 2===arguments.length?b.set(a,c):b.set(a,c,d)};l.toPixelValue=function(a,b){return parseFloat(b)||0};l.getComputedStyle=function(a){return a&&1===a.nodeType&&window.getComputedStyle(a)};l.position=function(a,b){return c.position(a,b)};l.getMarginBox=function(a,b){return c.getMarginBox(a,b)};l.setMarginBox=function(a,b){return c.setMarginBox(a,b)};l.getMarginExtents=
function(a,b){return c.getMarginExtents(a,b)};l.getContentBox=function(a,b){return c.getContentBox(a,b)};l.getPadBorderExtents=function(a,b){return c.getPadBorderExtents(a,b)};l.getPadExtents=function(a,b){return c.getPadExtents(a,b)};l.getBorderExtents=function(a,b){return c.getBorderExtents(a,b)};l.docScroll=function(){return c.docScroll()};l.create=function(a,b,c,e){return d.create(a,b,c,e)};l.toDom=function(a){return d.toDom(a)};l.place=function(a,b,c){return d.place(a,b,c)};l.empty=function(a){return d.empty(a)};
l.destroy=function(a){return d.destroy(a)};l.query=function(b,c){b=a(b,c);c=[];for(var d=0,e=b.length;d<e;d++)c.push(b[d]);return c};return l})},"esri/dijit/geoenrichment/utils/MouseUtil":function(){define("dojo/_base/lang dojo/on dojo/sniff dojo/touch dojo/dom-geometry ./DomUtil dojo/domReady!".split(" "),function(h,f,e,d,c,b){var a={_latestEvent:null,_setLatestEvent:function(b){a._latestEvent=b}};e("touch")?(f(document.body,d.press,function(b){a._setLatestEvent(a.fixTouchEvent(b,!0))}),f(document.body,
d.move,function(b){a._setLatestEvent(a.fixTouchEvent(b,!0))})):f(document.body,"mousemove",function(b){a._setLatestEvent(a.fixTouchEvent(b,!0))});var g;f(document.body,"mousedown",function(){g||(g=!0,f.once(document.body,"mouseup, click",function(){g=!1}))});a.getCursorPosition=function(){return a._latestEvent};a.isMouseOver=function(d,e){var f=e&&e.event||a._latestEvent;if(!(d&&d.parentNode&&d.getBoundingClientRect&&f))return!1;if(e&&e.checkAllChildren){e=h.mixin({},e);delete e.checkAllChildren;
var g=!1;b.traverseChildren(d,function(b){if(a.isMouseOver(b,e))return g=!0});return g}return a.isMouseOverBox(c.position(d),e)};a.isMouseOverBox=function(b,c){if(!b)return!1;var d=c&&c.event||a._latestEvent;c&&c.ignoreBorderTolerance&&(c=c.ignoreBorderTolerance,b=h.mixin({},b),b.x+=c,b.y+=c,b.w-=2*c,b.h-=2*c);return b.x<=d.clientX&&b.x+b.w>=d.clientX&&b.y<=d.clientY&&b.y+b.h>=d.clientY};a.fixTouchEvent=function(a,b){a=b?h.mixin({},a):a;a.touches&&1===a.touches.length?(b=a.touches[0],a.clientX=b.clientX,
a.clientY=b.clientY,a.pageX=b.pageX,a.pageY=b.pageY):a.changedTouches&&1===a.changedTouches.length&&(b=a.changedTouches[0],a.clientX=b.clientX,a.clientY=b.clientY,a.pageX=b.pageX,a.pageY=b.pageY);return a};a.isBeingDragged=function(){return g};a.addOverOutHandler=function(b){function c(){clearTimeout(e);d&&d.remove()}var d,e,g=f(b.node,"mouseover",function(g){function h(){a.isMouseOver(b.node)&&(b.onMouseOver(g),d=f(document.body,"mousemove",function(d){a.isMouseOver(b.node)||(c(),b.onMouseOut(d))}))}
c();b.delayTimeout?e=setTimeout(h,b.delayTimeout):h()});return{remove:function(){g.remove();c()}}};a.addOutHandler=function(b,c){return f(document.body,"mousemove",function(d){a.isMouseOver(b,{checkAllChildren:!0})||c(d)})};return a})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/rows/_RowModifierNormal":function(){define(["./RowDataUtil"],function(h){return{adjustRowHeight:function(f,e,d,c){var b=f.layoutDefaults.rowMinHeight;c=Math.max(c,b);var a=c-h.getDataHeight(f,
e,d);if(f.keepGridHeightWhenResized){var g=f.store.data[e.index+1];g&&(a=h.getDataHeight(f,g,d)-a,a<b&&(c-=b-a,a=b),h.setDataHeight(f,g,d,a,!0))}h.setDataHeight(f,e,d,c,!0)}}})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/columns/GridLayoutColumnsCalculator":function(){define(["./ColumnDataUtil","./ColumnModifier","./ColumnsProcessor"],function(h,f,e){var d={};d.recalcColumns=e.recalcColumns;d.recalcColumnsTableJson=e.recalcColumnsTableJson;d.adjustColumnWidth=f.adjustColumnWidth;
d.getAffectedCells=f.getAffectedCells;d.getFieldWidth=h.getFieldWidth;d.setFieldWidth=h.setFieldWidth;d.calcFieldWidth=h.calcFieldWidth;d.recalcGridWidth=h.recalcGridWidth;return d})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/columns/ColumnDataUtil":function(){define(["../GridLayoutCalculatorQueryUtil"],function(h){var f={getFieldWidth:function(e,d,c){var b="string"===typeof c?h.fieldToColumn(e,c):c;c=b?b.field:"string"===typeof c?c:null;return e.looseResize?f.getFieldWidthOwn(e,
d,c)||b&&b.style.width||0:b&&b.style.width||0},getFieldWidthOwn:function(e,d,c){if(e.looseResize)return d.style.fields=d.style.fields||{},(d.style.fields[c]=d.style.fields[c]||{}).width},setFieldWidth:function(e,d,c,b,a){var f="string"===typeof c?h.fieldToColumn(e,c):c,k=f?f.field:"string"===typeof c?c:null;e.looseResize?(a?h.getRowSpannedData(e,d,k)||[d]:[d]).forEach(function(a){a.style.fields=a.style.fields||{};(a.style.fields[k]=a.style.fields[k]||{}).width=b}):f&&(f.style.width=b)},calcFieldWidth:function(e,
d,c,b){var a=0;1<(d.columnSpans&&d.columnSpans[c])?h.getSpannedColumns(e,c,d.columnSpans[c]).forEach(function(c){b!==c.field&&(a+=f.getFieldWidth(e,d,c.field))}):a=f.getFieldWidth(e,d,c);return a},recalcGridWidth:function(e){e._width=0;var d=e.store.data[0];e.columns.forEach(function(c){e._width+=f.getFieldWidth(e,d,c.field)});return e._width},getAllowedWidth:function(e){return e.fitParentWhenResized?e.getAllowedWidthFromParent():e.getAllowedWidth()}};return f})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/columns/ColumnModifier":function(){define(["../GridLayoutCalculatorQueryUtil",
"./ColumnDataUtil","./_ColumnModifierNormal","./_ColumnModifierLoose"],function(h,f,e,d){var c={},b={getColumnToChange:function(a,b,c,d){var e=h.getMovableColumn(a,b,c.field);e&&(a=f.calcFieldWidth(a,b,c.field,e.field),d-=a);return{column:e||c,width:d}}},a={finalResizeGridCells:function(a){a.getFieldCells().forEach(function(b){b.setWidth(f.calcFieldWidth(a,b.gridData,b.column.field))});f.recalcGridWidth(a)}},g={recalcToStick:function(a){var b=a.columns[a.columns.length-1];a.store.data.some(function(c,
d){if(!a.looseResize&&d)return!0;var e=0;a.columns.forEach(function(d){d!==b&&(e+=f.getFieldWidth(a,c,d.field))});f.setFieldWidth(a,c,b.field,f.getAllowedWidth(a)-e)})}};c.adjustColumnWidth=function(c,f,h,n){h=b.getColumnToChange(c,f,h,n);(c.looseResize?d:e).adjustColumnWidth(c,f,h.column,h.width);c.stickToRight&&g.recalcToStick(c);a.finalResizeGridCells(c)};c.getAffectedCells=function(a,c,e){return a.looseResize?d.getAffectedCells(a,c,b.getColumnToChange(a,c,e).column):null};return c})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/columns/_ColumnModifierNormal":function(){define(["./ColumnDataUtil"],
function(h){var f={},e={adjustColumnWidth:function(d,c,b,a,f){function g(a,b){return h.setFieldWidth(d,c,a.field,b,!0)}var l=d.layoutDefaults.columnMinWidth,p=function(){if(!b)return null;var e=h.getFieldWidth(d,c,b.field);void 0!==f&&(a=e+f);a=Math.max(l,a);var g,k=0,m=!1;d.columns.forEach(function(a){k+=h.getFieldWidth(d,c,a.field);m&&!g?g=a:a===b&&(m=!0)});var q=h.getAllowedWidth(d)-(k-e);return isNaN(q)?null:{width:a,widthMemo:e,maxAllowedColumnWidth:q,nextColumn:g}}();if(p){a=p.width;var n=p.widthMemo,
m=p.maxAllowedColumnWidth,q=(p=p.nextColumn)&&h.getFieldWidth(d,c,p.field),n=a-n,r=0;d.keepGridWidthWhenResized?(p&&(n=q-n,n<l&&(a-=l-n,n=l),n<q&&(m+=q-n),g(p,n)),g(b,Math.min(m,a))):(p&&m<a&&q>l?(g(b,a),r=m-a):g(b,Math.min(m,a)),0!==r&&e.adjustColumnWidth(d,c,p,null,r))}}};f.adjustColumnWidth=function(d,c,b,a){e.adjustColumnWidth(d,c,b,a)};return f})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/columns/_ColumnModifierLoose":function(){define("dojo/_base/lang dojox/uuid/generateRandomUuid ../GridLayoutCalculatorQueryUtil ../GridElementBoxCalculator ./ColumnDataUtil ../../GridQueryUtil".split(" "),
function(h,f,e,d,c,b){var a={collectColumnBoxes:function(a,b){for(var c=[],d=0;d<a.store.data.length;){var f=a.store.data[d],g=this._createEmptyBox(),f=e.getRowSpannedData(a,f,b.field)||[f];g.elements=this._getSpannedDataElements(a,b,f);this._measureBox(g);var h=c[c.length-1];h&&(h.nextSibling=g,g.prevSibling=h);c.push(g);d+=f.length}return c},_createEmptyBox:function(){return{id:f(),box:null,elements:[],overlappingBoxes:[],overlappingBoxesCache:{},prevSibling:null,nextSibling:null}},_getSpannedDataElements:function(a,
b,c){var e=[];c.forEach(function(c){c={data:c,dataIndex:c.index,field:b.field,box:d.calcDataBox(a,c,b.field)};e.push(c)});return e},_measureBox:function(a){var b=0;a.elements.forEach(function(a){b+=a.box.h});a.box={x:a.elements[0].box.x,y:a.elements[0].box.y,w:a.elements[0].box.w,h:b}},mergeBoxesForRightColumn:function(a){var b=this._createEmptyBox();a.forEach(function(a){a.elements.forEach(function(a){b.elements.push({data:a.data,field:null,box:h.clone(a.box)})})});this._measureBox(b);b.box.w=1E6;
return[b]},getBoxAtDataIndex:function(a,b){return a.filter(function(a){return a.elements[0].dataIndex===b})[0]}},g={buildInfluenceTree:function(b,c,d){function e(a,d){(d?c:b).forEach(function(b){var c;if(c=!b.overlappingBoxesCache[a.id]){c=a.box;var d=b.box;c=!(c.y+.5>=d.y+d.h||c.y+c.h<=d.y+.5)}c&&(a.overlappingBoxes.push(b),a.overlappingBoxesCache[b.id]=!0)});a.overlappingBoxes.forEach(function(a){e(a,!d)})}d=a.getBoxAtDataIndex(b,d.index);e(d,!0);return d}},k={applyForce:function(a,b,d){function e(b,
d){var g=b.elements[0];g.field&&c.setFieldWidth(a,g.data,g.field,c.getFieldWidth(a,g.data,g.field)+(d?-1:1)*f,!0);b.overlappingBoxes.forEach(function(a){e(a,!d)})}var f=this._checkDelta(a,b,d);e(b,!1)},_checkDelta:function(a,b,d){function e(a,b){0!==g&&(b?0>g||(g=Math.min(g,a.box.w-f),a.prevSibling&&(g=Math.min(g,a.prevSibling.box.x+a.prevSibling.box.w-f-a.box.x)),a.nextSibling&&(g=Math.min(g,a.nextSibling.box.x+a.nextSibling.box.w-f-a.box.x))):0<g||(g=Math.max(g,-(a.box.w-f)),a.prevSibling&&(g=Math.max(g,
-(a.box.x+a.box.w-(a.prevSibling.box.x+f)))),a.nextSibling&&(g=Math.max(g,-(a.box.x+a.box.w-(a.nextSibling.box.x+f))))),a.overlappingBoxes.forEach(function(a){e(a,!b)}))}var f=a.layoutDefaults.columnMinWidth;d=Math.max(d,f);var g=d-b.box.w;if(0<g&&b.elements[0].field===a.columns[a.columns.length-1].field){var h=0;a.columns.forEach(function(d){h+=c.getFieldWidth(a,b.elements[0].data,d.field)});g=Math.min(g,c.getAllowedWidth(a)-h)}e(b,!1);return g}},l={_getInluencedStartBox:function(b,c,d){var e=b.columns[d.index+
1];d=a.collectColumnBoxes(b,d);b=e?a.collectColumnBoxes(b,e):a.mergeBoxesForRightColumn(d);return g.buildInfluenceTree(d,b,c)},getAffectedCells:function(a,c,d){function e(c){if(c.elements[0].data){var d=b.querySingleCell(a,{rowIndex:c.elements[0].data.index,columnField:c.elements[0].field,considerSpans:!0});d&&f.push(d)}c.overlappingBoxes.forEach(e)}var f=[];c=this._getInluencedStartBox(a,c,d);e(c);return f},adjustColumnCell:function(a,b,c,d){b=this._getInluencedStartBox(a,b,c);k.applyForce(a,b,d)}};
return{adjustColumnWidth:function(a,b,c,d){l.adjustColumnCell(a,b,c,d)},getAffectedCells:function(a,b,c){return l.getAffectedCells(a,b,c)}}})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/columns/ColumnsProcessor":function(){define(["dojox/uuid/generateRandomUuid","./ColumnDataUtil"],function(h,f){function e(c){c._dynamicBindings={};if(c.getNumDynamicColumns()){for(var b=c.getNumDynamicColumns(),a=c.getNumFixedColumns(),d=0;d<a;d++)c.columns[d].isFixed=!0;for(var d=
[],e=0;e<b;e++){for(var f=a,h=[];f<c.columns.length;){var n=c.columns[f+e];n.isDynamic=!0;h.push(n);f+=b}d.push(h)}d.forEach(function(a){a.forEach(function(b){c._dynamicBindings[b.field]=a})})}}var d={recalcColumns:function(c,b){var a=b&&b.resetWidth,d=b&&b.columnsToPreserve,k=b&&b.stickToRight,l=b&&b.newWidth,p=b&&b.rightOffsetWeight;b=b&&b._isJson;var n={},m=0;c.columns.every(function(a,b){if(!a.style||!a.style.width||isNaN(a.style.width)||"number"!==typeof a.style.width)return m=0,!1;m+=a.style.width;
n[b]=a.style.width;return!0});var q;q=l?l:k?c.getAllowedWidth():m?Math.min(m,c._width):c._width;q-=0<p?q*p:0;var r=q/c.columns.length,t=q;if(d){var w=d.length*r,u=0;d.forEach(function(a){u+=a.style.width});d.forEach(function(a){a.style.width=w/u*a.style.width/t*100+"%"})}c.columns.forEach(function(b,c,d){b.index=c;b.style=b.style||{};if("number"!==typeof b.style.width||a)if(c===d.length-1)b.style.width=t;else{var e=b.style.width;"string"===typeof e&&-1!==e.indexOf("%")?b.style.width=parseFloat(e.substr(0,
e.length-1))/100*q:b.style.width=r}t-=b.style.width;c===d.length-1&&0>t&&(b.style.width+=t);void 0===b.id&&(b.id=h())});if(c.looseResize){c.columns.some(function(a,b){var d=n[b]?a.style.width/n[b]:void 0;c.store.data.forEach(function(b){var e=f.getFieldWidthOwn(c,b,a.field);e?d&&1!==d&&f.setFieldWidth(c,b,a.field,e*d):f.setFieldWidth(c,b,a.field,a.style.width)})});var v=c.columns[c.columns.length-1].field;c.store.data.forEach(function(a){var b=0;c.columns.some(function(d){b+=f.getFieldWidthOwn(c,
a,d.field)});var d=q-b;0!==d&&f.setFieldWidth(c,a,v,f.getFieldWidthOwn(c,a,v)+d)})}b||(e(c),f.recalcGridWidth(c));return q},recalcColumnsTableJson:function(c){d.recalcColumns(c.data,{resetWidth:!0,newWidth:c.style.width,_isJson:!0})}};return d})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/GridLayoutSnapper":function(){define(["dojo/_base/lang","./rows/RowDataUtil","./columns/ColumnDataUtil","./GridElementBoxCalculator"],function(h,f,e,d){return{autoSnapLayout:function(c){function b(){var a=
[];c.store.data.forEach(function(b){c.columns.forEach(function(e){a.push(h.mixin({id:b.index+"_"+e.field,data:b,dataIndex:b.index,column:e,field:e.field},d.calcDataBox(c,b,e.field)))})});return a}if(c.looseResize)for(var a=c.store.data.length*c.columns.length,g={},k=0;k<a;k++){var l=b(),p=l[k],n=p.x+p.w,m=p.y+p.h;g[p.id]=!0;l.forEach(function(a){if(!g[a.id]){var b=n-(a.x+a.w);.5>=Math.abs(b)&&e.setFieldWidth(c,a.data,a.field,a.w+b);b=m-(a.y+a.h);.5>=Math.abs(b)&&f.setDataHeight(c,a.data,a.field,a.h+
b)}})}}}})},"esri/dijit/geoenrichment/ReportPlayer/core/sections/sectionUtils/SectionJsonUtil":function(){define(["esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoBuilder","esri/dijit/geoenrichment/ReportPlayer/core/sections/SectionTypes","../../supportClasses/tableJson/TableJsonUtil"],function(h,f,e){var d={wrapInDetailsSectionJson:function(c,b){c=Array.isArray(c)?c:[c];var a=c.some(function(a){return"table"===a.id&&a.attributes&&(0<a.attributes.dynamicColumns||
0<a.attributes.dynamicRows)});return{type:b||(a?f.GROUP:f.DETAILS),stack:c}},createSectionJsonFromInfographicJson:function(c,b,a){c=e.createSingleCellTable({width:b,height:a,fieldInfo:h.createFieldInfoFromInfographic(c)});return d.wrapInDetailsSectionJson(c)},getSectionJsonInfographic:function(c){var b;c.stack&&c.stack.some(function(a){b="table"===a.id&&e.getTableJsonInfographic(a);return!!b});return b},getSectionJsonInfographicTable:function(c){var b;c.stack&&c.stack.some(function(a){if("table"===
a.id&&e.getTableJsonInfographic(a))return b=a,!0});return b},calcSectionJsonBox:function(c){var b,a,d,e;function f(c){b=Math.min(b,c.l);a=Math.min(a,c.t);d=Math.max(d,c.l+c.w);e=Math.max(e,c.t+c.h)}a=b=Infinity;e=d=0;c.stack&&c.stack.forEach(function(a){switch(a.id){case "table":var b=0;a.data.data.forEach(function(a){b+=a.style.height});f({l:a.style.left||0,t:a.style.top||0,w:a.style.width,h:b});break;case "img":case "map":f({l:a.style.left||0,t:a.style.top||0,w:a.style.width,h:a.style.height})}});
c=c.style||{};return{x:c.left,y:c.top,w:c.width||b+d,h:c.height||a+e,contentLeft:b,contentTop:a,contentW:d-b,contentH:e-a}}};return d})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/parsers/_FieldInfoBuilder":function(){define(["../../../supportClasses/templateJsonUtils/fieldInfo/FieldInfoBuilder","dojo/i18n!esri/nls/jsapi"],function(h,f){f=f.geoenrichment.dijit.ReportPlayer.ReportPlayer;return{getCalculatorOrScriptFieldInfo:function(e,d,c){if(!e)return null;if(d.variableProvider.isPlayerOnly&&
!d.useVariableProviderToCollectOnly){var b=d.variableProvider.toCalculator(e);if(!b)return console.log("Can't create a dummy calculator for \x3d\x3e "+e),null;c=c||{};c.calculatorName=b.variable.calculatorName;e=h.createFieldInfoFromCalculator(b,d.variableProvider,c);e.name=b.variable.fieldName;e.templateName=b.variable.templateName;return e}var b=d.queryMetaDataFunc(e),a=e.substr(0,e.indexOf("."));c=c||{};c.calculatorName=a;if(b)return b.isScript?h.createFieldInfoFromScript(b,c):h.createFieldInfoFromCalculator(b,
d.variableProvider,c);c=h.createFieldInfoFromMissingVariable(e);d.variableProvider.isPlayerOnly&&(b=d.variableProvider.toCalculator(e),c.alias=b&&b.variable.alias);c.alias=c.alias?c.alias+" ("+f.missingVariable+")":f.missingVariable;return c}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/InfographicOptionsProvider":function(){define("dojo/_base/declare esri/kernel esri/dijit/geoenrichment/InfographicsOptions esri/dijit/geoenrichment/Geoenrichment esri/dijit/geoenrichment/config esri/tasks/geoenrichment/GeometryStudyArea esri/tasks/geoenrichment/StandardGeographyStudyArea esri/tasks/geoenrichment/studyAreaFromJson ./ge/LocalGEInfographic ./ge/_GEFilterSupport esri/dijit/geoenrichment/utils/StudyAreaKeyBuilder".split(" "),
function(h,f,e,d,c,b,a,g,k,l,p){var n=h(null,{_options:null,getTask:function(){return null},createGeoenrichment:function(a,b,c,e,f){return a&&a.calcData?new k(a,b,c,e,f):(new h([d,l]))()},getCountry:function(a){return null},getOptions:function(){this._options||(this._options=new e);return this._options}}),m=h(null,{countryID:null,reportID:null,geoenrichmentUrl:null,areaNames:null,studyAreas:null,studyArea:null,_provider:null,constructor:function(c,d){this.countryID=c.countryID;this.reportID=c.reportID;
this.geoenrichmentUrl=c.geoenrichmentUrl;this.studyAreas=c.studyAreas.map(function(c){return c instanceof b||c instanceof a?c:g(c)});this.areaNames=c.areaNames;this._provider=d;this.setCurrentAnalysisAreaIndex(0)},setCurrentAnalysisAreaIndex:function(a){this.studyArea=this.studyAreas[a]},_getGEKey:function(a){a=a||this.studyArea;return JSON.stringify(p.studyAreaToJson(a))+this.countryID+this.reportID},_getGEKeys:function(){return this.studyAreas.map(function(a){return this._getGEKey(a)},this)},getOptions:function(){return this._provider._getFactory().getOptions()},
createGeoenrichment:function(a){this.setCurrentAnalysisAreaIndex(a.currentFeatureIndex||0);return this._provider._createGE(this._getGEKey(),a.infographicJson,a.areaData,a.isMultiFeature,this.areaNames,a.currentFeatureIndex)},toJson:function(){return{countryID:this.countryID,reportID:this.reportID,geoenrichmentUrl:this.geoenrichmentUrl,geoenrichmentCache:this._provider._getGECacheJson(this._getGEKeys()),infographicsOptions:this.getOptions().toJson(),studyAreas:this.studyAreas.map(function(a){return a.toJson()}),
areaNames:this.areaNames}},toJsonAt:function(a){var b=this.studyAreas[a];return{countryID:this.countryID,reportID:this.reportID,geoenrichmentUrl:this.geoenrichmentUrl,geoenrichmentCache:this._provider._getGECacheJson([this._getGEKey(b)]),infographicsOptions:this.getOptions().toJson(),studyAreas:[b.toJson()],areaNames:[this.areaNames[a]]}}});return h(null,{_infographicsFactory:null,_geoenrichmentCache:null,constructor:function(){this._geoenrichmentCache={}},_getFactory:function(){return this._infographicsFactory=
this._infographicsFactory||new n},_createGE:function(a,b,c,d,e,f){b=this._getFactory().createGeoenrichment(b,c,d,e,f);(c=this._geoenrichmentCache[a])?b.cache=c:this._geoenrichmentCache[a]=b.cache;return b},_getGECacheJson:function(a){var b={};a.forEach(function(a){var c=this._geoenrichmentCache[a];c&&(b[a]=c.toJson())},this);return b},setServerUrl:function(a,b){c.server=a;b?c.token=b:(a=a&&f.id.findCredential(a)||f.id.credentials[0],c.token=a&&a.token)},getInfographicOptions:function(c){return new m({geoenrichmentUrl:c.geoenrichmentUrl,
countryID:c.countryID,reportID:c.reportID,studyAreas:c.analysisAreas.map(function(d){return d.geographies&&d.geographies.length?new a({countryID:c.countryID,layer:d.geographies[0].levelId,ids:[d.geographies.map(function(a){return a.id}).join(",")],attributes:{}}):new b({geometry:d.feature.geometry,attributes:{}})}),areaNames:c.analysisAreas.map(function(a){return a.shortName||a.name})},this)},getInfographicOptionsFromJson:function(a){this.setServerUrl(a.geoenrichmentUrl);for(var b in a.geoenrichmentCache){var c=
a.geoenrichmentCache[b];this._createGE(b);this._geoenrichmentCache[b].fromJson(c)}this._infographicsFactory&&(this._infographicsFactory._options=new e(a.infographicsOptions));return new m(a,this)}})})},"esri/dijit/geoenrichment/InfographicsOptions":function(){define("esri/declare dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/tasks/geoenrichment/studyAreaOptionsFromJson esri/tasks/geoenrichment/GeoenrichmentTask ./utils/ArrayUtil ./config ./InfographicsOptionsItem".split(" "),function(h,f,
e,d,c,b,a,g){function k(a,b){if(a)for(var c in a)if(a.hasOwnProperty(c)){b[c]=[];for(var d=0;d<a[c].length;d++){var e={};n(a[c][d],e);b[c].push(e)}}}function l(a,b){a=parseFloat(a.index);b=parseFloat(b.index);return isNaN(a)&&isNaN(b)?0:isNaN(a)?1:isNaN(b)?-1:a-b}function p(a,c){for(var d=0;d<a.length;d++){var e=a[d];if(e.type==c.type&&b.arraysEqual(e.variables,c.variables))return{report:e,index:d}}return null}function n(a,b){b.type=a.type||("OneVarMultiComparison"==a.report?"OneVar":a.report);if(a.dataCollection)if(a.vars){b.variables=
[];for(var c=0;c<a.vars.length;c++)b.variables.push(a.dataCollection+"."+a.vars[c])}else b.variables=[a.dataCollection+".*"];else b.variables=a.variables;m(a.isVisible)?b.isVisible=a.isVisible:m(a.checked)&&(b.isVisible=a.checked)}function m(a){return"boolean"==typeof a||a instanceof Boolean}h=h("esri.dijit.geoenrichment.InfographicsOptions",null,{_items:null,_loaded:null,_loadPromises:null,studyAreaOptions:null,theme:"common",constructor:function(a){this._loaded={};this._loadPromises={};this.studyAreaOptions=
d(a&&(a.buffer||a.studyAreaOptions));this._items={};if(a){var b=a.reports||a.items;if(b){k(b,this._items);for(var c in b)b[c]&&b[c].length&&(this._loaded[c]=!0)}a.theme&&(this.theme=a.theme)}},getItems:function(b){var d=new e;if(this._loaded[b])d.resolve(this._items[b]);else{if(this._loadPromises[b])return this._loadPromises[b];var g=new c(a.server);g.token=a.token;g.getDataCollections(b,null,["id","alias"]).then(f.hitch(this,this._mergeItems,b,d),function(a){d.reject(a)})}return this._loadPromises[b]=
d.promise},_mergeItems:function(a,b,c){try{var d={AgePyramid:1,TapestryNEW:1,RelatedVariables:1,OneVar:1},e={TapestryNEW:"Tapestry"},f,h,k=[];for(f=0;f<c.length;f++){var m=c[f].metadata.infographics||c[f].metadata.infographics2;if(m){var q=JSON.parse(m),r;for(r in q)if(d[r]){var t=new g(e[r]||r,[c[f].id+".*"]),F;for(F in q[r])q[r].hasOwnProperty(F)&&(t[F]=q[r][F]);(h=p(k,t))?k[h.index]=t:k.push(t)}}}var E,C=this._items[a];C||(C=[],C.push(new g("OneVar",["KeyGlobalFacts.AVGHHSZ"])),this._items[a]=
C);for(f=C.length-1;0<=f;f--)if(h=p(k,C[f]))n(C[f],h.report),C[f]=h.report,k.splice(h.index,1);else{if("OneVar"==C[f].type&&1==C[f].variables.length){var I,J=C[f].variables[0];if(!E)for(E={},d=0;d<c.length;d++)for(e=0;e<c[d].variables.length;e++)E[c[d].id+"."+c[d].variables[e].id]=c[d].variables[e];if(I=E[J]){C[f].title=I.alias;continue}}C.splice(f,1);f--}for(f=0;f<k.length;f++)C.push(k[f]);C.sort(l);this._loaded[a]=!0;delete this._loadPromises[a];b.resolve(C)}catch(K){b.reject(K)}},toJson:function(){var a=
{};k(this._items,a);return{studyAreaOptions:this.studyAreaOptions.toJson(),items:a,theme:this.theme}}});h.Item=g;return h})},"esri/declare":function(){define(["dojo/_base/declare","dojo/_base/lang","./extend"],function(h,f,e){return function(d,c,b){var a=f.isString(d);a?b.declaredClass=d:(b=c,c=d);c=h(c,b);a&&e(d,c);return c}})},"esri/extend":function(){define(["dojo/_base/lang","dojo/has","./kernel"],function(h,f,e){return function(d,c){f("extend-esri")&&(d=d.substring(d.indexOf(".")+1),h.setObject(d,
c,e))}})},"esri/tasks/geoenrichment/studyAreaOptionsFromJson":function(){define(["./RingBuffer","./DriveBuffer","./IntersectingGeographies","../../extend"],function(h,f,e,d){var c=function(b){if(b){switch(b.areaType){case "DriveTimeBuffer":return new f(b);case "StandardGeography":return new e(b)}switch(b.type){case "DriveTime":return new f(b);case "StdGeo":return new e(b)}return new h(b)}return new h};d("esri.tasks.geoenrichment.studyAreaOptionsFromJson",c);return c})},"esri/tasks/geoenrichment/RingBuffer":function(){define(["../../declare",
"../../units","./StudyAreaOptions"],function(h,f,e){return h("esri.tasks.geoenrichment.RingBuffer",[e],{radii:null,units:null,constructor:function(d){d&&(d.bufferRadii?this.radii=d.bufferRadii:d.radius?this.radii=[d.radius]:d.radii&&(this.radii=d.radii),this.units=d.bufferUnits||d.units);this.radii||(this.radii=[1]);this.units||(this.units=f.MILES)},toJson:function(){return{areaType:"RingBuffer",bufferUnits:this.units,bufferRadii:this.radii}}})})},"esri/tasks/geoenrichment/StudyAreaOptions":function(){define(["../../declare"],
function(h){return h("esri.tasks.geoenrichment.StudyAreaOptions",null,{toJson:function(){throw"'toJson' method is not implemented";}})})},"esri/tasks/geoenrichment/DriveBuffer":function(){define(["../../declare","./StudyAreaOptions","./DriveUnits"],function(h,f,e){return h("esri.tasks.geoenrichment.DriveBuffer",[f],{radii:null,units:null,constructor:function(d){d&&(d.bufferRadii?this.radii=d.bufferRadii:d.radius?this.radii=[d.radius]:d.radii&&(this.radii=d.radii),this.units=d.bufferUnits||d.units);
this.radii||(this.radii=[5]);this.units||(this.units=e.MINUTES)},toJson:function(){return{areaType:"DriveTimeBuffer",bufferUnits:this.units,bufferRadii:this.radii}}})})},"esri/tasks/geoenrichment/DriveUnits":function(){define(["dojo/_base/lang","../../units"],function(h,f){f=h.clone(f);h.mixin(f,{MINUTES:"esriDriveTimeUnitsMinutes"});return f})},"esri/tasks/geoenrichment/IntersectingGeographies":function(){define(["../../declare","./StudyAreaOptions","./GeographyLevel"],function(h,f,e){return h("esri.tasks.geoenrichment.IntersectingGeographies",
[f],{geographyLevels:null,constructor:function(d){this.geographyLevels=e.fromJsonArray(d?d.intersectingGeographies||d.levels||d.geographyLevels:[{layerID:"Admin2"}])},toJson:function(){return{areaType:"StandardGeography",intersectingGeographies:e.toJsonArray(this.geographyLevels)}}})})},"esri/tasks/geoenrichment/GeographyLevel":function(){define(["../../declare"],function(h){var f=h("esri.tasks.geoenrichment.GeographyLevel",null,{layerID:null,datasetID:null,countryID:null,constructor:function(e){e&&
(this.layerID=e.layer||e.layerID||null,this.datasetID=e.dataset||e.datasetID||null,this.countryID=e.sourceCountry||e.countryID||null)},toJson:function(){var e={};this.layerID&&(e.layer=this.layerID);this.datasetID&&(e.dataset=this.datasetID);this.countryID&&(e.sourceCountry=this.countryID);return e}});f.fromJsonArray=function(e){var d=[];if(!e)return d;for(var c=0;c<e.length;c++){var b=e[c];b instanceof f||(b=new f(b));d.push(b)}return d};f.toJsonArray=function(e){if(!e||0===e.length)return null;
for(var d=[],c=0;c<e.length;c++)d.push(e[c].toJson());return d};return f})},"esri/tasks/geoenrichment/GeoenrichmentTask":function(){define("../../declare dojo/_base/array dojo/_base/lang dojo/dom-construct ./taskHelper ../FeatureSet ./EnrichParameters ./ReportParameters ../../urlUtils ../../IdentityManager ../../geometry/Point ../../geometry/Polygon ../../geometry/Polyline dojo/i18n!../../nls/jsapi".split(" "),function(h,f,e,d,c,b,a,g,k,l,p,n,m,q){function r(a){this.name="UserError";this.message=
a||""}function t(a,b){return a.getAvailableCountries().then(function(a){for(var c=0;c<a.length;c++)if(a[c].id==b)return a[c].name})}function w(a){a=a.getExtent();return new p((a.xmin+a.xmax)/2,(a.ymin+a.ymax)/2,a.spatialReference)}q=q.geoenrichment.task.GeoenrichmentTask;r.prototype=Error.prototype;return h("esri.tasks.geoenrichment.GeoenrichmentTask",null,{token:null,url:null,_query:null,constructor:function(a){if(a){var b=k.urlToObject(a);a=b.path;this._query=b.query}this.url=a||k.getProtocolForWebResource()+
"//geoenrich.arcgis.com/arcgis/rest/services/World/GeoenrichmentServer"},enrich:function(d){var e=this;return c.invokeMethod(this,"/Geoenrichment/enrich",function(){d instanceof a||(d=new a(d));return c.jsonToRest(d.toJson(),e._query)},function(a){(!a.results||1>a.results.length||!a.results[0].value||!a.results[0].value.FeatureSet||1>a.results[0].value.FeatureSet.length)&&c.throwEmptyResponse();var d={featureSets:[],messages:a.messages};a=a.results[0].value.FeatureSet;for(var e=0;e<a.length;e++)d.featureSets.push(new b(a[e]));
return d},"onEnrichComplete","onError")},getAvailableCountries:function(){var a=this;return c.invokeMethod(this,"/Geoenrichment/Countries",function(){return e.mixin({},a._query)},function(a){if(a.error)throw a.error;a=a.countries;for(var b=0;b<a.length;b++){var c=a[b].datasets;delete a[b].datasets;a[b].datasetIDs=c}return a},"onGetAvailableCountriesComplete","onError")},getDataCollections:function(a,b,d,f){var g;b?g="/GetDataCollections/execute":(g="/Geoenrichment/DataCollections",a&&(g+="/"+a));
var h=this;return c.invokeMethod(this,g,function(){var c=e.mixin({},h._query);c.suppressNullValues=!0;d&&(c.outFields=0===d.length?"none":JSON.stringify(d));b&&(a&&(c.sourcecountry=a),c.searchtext="id:"+b);f&&(c.addDerivativeVariables=JSON.stringify(f));return c},function(a){if(a.error)throw a.error;a=a.results||a.dataCollections||a.DataCollections;for(var b=0;b<a.length;b++)a[b]={id:a[b].dataCollectionID,metadata:a[b].metadata,variables:a[b].data};return a},"onGetDataCollectionsComplete","onError")},
createReport:function(a){var b=this;l.getCredential(this.url).then(function(e){try{var f=d.create("form",{target:"_blank",action:b.url+"/Geoenrichment/CreateReport",method:"post"});a instanceof g||(a=new g(a));var h=c.jsonToRest(a.toJson(),b._query);h.f="bin";h.token=e.token;for(var k in h)h.hasOwnProperty(k)&&d.create("input",{type:"hidden",name:k,value:h[k]},f);d.place(f,document.body);f.submit();d.destroy(f)}catch(B){b.onError(B)}},function(a){b.onError(a)})},getReports:function(a){var b=this;
return t(this,a).then(function(a){return c.invokeMethod(b,"/Geoenrichment/Reports/"+a,function(){return e.mixin({},b._query)},function(a){for(var b=0;b<a.reports.length;b++){var c=a.reports[b].reportID;delete a.reports[b].reportID;a.reports[b].id=c}return a.reports},"onGetReportsComplete","onError")})},getStandardGeographyLevels:function(a){function b(a){return c.invokeMethod(d,a,function(){return e.mixin({},d._query)},function(a){a=a.geographyLevels;for(var b=0;b<a.length;b++){var c=a[b];c.id=c.countryID;
delete c.countryID;c.name=c.countryName;delete c.countryName;for(var c=c.datasets,d=0;d<c.length;d++){var e=c[d];e.id=e.datasetID;delete e.datasetID;e.geographyLayers=e.levels;delete e.levels}}return a},"onGetStandardGeographyLevelsComplete","onError")}var d=this;return a?t(this,a).then(function(a){return b("/Geoenrichment/StandardGeographyLevels/"+a)}):b("/Geoenrichment/StandardGeographyLevels")},getServiceLimits:function(){var a=this;return c.invokeMethod(this,"/Geoenrichment/ServiceLimits",function(){return e.mixin({},
a._query)},function(a){return a.serviceLimits.value},"onGetServiceLimitsComplete","onError")},getCountries:function(a){var b;switch(a.type){case "point":b=a;break;case "polyline":b=a.paths[0];a=new m(a.spatialReference);a.addPath(b);b=w(a);break;case "polygon":b=a.rings[0],a=new n(a.spatialReference),a.addRing(b),b=w(a)}return this.enrich({variables:["GlobalIntersect.*"],studyAreas:[{geometry:b}],forStorage:!1}).then(function(a){var b=[];a=a.featureSets[0].features;for(var c=0;c<a.length;c++){var d=
a[c].attributes.sourceCountry;0>f.indexOf(b,d)&&b.push(d)}if(0===b.length)throw new r(q.noData);return b})},onEnrichComplete:function(a){},onGetAvailableCountriesComplete:function(a){},onGetDataCollectionsComplete:function(a){},onCreateReportComplete:function(a){},onGetReportsComplete:function(a){},onGetStandardGeographyLevelsComplete:function(a){},onGetServiceLimitsComplete:function(a){},onError:function(a){}})})},"esri/tasks/geoenrichment/taskHelper":function(){define(["dojo/_base/lang","dojo/Deferred",
"dojo/json","../../request","../../extend"],function(h,f,e,d,c){var b={invokeMethod:function(a,b,c,e,h,n){function g(b){var c;try{c=e(b)}catch(y){k(y);return}p&&p.resolve(c);a[h](c)}function k(b){p&&p.reject(b);a[n](b)}var l=null,p=null,p=new f(function(){l&&(l.cancel(),l=null)});try{var w=c?c():{};w.f="json";a.token&&(w.token=a.token);l=d({url:a.url+b,content:w,handleAs:"json"});l.then(g,k)}catch(u){k(u)}return p.promise},jsonToRest:function(a,b){b=h.mixin({},b);for(var c in a)h.isString(a[c])?b[c]=
a[c]:b[c]=e.stringify(a[c]);return b},throwEmptyResponse:function(){throw Error("Geoenrichment service returned empty response");}};c("esri.tasks.geoenrichment.taskHelper",b);return b})},"esri/tasks/geoenrichment/EnrichParameters":function(){define(["../../declare","../../SpatialReference","./EnrichParametersBase","./StandardIntersectingGeography"],function(h,f,e,d){return h("esri.tasks.geoenrichment.EnrichParameters",[e],{variables:null,returnGeometry:!1,outSR:null,intersectingGeographies:null,forStorage:!0,
constructor:function(c){this.variables=[];if(c&&(this.variables=c.analysisVariables||c.variables||null,c.returnGeometry&&(this.returnGeometry=!0),c.outSR&&(this.outSR=new f(c.outSR)),c.forStorage&&(this.forStorage=c.forStorage),c.intersectingGeographies)){this.intersectingGeographies=[];for(var b=0;b<c.intersectingGeographies.length;b++){var a=c.intersectingGeographies[b];if("standard"==a.geographyType)this.intersectingGeographies.push(new d(a));else if("external"==a.geographyType)throw Error("Not implemented");
}}},toJson:function(){var c=this.inherited(arguments);c.analysisVariables=this.variables;this.returnGeometry&&(c.returnGeometry=!0);this.outSR&&(c.outSR=this.outSR.toJson());this.forStorage||(c.forStorage=!1);if(this.intersectingGeographies){c.intersectingGeographies=[];for(var b=0;b<this.intersectingGeographies.length;b++)c.intersectingGeographies.push(this.intersectingGeographies[b].toJson())}return c}})})},"esri/tasks/geoenrichment/EnrichParametersBase":function(){define(["../../declare","../../SpatialReference",
"./StudyAreaOptions","./studyAreaFromJson","./studyAreaOptionsFromJson"],function(h,f,e,d,c){return h("esri.tasks.geoenrichment.EnrichParametersBase",null,{studyAreaOptions:null,studyAreas:null,countryID:null,datasetID:null,constructor:function(b){this.studyAreas=[];if(b){if(b.studyAreas){var a;b.inSR&&(a=b.inSR);for(var g=b.studyAreas,h=0;h<g.length;h++){var l=d(g[h]);a&&l.geometry&&l.geometry.setSpatialReference(new f(a));this.studyAreas.push(l)}}b.studyAreasOptions?this.studyAreaOptions=c(b.studyAreasOptions):
b.studyAreaOptions&&(this.studyAreaOptions=b.studyAreaOptions instanceof e?b.studyAreaOptions:c(b.studyAreaOptions));(a=b.useData)?(a.sourceCountry&&(this.countryID=a.sourceCountry),a.dataset&&(this.datasetID=a.dataset)):(b.countryID&&(this.countryID=b.countryID),b.datasetID&&(this.datasetID=b.datasetID))}},toJson:function(){for(var b={},a=[],c=0;c<this.studyAreas.length;c++)a.push(this.studyAreas[c].toJson());0<a.length&&(b.studyAreas=a);this.studyAreaOptions&&(b.studyAreasOptions=this.studyAreaOptions.toJson());
if(this.countryID||this.datasetID)a={},this.countryID&&(a.sourceCountry=this.countryID),this.datasetID&&(a.dataset=this.datasetID),b.useData=a;return b}})})},"esri/tasks/geoenrichment/studyAreaFromJson":function(){define(["./GeometryStudyArea","./AddressStudyArea","./StandardGeographyStudyArea","../../extend"],function(h,f,e,d){var c=function(b){if(b.geometry)return new h(b);if(b.address)return new f(b);if(b.layer)return new e(b)};d("esri.tasks.geoenrichment.studyAreaFromJson",c);return c})},"esri/tasks/geoenrichment/GeometryStudyArea":function(){define(["../../declare",
"../../geometry/jsonUtils","../../geometry/Geometry","./StudyArea"],function(h,f,e,d){return h("esri.tasks.geoenrichment.GeometryStudyArea",[d],{geometry:null,constructor:function(c){c&&c.geometry&&(this.geometry=c.geometry instanceof e?c.geometry:f.fromJson(c.geometry))},toJson:function(){var c=this.inherited(arguments);c.geometry=this.geometry.toJson();return c},getGeomType:function(){return this.geometry.type}})})},"esri/tasks/geoenrichment/StudyArea":function(){define(["../../declare","dojo/_base/lang",
"./StudyAreaOptions","./studyAreaOptionsFromJson","./GeographyLevel"],function(h,f,e,d,c){return h("esri.tasks.geoenrichment.StudyArea",null,{attributes:null,options:null,returnGeometry:!1,comparisonGeographyLevels:null,constructor:function(b){b&&(b.attributes&&(this.attributes=b.attributes),b.areaType?this.options=d(b):b.options instanceof e&&(this.options=b.options),b.returnGeometry&&(this.returnGeometry=!0),this.comparisonGeographyLevels=c.fromJsonArray(b.comparisonGeographyLevels||b.comparisonLevels));
this.comparisonGeographyLevels||(this.comparisonGeographyLevels=[])},toJson:function(){var b={};this.attributes&&(b.attributes=this.attributes);this.options&&f.mixin(b,this.options.toJson());this.returnGeometry&&(b.returnGeometry=!0);var a=c.toJsonArray(this.comparisonGeographyLevels);a&&(b.comparisonLevels=a);return b},getGeomType:function(){throw"Not implemented";}})})},"esri/tasks/geoenrichment/AddressStudyArea":function(){define(["../../declare","./StudyArea"],function(h,f){return h("esri.tasks.geoenrichment.AddressStudyArea",
[f],{address:null,constructor:function(e){e&&e.address&&(this.address=e.address)},toJson:function(){var e=this.inherited(arguments);e.address=this.address;return e},getGeomType:function(){return"point"}})})},"esri/tasks/geoenrichment/StandardGeographyStudyArea":function(){define(["../../declare","./StudyArea"],function(h,f){return h("esri.tasks.geoenrichment.StandardGeographyStudyArea",[f],{countryID:null,geographyLayerID:null,ids:null,constructor:function(e){if(e){var d=e.sourceCountry||e.countryID;
d&&(this.countryID=d);if(d=e.layer||e.geographyLayerID)this.geographyLayerID=d;e.ids&&(this.ids=e.ids)}},toJson:function(){var e=this.inherited(arguments);this.countryID&&(e.sourceCountry=this.countryID);this.geographyLayerID&&(e.layer=this.geographyLayerID);this.ids&&(e.ids=this.ids);return e},getGeomType:function(){return"polygon"}})})},"esri/tasks/geoenrichment/StandardIntersectingGeography":function(){define(["../../declare","./IntersectingGeography"],function(h,f){return h("esri.tasks.geoenrichment.StandardIntersectingGeography",
[f],{geographyLayerID:null,constructor:function(e){e&&(this.geographyLayerID=e.geographyLayer||e.geographyLayerID||null)},toJson:function(){var e=this.inherited(arguments);e.geographyType="standard";e.geographyLayer=this.geographyLayerID;return e}})})},"esri/tasks/geoenrichment/IntersectingGeography":function(){define(["../../declare"],function(h){return h("esri.tasks.geoenrichment.IntersectingGeography",null,{name:null,geometryType:"esriGeometryPoint",spatialRel:"esriSpatialRelIntersects",outFields:null,
constructor:function(f){f&&(this.name=f.name||null,this.outFields=f.outFields||null,f.intersectionInfo?(f.intersectionInfo.geometryType&&(this.geometryType=f.intersectionInfo.geometryType),f.intersectionInfo.spatialRel&&(this.spatialRel=f.intersectionInfo.spatialRel)):(f.geometryType&&(this.geometryType=f.geometryType),f.spatialRel&&(this.spatialRel=f.spatialRel)))},toJson:function(){return{name:this.name,outFields:this.outFields,intersectionInfo:{geometryType:this.geometryType,spatialRel:this.spatialRel}}}})})},
"esri/tasks/geoenrichment/ReportParameters":function(){define(["../../declare","./EnrichParametersBase"],function(h,f){return h("esri.tasks.geoenrichment.ReportParameters",[f],{reportID:null,format:"pdf",fields:null,constructor:function(e){e&&(this.reportID=e.report||e.reportID||null,this.format=e.format,this.fields=e.reportFields||e.fields||null)},toJson:function(){var e=this.inherited(arguments);this.reportID&&(e.report=this.reportID);this.format&&(e.format=this.format);this.fields&&(e.reportFields=
this.fields);return e}})})},"esri/dijit/geoenrichment/InfographicsOptionsItem":function(){define([],function(){return function(h,f){this.type=h;this.variables=f;this.index=this.title=null;this.isVisible=!0}})},"esri/dijit/geoenrichment/Geoenrichment":function(){define("esri/declare dojo/_base/lang dojo/on dojo/string esri/dijit/geoenrichment/promise/all esri/dijit/geoenrichment/when esri/graphic esri/geometry/jsonUtils esri/tasks/locator esri/tasks/FeatureSet esri/tasks/geoenrichment/GeoenrichmentTask esri/tasks/geoenrichment/EnrichParameters esri/tasks/geoenrichment/RingBuffer esri/tasks/geoenrichment/DriveBuffer esri/tasks/geoenrichment/GeographyLevel esri/tasks/geoenrichment/GeometryStudyArea esri/tasks/geoenrichment/AddressStudyArea esri/tasks/geoenrichment/studyAreaFromJson ./_Invoke ./config ./utils/ArrayUtil ./utils/StudyAreaKeyBuilder ./infographicUtils/bufferTitle ./infographicUtils/DataProvider".split(" "),
function(h,f,e,d,c,b,a,g,k,l,p,n,m,q,r,t,w,u,v,y,A,z,D,B){function G(a){a=z.studyAreaToJson(a);delete a.returnGeometry;delete a.comparisonLevels;delete a.attributes;return a=JSON.stringify(a)}var F=h(null,{_keys:null,_values:null,_capacity:5,constructor:function(a){this._keys=[];this._values={};a&&(this._capacity=a)},getValue:function(a){return this._values[a]},setValue:function(a,b){this._keys.push(a);this._values[a]=b;this._removeOverflow()},hasValue:function(a){return this._values.hasOwnProperty(a)},
_removeOverflow:function(){if(this._keys.length>this._capacity)for(var a=this._keys.splice(0,this._keys.length-this._capacity),b=0;b<a.length;b++)delete this._values[a[b]]},setCapacity:function(a){this._capacity=a;this._removeOverflow()},toJson:function(){var a={},b;for(b in this._values){var c=this._values[b];void 0===c||null===c||"number"==typeof c&&isNaN(c)||("string"==typeof c||"boolean"==typeof c||"number"==typeof c?a[b]=c:"object"==typeof c&&c.toJson&&(a[b]=c.toJson()))}return{keys:this._keys.slice(),
values:a,capacity:this._capacity}},fromJson:function(a,b){if(a){this._keys=a.keys;this._capacity=a.capacity;this._values={};for(var c in a.values)this._values[c]=b?b(a.values[c]):a.values[c]}}}),E=h(null,{_values:null,constructor:function(a){this._values=new F(a)},getValue:function(a){var b=this.keyToString(a);if(this._values.hasValue(b))return this._values.getValue(b);var c=this;return this.keyToValue(a).then(function(a){c._values.setValue(b,a);return a})},keyToString:function(a){return JSON.stringify(a)},
keyToValue:function(a){throw"Not implemented";},setCapacity:function(a){this._values.setCapacity(a)},toJson:function(){return this._values.toJson()},fromJson:function(a,b){a&&this._values.fromJson(a,b)}}),C=h([E],{keyToString:function(a){return JSON.stringify(a.toJson())},keyToValue:function(a){return(new k(y.locatorUrl)).locationToAddress(a).then(function(a){return d.substitute(y.addressFormat,a.address,function(a){return a||""})},function(a){return""})}}),I=h([E],{_countryValues:null,_geometries:null,
constructor:function(){this._countryValues=new F;this._geometries=new F(3)},keyToValue:function(a){var b=this,c=u(a.studyArea),d=c.returnGeometry,e,f;d&&(f=G(c),e=this._geometries.hasValue(f));var g=d&&!e,h=new p(y.server);h.token=y.token;for(var k=null,l=c.comparisonGeographyLevels.length-1;0<=l;l--)"Admin1"==c.comparisonGeographyLevels[l].layerID&&(k=c.comparisonGeographyLevels.splice(l,1)[0]);var m,q;k&&(m=JSON.stringify({variables:a.variables,country:a.country}),(q=this._countryValues.hasValue(m))||
c.comparisonGeographyLevels.push(k));l=new n;l.forStorage=!1;l.countryID=a.country;l.variables=a.variables;if(c.returnGeometry=g)l.outSR=c.geometry?c.geometry.spatialReference:a.outSR;l.studyAreas.push(c);return h.enrich(l).then(function(a){var c=a.featureSets[0].features;k&&(q?c.push(b._countryValues.getValue(m)):b._countryValues.setValue(m,c[c.length-1]));d&&(e?c[0].geometry=b._geometries.getValue(f):b._geometries.setValue(f,c[0].geometry));return a.featureSets[0]})},setCapacity:function(a){this.inherited(arguments);
this._countryValues.setCapacity(a)},toJson:function(){var a=this.inherited(arguments);a.countryValues=this._countryValues.toJson();a.geometries=this._geometries.toJson();return a},fromJson:function(b){b&&(this._countryValues.fromJson(b.countryValues,function(b){return new a(b)}),this._geometries.fromJson(b.geometries,function(a){return g.fromJson(a)}),this.inherited(arguments,[b,function(a){return new l(a)}]))}}),J=h([E],{metadata:null,_enrichCache:null,_addressCache:null,constructor:function(a){this._enrichCache=
new I(a);this._addressCache=new C(3)},keyToValue:function(a){var b=this,d=[],e=a.returnAddress;delete a.returnAddress;d.push(this._enrichCache.getValue(a));var f=u(a.studyArea);e&&d.push(this._addressCache.getValue(f.geometry));return c(d).then(function(a){var c=a[0],d=c.features[0];d.attributes[b.metadata.name]||(d.attributes[b.metadata.name]=D(f.getGeomType(),f.options),e?d.attributes[b.metadata.address]=a[1]:f instanceof w&&(d.attributes[b.metadata.address]=f.address.text));return c})},setCapacity:function(a){this.inherited(arguments);
this._enrichCache.setCapacity(a)},toJson:function(){var a=this.inherited(arguments);a.metadata=f.clone(this.metadata);a.enrichCache=this._enrichCache.toJson();a.addressCache=this._addressCache.toJson();return a},fromJson:function(a){a&&(this.metadata=a.metadata,this._enrichCache.fromJson(a.enrichCache),this._addressCache.fromJson(a.addressCache),this.inherited(arguments,[a,function(a){return new l(a)}]))}});return h("esri.dijit.geoenrichment.Geoenrichment",[B,v],{country:null,returnGeometry:!1,returnAddress:!1,
returnData:!0,studyArea:null,outSR:null,buffer:null,variables:null,levels:null,highestLevel:null,data:null,restartOnDone:!1,requests:null,started:!1,cache:null,constructor:function(){this.buffer=new m;this.cache=new J;this.cache.metadata=this.metadata},getData:function(){return this.data},getGeometry:function(){return this.data.features[0].geometry},isBusy:function(){return this.pendingInvoke("requestData")||this.requests||this.restartOnDone},setBuffer:function(a){this.buffer=a;this.invalidate()},
getBuffer:function(){return this.buffer},setStudyArea:function(a){this.studyArea=a;this.invalidate()},setVariables:function(a){A.arraysEqual(this.variables,a)||(this.variables=a,this.invalidateData())},setGeoLevels:function(a,b){A.arraysEqual(this.levels,a)&&this.highestLevel==b||(this.levels=a,this.highestLevel=b,this.invalidateData())},setReturnAddress:function(a){this.returnAddress!=a&&(this.returnAddress=a)&&this.invalidateData()},setCacheLimit:function(a){this.cache.setCapacity(a)},invalidateData:function(){this.data=
null;this.invalidate()},invalidate:function(){this.pendingInvoke("requestData")||(this.requests?this.restartOnDone=!0:(this.geometry=null,this.invoke("requestData")))},requestData:function(){if(this.studyArea&&this.variables&&this.buffer){this.requests=[];this.started||(e.emit(this,"start"),this.started=!0);var a,c=this.buffer;a=!1;if(this.studyArea instanceof t)switch(this.studyArea.geometry.type){case "point":a=this.returnAddress;break;case "polyline":this.buffer instanceof q&&(c=new m);break;case "polygon":c=
null}var d=f.clone(this.studyArea);!d.options&&c&&(d.options=c);if(this.levels)for(c=0;c<this.levels.length;c++)d.comparisonGeographyLevels.push(new r({layerID:this.levels[c]}));this.highestLevel&&d.comparisonGeographyLevels.push(new r({layerID:this.highestLevel}));d.returnGeometry=this.returnGeometry;a=b(this.cache.getValue({country:this.country,variables:this.variables,returnData:this.returnData,studyArea:z.studyAreaToJson(d),outSR:this.outSR,returnAddress:a}));this.requests.push(a);a.then(f.hitch(this,
this.handleResponse),f.hitch(this,this.handleError))}},stop:function(){this.restartOnDone=!1;this.cancelInvoke("requestData");if(this.requests)for(var a=this.requests.slice(0),b=0;b<a.length;b++)a[b].cancel()},handleResponse:function(a){try{this.data=a,this.data.features[0].attributes.isThisArea=!0,this.onDone(null)}catch(H){this.onDone(H)}},handleError:function(a){this.onDone(a)},onDone:function(a){this.requests=null;a?"CancelError"!==a.name&&(console.log(a),e.emit(this,"error",a)):e.emit(this,"data");
this.restartOnDone?(this.invalidate(),this.restartOnDone=!1):(e.emit(this,"end"),this.started=!1)}})})},"esri/tasks/locator":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has ../kernel ../request ../deferredUtils ./Task ./AddressCandidate".split(" "),function(h,f,e,d,c,b,a,g,k,l,p){h=h(l,{declaredClass:"esri.tasks.Locator",_eventMap:{"address-to-locations-complete":["addresses"],"addresses-to-locations-complete":["addresses"],"location-to-address-complete":["address"],
"suggest-locations-complete":["suggestions"]},constructor:function(a){this._geocodeHandler=f.hitch(this,this._geocodeHandler);this._geocodeAddressesHandler=f.hitch(this,this._geocodeAddressesHandler);this._reverseGeocodeHandler=f.hitch(this,this._reverseGeocodeHandler);this.registerConnectEvents()},outSpatialReference:null,setOutSpatialReference:function(a){this.outSpatialReference=a},_geocodeHandler:function(a,b,c,d,e){try{var f=a.candidates,g;b=[];var h,k=f.length,l=a.spatialReference,m;for(h=0;h<
k;h++){g=f[h];if(m=g.location)m.spatialReference=l;b[h]=new p(g)}this._successHandler([b],"onAddressToLocationsComplete",c,e)}catch(D){this._errorHandler(D,d,e)}},_geocodeAddressesHandler:function(a,b,c,d,e){try{var f=a.locations;b=[];var g,h=f.length,k=a.spatialReference,l;for(g=0;g<h;g++){if(l=f[g].location)l.spatialReference=k;b[g]=new p(f[g])}this._successHandler([b],"onAddressesToLocationsComplete",c,e)}catch(z){this._errorHandler(z,d,e)}},addressToLocations:function(a,b,e,h,l){var m,n,p,q,r,
t,D,B;a.address&&(h=e,e=b,b=a.outFields,l=a.searchExtent,B=a.countryCode,m=a.magicKey,n=a.distance,D=a.categories,a.location&&this.normalization&&(p=a.location.normalize()),q=a.locationType,r=a.maxLocations,t=a.forStorage,a=a.address);l&&(l=l.shiftCentralMeridian());var G=this.outSpatialReference;a=this._encode(f.mixin({},this._url.query,a,{f:"json",outSR:G&&c.toJson(G.toJson()),outFields:b&&b.join(",")||null,searchExtent:l&&c.toJson(l.toJson()),category:D&&D.join(",")||null,countryCode:B||null,magicKey:m||
null,distance:n||null,location:p||null,locationType:q||null,maxLocations:r||null,forStorage:t||null}));var F=this._geocodeHandler,E=this._errorHandler,C=new d(k._dfdCanceller);C._pendingDfd=g({url:this._url.path+"/findAddressCandidates",content:a,callbackParamName:"callback",load:function(a,b){F(a,b,e,h,C)},error:function(a){E(a,h,C)}});return C},suggestLocations:function(a){var b;b=new d(k._dfdCanceller);a.hasOwnProperty("location")&&this.normalization&&(a.location=a.location.normalize());a.searchExtent&&
(a.searchExtent=a.searchExtent.shiftCentralMeridian());a=this._encode(f.mixin({},this._url.query,{f:"json",text:a.text,maxSuggestions:a.maxSuggestions,searchExtent:a.searchExtent&&c.toJson(a.searchExtent.toJson()),category:a.categories&&a.categories.join(",")||null,countryCode:a.countryCode||null,location:a.location||null,distance:a.distance||null},{f:"json"}));a=g({url:this._url.path+"/suggest",content:a,callbackParamName:"callback"});b._pendingDfd=a;a.then(f.hitch(this,function(a){a=a.suggestions||
[];this.onSuggestLocationsComplete(a);b.resolve(a)}),f.hitch(this,function(a){this._errorHandler(a);b.reject(a)}));return b},addressesToLocations:function(a,b,h){var l=this.outSpatialReference,m=[],n=a.categories,p=a.locationType,q=a.countryCode;e.forEach(a.addresses,function(a,b){m.push({attributes:a})});a=this._encode(f.mixin({},this._url.query,{category:n&&n.join(",")||null,locationType:p||null,sourceCountry:q||null},{addresses:c.toJson({records:m})},{f:"json",outSR:l&&c.toJson(l.toJson())}));
var y=this._geocodeAddressesHandler,A=this._errorHandler,z=new d(k._dfdCanceller);z._pendingDfd=g({url:this._url.path+"/geocodeAddresses",content:a,callbackParamName:"callback",load:function(a,c){y(a,c,b,h,z)},error:function(a){A(a,h,z)}});return z},_reverseGeocodeHandler:function(a,b,c,d,e){try{var f=new p({address:a.address,location:a.location,score:100});this._successHandler([f],"onLocationToAddressComplete",c,e)}catch(u){this._errorHandler(u,d,e)}},locationToAddress:function(a,b,e,h){a&&this.normalization&&
(a=a.normalize());var l=this.outSpatialReference;a=this._encode(f.mixin({},this._url.query,{outSR:l&&c.toJson(l.toJson()),location:a&&c.toJson(a.toJson()),distance:b,f:"json"}));var m=this._reverseGeocodeHandler,n=this._errorHandler,p=new d(k._dfdCanceller);p._pendingDfd=g({url:this._url.path+"/reverseGeocode",content:a,callbackParamName:"callback",load:function(a,b){m(a,b,e,h,p)},error:function(a){n(a,h,p)}});return p},onSuggestLocationsComplete:function(){},onAddressToLocationsComplete:function(){},
onAddressesToLocationsComplete:function(){},onLocationToAddressComplete:function(){}});b("extend-esri")&&f.setObject("tasks.Locator",h,a);return h})},"esri/tasks/AddressCandidate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../geometry/Point"],function(h,f,e,d,c){h=h(null,{declaredClass:"esri.tasks.AddressCandidate",constructor:function(b){f.mixin(this,b);this.location=new c(this.location)}});e("extend-esri")&&f.setObject("tasks.AddressCandidate",h,d);return h})},
"esri/dijit/geoenrichment/_Invoke":function(){define(["esri/declare"],function(h){return h("esri.dijit.geoenrichment._Invoke",null,{_invokeTimeoutIDs:null,invoke:function(f,e){if(!this._invokeTimeoutIDs)this._invokeTimeoutIDs={};else if(this._invokeTimeoutIDs[f]){if(void 0===e)return;clearTimeout(this._invokeTimeoutIDs[f])}var d=this;this._invokeTimeoutIDs[f]=setTimeout(function(){d._invokeTimeoutIDs[f]=0;d[f]()},e||0)},pendingInvoke:function(f){return this._invokeTimeoutIDs?this._invokeTimeoutIDs[f]:
!1},cancelInvoke:function(f){if(this._invokeTimeoutIDs){var e=this._invokeTimeoutIDs[f];e&&(clearTimeout(e),this._invokeTimeoutIDs[f]=0)}}})})},"esri/dijit/geoenrichment/utils/StudyAreaKeyBuilder":function(){define([],function(){var h={studyAreaToJson:function(f){f=f.toJson();f.geometry&&(f.geometry.points?h._processPoints(f.geometry.points):f.geometry.paths?f.geometry.paths.forEach(h._processPoints):f.geometry.rings&&f.geometry.rings.forEach(h._processPoints));return f},_processPoints:function(f){f.forEach(function(e){e[0]=
parseFloat(e[0].toFixed(10));e[1]=parseFloat(e[1].toFixed(10))})}};return h})},"esri/dijit/geoenrichment/infographicUtils/bufferTitle":function(){define("dojo/string esri/tasks/geoenrichment/DriveBuffer esri/tasks/geoenrichment/IntersectingGeographies esri/tasks/geoenrichment/DriveUnits dojo/i18n!esri/nls/jsapi esri/extend".split(" "),function(h,f,e,d,c,b){function a(a,b){switch(a){case "polyline":return b instanceof f?h.substitute(c.lineBuffer[d.MILES],{radius:"1"}):h.substitute(c.lineBuffer[b&&
b.units||d.MILES],{radius:(b&&b.radii[0]||1).toString()});case "polygon":return c.polygon;default:return b instanceof f?h.substitute(c.pointDriveTime[b&&b.units||d.MILES],{radius:(b&&b.radii[0]||1).toString()}):b instanceof e?h.substitute(c.stdGeo,{level:b.geographyLevels[0].layerID}):h.substitute(c.pointRing[b&&b.units||d.MILES],{radius:(b&&b.radii[0]||1).toString()})}}c=c.geoenrichment.dijit.bufferTitle;b("esri.dijit.geoenrichment.bufferTitle",a);return a})},"esri/dijit/geoenrichment/infographicUtils/DataProvider":function(){define(["esri/declare",
"dojo/Evented"],function(h,f){return h([f],{metadata:null,constructor:function(){this.metadata={name:"StdGeographyName",address:"address"}},getData:function(){throw Error("Not implemented");}})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/ge/LocalGEInfographic":function(){define(["dojo/_base/declare","dojo/_base/lang","./LocalGEBase","../data/AreaDataUtil"],function(h,f,e,d){return h(e,{_fieldNameToFieldInfoCache:null,_variableIdToFieldInfoCache:null,constructor:function(c,
b,a,e,h){this._fieldNameToFieldInfoCache={};this._variableIdToFieldInfoCache={};c.fieldInfos.forEach(function(a){this._fieldNameToFieldInfoCache[a.name]=a;this._variableIdToFieldInfoCache[a.variableID]=a},this);var g=c.calcData.calculatorName;(this._skipThisArea=a&&1<b.length)?(a=d.combineAreaDataObjectCalculators(b,g,{removeDuplicates:!0}),h=a.thisAreas.map(function(a,b){a=f.mixin({},a);a.StdGeographyName=e[b];a.isThisArea=!0;return a}),b={},b[g]={data:h.shift(),comparisonLevels:h.concat(a.comparisonLevels)}):
b=b[h||0];this._initGE(c.calcData.variables,b,g)},_propulateAttributesFromAreaData:function(c,b){for(var a in b){var d=this._fieldNameToFieldInfoCache[a];d?c[d.variableID]=b[a]:c[a]=b[a]}},_createField:function(c,b){var a=this.inherited(arguments),d=this._variableIdToFieldInfoCache[c];d?(a.alias=d.alias,a.decimals=d.decimals,a.units=d.showPercent?"pct":d.showCurrency?"currency":a.units,a.type=d.type||a.type):a.noVariableField=!0;return a},_filterAttributeField:function(c){return!c.noVariableField}})})},
"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/ge/LocalGEBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/Evented dojo/on esri/graphic esri/tasks/FeatureSet ./_GEFilterSupport ../data/AreaDataUtil ../stdGeographies/StdGeographiesUtil esri/dijit/geoenrichment/ReportPlayer/countryConfig dojo/i18n!esri/nls/jsapi".split(" "),function(h,f,e,d,c,b,a,g,k,l,p){p=p.geoenrichment.dijit.ReportPlayer.ReportPlayer;return h([e,a],{metadata:{name:"StdGeographyName",address:"address"},
variables:null,data:null,_variableShortToFullNameCache:null,_areaData:null,_skipThisArea:!1,_initGE:function(a,b,c){this.variables=a||[];this._variableShortToFullNameCache={};this.variables.forEach(function(a){this._variableShortToFullNameCache[-1===a.indexOf(".")?a:a.substr(a.indexOf(".")+1)]=a},this);(a=b&&g.getAreaDataObjectCalculator(b,c))?this._areaData=[a.data].concat(a.comparisonLevels||[]):this._handleError(Error("Can't get calculator"))},setVariables:function(a){this.variables=a},_createFeatureSet:function(){var a=
new b,c=this._prepareFeatures();a.features=c;a.fields=this._prepareFields(c);this._prepareFieldAliases(a);return a},_prepareFeatures:function(){var a=[];if(!this._areaData)return a;for(var b=0;b<this._areaData.length;b++){var d={};this._propulateAttributesFromAreaData(d,this._areaData[b]);d.StdGeographyName=String(d.StdGeographyName||"");d.StdGeographyID=String(d.StdGeographyID||"");d.StdGeographyLevel=String(d.StdGeographyLevel||"");if(0!==b||this._skipThisArea){if(!d.StdGeographyName&&!d.StdGeographyID&&
!d.StdGeographyLevel){console.log("LocalGEBase.js can't add an unidentifiable geography.");continue}d.StdGeographyName=k.getAreaName(d)}else d.StdGeographyName=p.thisArea,d.isThisArea=!0;a.push(new c(null,null,d))}return a},_propulateAttributesFromAreaData:function(a,b){f.mixin(a,b)},_prepareFields:function(a){var b=[];if(!a.length)return b;a=a[0].attributes;for(var c in a)b.push(this._createField(c,a));return b},_stringAttrs:{StdGeographyName:1,StdGeographyID:1,StdGeographyLevel:1},_createField:function(a,
b){b=this._stringAttrs[a]||"string"===typeof b[a];return{name:a,alias:a,type:b?"esriFieldTypeString":"esriFieldTypeDouble",length:b?256:void 0,fullName:this._variableShortToFullNameCache[a],decimals:b?void 0:0,units:b?"other":"double",symbol:l.getCurrencySymbol()}},_prepareFieldAliases:function(a){a.fieldAliases={};a.fields.forEach(function(b){a.fieldAliases[b.name]=b.alias})},_handleError:function(a){setTimeout(function(){a&&d.emit(this,"error",a)}.bind(this))},isBusy:function(){return!1},setOutSR:function(){},
setGeoLevels:function(){},setStudyArea:function(){},stop:function(){}})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/ge/_GEFilterSupport":function(){define(["dojo/_base/declare","esri/tasks/FeatureSet","esri/dijit/geoenrichment/infographicUtils/formatVariable","esri/dijit/geoenrichment/utils/ObjectUtil"],function(h,f,e,d){return h(null,{_filterRanges:null,_alwaysAllowThisAreasWhenFiltering:!1,getData:function(c){this.data||(this.data=this._createFeatureSet());return c&&c.ignoreFilters?
this.data:this._filterRanges&&this._filterRanges.length&&this.data?this._filterData(this.data):this.data},_createFeatureSet:function(){},_filterData:function(c){var b=new f;b.fields=c.fields;b.fieldAliases=c.fieldAliases;b.features=c.features.filter(function(a){return this._alwaysAllowThisAreasWhenFiltering&&a.attributes.isThisArea?!0:!this._filterRanges.some(function(b){var c=a.attributes[b.fieldName];return c<b.min||c>b.max})},this);return b},_excludeMap:{StdGeographyName:1,StdGeographyID:1,StdGeographyLevel:1,
isThisArea:1},getAttributeFields:function(){var c=this.getData({ignoreFilters:!0});if(!c)return[];for(var c=c.fields,b=[],a=0;a<c.length;a++){var f=c[a];!this._excludeMap[f.name]&&this._filterAttributeField(f)&&b.push({name:f.name,label:f.alias,decimals:0<=f.decimals?f.decimals:void 0,type:f.type,formatFunction:function(a){return function(b){return-1===a.decimals?d.formatNumber(b):e(a,b)}}(f)})}return b},_filterAttributeField:function(c){return this.variables&&this.variables.length?"HouseholdsByIncome.*"===
this.variables[0]?0===c.name.indexOf("HIN"):"HouseholdIncomeCurrentYear.*"===this.variables[0]?0===c.name.indexOf("EHYHNI"):"Age.*"===this.variables[0]?0===c.name.indexOf("FEM")||0===c.name.indexOf("MAL")||0===c.name.indexOf("ECYP"):-1!==this.variables[0].indexOf("AVGHHSZ")?-1!==c.name.indexOf("AVGHHSZ"):"RaceAndEthnicity.*"===this.variables[0]?-1!==c.name.indexOf("_CY_"):!0:!0},getAllGeographyAttributes:function(c){c=this.getData(c);if(!c)return[];c=c.features;for(var b=[],a=0;a<c.length;a++){var d=
c[a].attributes;d.isThisArea||b.push(d)}return b},setFilterRanges:function(c,b){this._filterRanges=c;this._alwaysAllowThisAreasWhenFiltering=b&&b.ignoreThisAreas},collectFilterRangesStats:function(c){if(!this.getData())return null;c=c||{};var b=c.additionalAttributes||[],b=b.concat(c.excludeThisAreas?this.getAllGeographyAttributes({ignoreFilters:!0}):this.getData({ignoreFilters:!0}).features.map(function(a){return a.attributes})),a=[];this.getAttributeFields().forEach(function(c){if("esriFieldTypeString"!==
c.type){var d={fieldName:c.name,alias:c.label,min:Infinity,max:-Infinity,decimals:c.decimals,dataArray:[]};a.push(d);b.forEach(function(a){a=a[c.name];d.min=Math.min(d.min,a);d.max=Math.max(d.max,a);d.dataArray.push(a)})}});return{filterRanges:a,numAreasTotal:b.length}}})})},"esri/dijit/geoenrichment/infographicUtils/formatVariable":function(){define(["dojo/number"],function(h){return function(f,e){var d=f.decimals||0;switch(f.units){case "pct":return h.format(e/100,{places:d,type:"percent"});case "currency":return h.format(e,
{places:d,type:"currency",symbol:f.symbol||"$"});default:return"esriFieldTypeDouble"==f.type?h.format(e,{places:d}):e}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/stdGeographies/StdGeographiesUtil":function(){define(["esri/dijit/geoenrichment/ReportPlayer/countryConfig"],function(h){var f={US_STATES_IDS:{"01":"AL","02":"AK","03":"AS","04":"AZ","05":"AR","06":"CA","08":"CO","09":"CT",10:"DE",11:"DC",12:"FL",13:"GA",14:"GU",15:"HI",16:"ID",17:"IL",18:"IN",19:"IA",20:"KS",
21:"KY",22:"LA",23:"ME",24:"MD",25:"MA",26:"MI",27:"MN",28:"MS",29:"MO",30:"MT",31:"NE",32:"NV",33:"NH",34:"NJ",35:"NM",36:"NY",37:"NC",38:"ND",39:"OH",40:"OK",41:"OR",42:"PA",43:"PR",44:"RI",45:"SC",46:"SD",47:"TN",48:"TX",49:"UT",50:"VT",51:"VA",53:"WA",54:"WV",55:"WI",56:"WY"},CA_PROVINCE_IDS:{10:"NL",59:"BC",60:"YT",61:"NT",62:"NU",11:"PE",12:"NS",13:"NB",24:"QC",35:"ON",46:"MB",47:"SK",48:"AB"},BUILDER_DATA:{US_census:{"US.CD":"%name%, %state%","US.CSD":"%name%, %state%","US.Counties":"%name%, %state%",
"US.Places":"%city%, %state%","US.ZIP5":"%id% (%name%)"},CA_census:{"CAN.FSA":"%id% (%name%)","CAN.CD":"%name%, %province%"}},getAreaName:function(e){var d=h.getCountryID(),c=h.getHierarchyID();if(!d||!c)return e.StdGeographyName;var d=d+"_"+c,b=f.BUILDER_DATA[d];b||(c=h.getGeographiesModel(),b=f.BUILDER_DATA[d]={},c.getLevels(!0).forEach(function(a){b[a.id.toUpperCase()]="%id% (%name%)"}));return f.buildDescription(e.StdGeographyID,e.StdGeographyName,e.StdGeographyLevel,b)},buildDescription:function(e,
d,c,b){b=b&&b[c.toUpperCase()];d=d||e;return"%id% (%name%)"===b&&0<=d.indexOf(e)?d:b?b.replace(/%(\w+)%/g,function(a,b){return f._buildDescriptionPart(a,b,e,d,c)}):d},_buildDescriptionPart:function(e,d,c,b,a){try{a.substr(0,a.indexOf(".")).toLowerCase();var g=f["_build_"+d];return g&&g(c,b)}catch(k){}return e},_build_id:function(e,d){return e},_build_name:function(e,d){return d},_build_city:function(e,d){return d.replace(/(\s|^)(\w)/g,function(c,b,a){return b+a.toUpperCase()})},_build_state:function(e,
d){return(e=e&&2<=e.length?f.US_STATES_IDS[e.substr(0,2)]:null)?e:"??"},_build_province:function(e,d){return(e=e&&2<=e.length?f.CA_PROVINCE_IDS[e.substr(0,2)]:null)?e:"??"}};return f})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/DefaultAttachmentsStore":function(){define(["dojo/_base/declare","esri/dijit/geoenrichment/promise/all","esri/dijit/geoenrichment/when","./WebMapAttachmentStore"],function(h,f,e,d){return h(null,{supportsMultipleAreas:!0,_analysisAreas:null,
_currentAreaIndex:-1,_webMapStores:null,constructor:function(c){this._analysisAreas=c},initialize:function(){var c=this;this._webMapStores={};return f(this._analysisAreas.map(function(b,a){if(b=b.feature||b.location||b.additionalFeatures&&b.additionalFeatures[0])return(c._webMapStores[a]=new d(b)).initialize()})).then(function(){return c})},_callStoreMethod:function(c){var b=this._webMapStores[this._currentAreaIndex];return b?e(b[c](),function(a){return a?a.slice():[]}):[]},getImages:function(){return this._callStoreMethod("getImages")},
getAttributes:function(){return this._callStoreMethod("getAttributes")},getNotes:function(){return this._callStoreMethod("getNotes")},setCurrentAnalysisAreaIndex:function(c){this._currentAreaIndex=c}})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/WebMapAttachmentStore":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/when esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/AttributesUtil esri/dijit/geoenrichment/utils/requests/UniversalClient esri/dijit/geoenrichment/utils/ImageUtil ./AttachmentsUtil".split(" "),
function(h,f,e,d,c,b,a){var g={_cache:{},getThumbnail:function(a){this._cache[a.url]||(this._cache[a.url]=this._getDataURL(a));return this._cache[a.url]},_getDataURL:function(a){return 0===a.url.indexOf("data:")?a.url:c.request(a.url).then(function(c){return c&&c.Attachment&&b.base64DataToDataURL(c.Attachment,a.contentType)}).otherwise(function(){return null})}};return h(null,{supportsMultipleAreas:!1,_attachmentInfos:null,_feature:null,_fieldInfos:null,_attributes:null,constructor:function(a,b){this._feature=
a;this._attachmentInfos=b},initialize:function(){this._tryGetFieldInfosAndAttributes();return e(this._attachmentInfos||this._tryGetAttachmentInfos()).always(function(){return!!this._attachmentInfos}.bind(this))},_tryGetFieldInfosAndAttributes:function(){var a=this._feature.getLayer();this._fieldInfos=(a=this._feature.infoTemplate||a&&a.infoTemplate)&&a.info.fieldInfos||[];this._attributes=f.mixin({},this._feature.attributes)},_tryGetAttachmentInfos:function(){return e(a.getFeatureAttachmentInfos(this._feature),
function(a){this._attachmentInfos=a}.bind(this))},getImages:function(){return this._attachmentInfos?this._attachmentInfos.map(function(a){return{getThumbnail:function(){return g.getThumbnail(a)},getUrl:function(){return a.url}}}):[]},getAttributes:function(){return d.composeAttributesFromFieldInfos(this._fieldInfos,this._attributes)},getNotes:function(){return[]},setCurrentAnalysisAreaIndex:null})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/AttachmentsUtil":function(){define([],
function(){return{getFeatureAttachmentInfos:function(h){var f=h.getLayer();if(f&&f.hasAttachments&&f.queryAttachmentInfos&&f.objectIdField)return f.queryAttachmentInfos(h.attributes[f.objectIdField])}}})},"*noref":1}});
define("esri/dijit/geoenrichment/ReportPlayer/DataProviderGE","dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/promise/all esri/dijit/geoenrichment/when esri/kernel ./dataProvider/_CommandSupport ./dataProvider/_SerializationSupport ./dataProvider/_ServerSerializationSupport ./dataProvider/supportClasses/areas/AnalysisAreaUtil ./dataProvider/supportClasses/areas/AnalysisAreaJsonUtil ./dataProvider/supportClasses/areas/AreasPreprocessor ./dataProvider/supportClasses/CustomReportsManager ./dataProvider/supportClasses/TemplateJsonLoader ./dataProvider/supportClasses/ReportDataProcessor ./dataProvider/supportClasses/InfographicOptionsProvider ./dataProvider/supportClasses/GEUtil ./dataProvider/supportClasses/attachments/DefaultAttachmentsStore ./dataProvider/supportClasses/attachments/CustomAttachmentsStore ./dataProvider/supportClasses/PortalManager ./dataProvider/supportClasses/data/VariablesUtil ./dataProvider/commands/mapToImage/MapToURLUtil ./core/themes/ThemeLibrary ./core/themes/ReportThemes esri/dijit/geoenrichment/ReportPlayer/countryConfig esri/dijit/geoenrichment/utils/ProjectionUtil esri/dijit/geoenrichment/utils/UrlUtil".split(" "),function(h,
f,e,d,c,b,a,g,k,l,p,n,m,q,r,t,w,u,v,y,A,z,D,B,G,F){return h([b,a,g],{analysisAreasLimit:-1,cacheTemplates:!0,printMapTaskUrl:null,resetReportItemsCache:!0,_infographicOptionsProvider:null,constructor:function(a){f.mixin(this,a);this._infographicOptionsProvider=new r},_getAttachmentsStore:function(a){return(new w(a)).initialize()},getCustomReports:function(a){return n.getCustomReports(a)},_currentContext:null,getReportData:function(a,b){var c=this,g=b&&b.progressCallback||function(){},h=f.mixin({},
a);h.portalUrl=F.getPortalUrl(h.portalUrl);k.parseSites(h);B.reset();h.hierarchy||h.analysisAreas.some(function(a){if(a.geographies&&a.geographies[0].hierarchy)return h.hierarchy=a.geographies[0].hierarchy,!0});c.resetReportItemsCache&&n.resetCache();c._currentContext=h;h.analysisAreas=l.areasFromJson(h.analysisAreas);h.combinedAreasInfo=h.combinedAreasInfo&&l.combinedAreasInfoFromJson(h.combinedAreasInfo)||{};k.populateCombinedAreasInfo(h.combinedAreasInfo,h.analysisAreas);h.fieldData={specialTradeAreaCalculatorName:null,
runReportTaskIDs:null,metadata:{},areaData:[],errors:[],reportInfo:null};return e([d(n.tryFindReportIdByAlias(h),function(a){h.reportID=a||h.reportID}),this._discoverPortal(h),function(){return h.variables&&d(y.preprocessVariables(h.variables,h.portalUrl),function(a){h.variables=a})}()]).then(function(){return d(p.preprocessAreas(h,{analysisAreasLimit:c.analysisAreasLimit}),function(){g(.25);setTimeout(function(){c._onCreateReportStarted()});var a=h.attachmentsProvider?u(h.attachmentsProvider):c._getAttachmentsStore(h.analysisAreas),
b={initGE:t.initialize(),countryInfo:t.getCountryInfo(h.countryID),infographicOptions:c._infographicOptionsProvider.getInfographicOptions(h),attachmentsStore:a};h.reportID?(b.reportObject=n.getCustomReportByID(h),b.templateJsonInfo=m.getTemplateJsonByID(h,c.cacheTemplates),b.runReportResult=q.runReportAndGetData(h,a)):h.variables&&(b.reportObject=n.getFakeCustomReportByContext(h),b.templateJsonInfo=m.createTemplateJsonFromVariables(h),b.runReportResult=q.runReportFromVariables(h));return e(b).then(function(a){var b=
a.reportObject,c=a.infographicOptions,e=a.attachmentsStore,f=a.templateJsonInfo.templateJson,k=a.templateJsonInfo.templateVariableProvider,l=a.runReportResult;g(.75);if(!f||!b||!h.fieldData)return null;B.setCountry(a.countryInfo.country);B.setHierarchyID(h.hierarchy);B.setGeographiesModel(a.countryInfo.geographiesModels[B.getHierarchyID()]);f.theme||(f.theme=z.getReportThemeById(b.isGraphicReport?D.GRAPHIC:D.CLASSIC));var m={isMultiFeature:b.isMultiFeature&&1<h.analysisAreas.length,reportTitle:h.reportTitle||
b.title,templateJson:f,reportObject:b,fieldData:h.fieldData,analysisAreas:h.analysisAreas,combinedAreasInfo:h.combinedAreasInfo,reverseAnalysisAreasOnMap:h.reverseAnalysisAreasOnMap,infographicOptions:c,attachmentsStore:e,geClient:t.getClient(),templateVariableProvider:k,customLogo:h.customLogo,config:{portalUrl:h.portalUrl,geoenrichmentUrl:h.geoenrichmentUrl,geometryServiceUrl:h.geometryServiceUrl,printMapTaskUrl:h.printMapTaskUrl,countryID:h.countryID,hierarchy:h.hierarchy,reportID:h.reportID,variables:h.variables}};
return d(q.applyRunReportAndGetDataResults(l,m),function(){g(1);return m})})})})},_discoverPortal:function(a){var b=this;return v.getPortalInfo(a.portalUrl).then(function(d){a.geoenrichmentUrl=a.geoenrichmentUrl||d.portal.helperServices.geoenrichment.url;var e=c.id.findCredential(a.portalUrl),e=e&&e.token;t.setGeoenrichmentUrl(a.geoenrichmentUrl,e);b._infographicOptionsProvider.setServerUrl(a.geoenrichmentUrl,e);a.geometryServiceUrl=a.geometryServiceUrl||d.portal.helperServices.geometry.url;G.setGeometryServiceUrl(a.geometryServiceUrl);
a.printMapTaskUrl=a.printMapTaskUrl||d.portal.helperServices.printTask.url;A.setPrintMapTaskUrl(a.printMapTaskUrl)})},reportDataToSingleAreaReportData:function(a,b){var c=b.currentFeatureIndex||0,d=f.mixin({},a.fieldData);d.areaData=[d.areaData[c]];var e=[f.mixin({},a.analysisAreas[c])];p.removeGroupInfo(e);var g=a.infographicOptions&&this._infographicOptionsProvider.getInfographicOptionsFromJson(a.infographicOptions.toJsonAt(c)),h=a.attachmentsStore;return{isMultiFeature:!1,reportTitle:b.reportTitle,
templateJson:b.templateJson,reportObject:a.reportObject,fieldData:d,analysisAreas:e,combinedAreasInfo:null,reverseAnalysisAreasOnMap:!1,infographicOptions:g,attachmentsStore:h&&{getImages:function(){h.supportsMultipleAreas&&h.setCurrentAnalysisAreaIndex(c);return h.getImages()},getAttributes:function(){h.supportsMultipleAreas&&h.setCurrentAnalysisAreaIndex(c);return h.getAttributes()},getNotes:function(){h.supportsMultipleAreas&&h.setCurrentAnalysisAreaIndex(c);return h.getNotes()}},geClient:a.geClient,
templateVariableProvider:a.templateVariableProvider,config:a.config}},_getCurrentContext:function(){return this._currentContext},_onCreateReportStarted:function(){}})});