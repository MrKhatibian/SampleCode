// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.33/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/charts/utils/builder/round/_GaugeChartSeriesCalculator","../../ThemeCalculator ../../ChartTypes ../../ChartJsonUtil ../../ChartLineStyles ../../../../supportClasses/conditionalStyling/ConditionalStyleUtil ../../../../supportClasses/templateJsonUtils/fieldInfo/FieldInfoBuilder ../utils/ChartDataUtil ../utils/TooltipInfoBuilder esri/dijit/geoenrichment/utils/ColorUtil".split(" "),function(I,x,J,h,y,K,z,L,A){var M={calcLineStyle:function(e,g){return{color:A.getColorWithAlpha(g.outlineColor||
e,g.outlineOpacity),width:g.outlineThickness,style:h.toGFXValue(g.outlineStyle||h.SOLID)}}};return{calcSeries:function(e){var g=e.seriesItems,k=e.chartType,h=e.themeSettings,B=e.viewModel,b=e.visualProperties,C=e.currentFeatureIndex,D=[],n=g[0],E={name:"data",data:[]},l=[],p=0,F=0,q=1E6,r=-1E6,G,d=n.points;1===d.length&&(d=d.slice(),d.push(J.getGaugeOthersPoint()));if(x.isConditionalStylingSupported(k)&&b.conditionalStyling){var H=y.getStatistics(b.conditionalStyling);G=H&&z.getChartData({conditionalStats:H,
numPoints:d.length})}var N=K.isFieldInfoInPercentState(d[0].fieldInfo);d.forEach(function(a,c){1!==c?a=z.getPointValue({point:a,index:0,seriesIndex:0,maxValue:!1,chartType:k,visualProperties:b,viewModel:B,currentFeatureIndex:C,chartData:G}):(a=l[0],a=b.gaugeRangeMax?Math.max(0,b.gaugeRangeMax-a):N?Math.max(0,100-a):0);a=(l[c]=a)||0;p+=a;F+=Math.abs(a);q=Math.min(q,a);r=Math.max(r,a)});0===l[1]&&(d.length=1);var O=p/d.length,P=0>b.gaugeRangeMin||0>l[0];d.forEach(function(a,c){var m=1===c,t=l[c],u=
t||0,f;x.isConditionalStylingSupported(k)&&b.conditionalStyling&&(f=(f=y.getConditionalStyle(u,b.conditionalStyling))&&f.backgroundColor,m&&!b.gaugeConditionalStylingOthers&&(f=void 0));f=f||I.calcColorForPoint({point:a,seriesItem:n,pointIndex:c,isOthersPoint:m,seriesIndex:0,numSeries:g.length,chartType:k,themeSettings:h});var v=M.calcLineStyle(f,b);f=1>b.fillOpacity?A.getColorWithAlpha(f,b.fillOpacity):f;var w=u;m||b.gaugeRangeMin&&(w=Math.max(0,w-b.gaugeRangeMin));c={originalValue:t,x:1,y:Math.max(1E-4,
w),isUnavailableData:isNaN(t),valueProp:"y",unsortedIndex:c,name:a.label,point:a,fill:f,fieldInfo:d[0].fieldInfo,seriesIndex:0,isOthersPoint:m,stroke:{color:v.color,width:v.width,style:v.style}};a=L.getTooltipInfo({yValue:u,pointLabel:a.label,seriesLabel:null,minInSeriesValue:q,maxInSeriesValue:r,sumInSeriesValue:p,absSumInSeriesValue:F,avgInSeriesValue:O,visualProperties:b,chartType:k,conditionalStyling:b.conditionalStyling,fieldInfo:d[0].fieldInfo,decimals:a.value&&a.value.decimals,hasNegativeValues:P,
fill:c.fill,stroke:0<c.stroke.width?c.stroke.color:void 0,chartContainer:e.chartContainer,viewModel:B,theme:e.theme,themeSettings:h,dataDrillingPanelInfo:e.dataDrillingPanelInfo,pointName:a.label,seriesName:n.label,areaName:null,featureIndex:C,isComparisonPoint:!1,comparisonFeatureAttribute:null});c.tooltip=a;E.data.push(c)});D.push(E);return D}}});