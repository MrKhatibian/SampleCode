// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.33/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/infographics/simpleInfographic/SimpleInfographicWithDataDrilling","dojo/_base/declare esri/dijit/geoenrichment/when dojo/on dojo/dom-class esri/dijit/geoenrichment/utils/DeviceUtil esri/dijit/geoenrichment/utils/TooltipUtil ../../grid/coreUtils/GridDataUtil ../utils/InfographicJsonUtil ./SimpleInfographic ./SimpleInfographicViewModes ../../dataDrilling/DataDrillingVisualizer ../../dataDrilling/DataDrillingButtonsBuilder ../../supportClasses/WidgetQueryUtil dojo/i18n!esri/nls/jsapi".split(" "),
function(k,l,m,n,p,q,r,t,u,d,v,w,x,y){return k(u,{allowDataDrilling:!0,ddVisualizer:null,ddButtonsBuilder:null,postCreate:function(){var a=this;this.inherited(arguments);p.isMobileDevice()&&this.own(m(window,"resize, orientationchange",function(){a._setViewMode({mode:d.VIEW_MAIN,showAnimation:!1})}));this.ddVisualizer=new v({viewModel:this.viewModel,theme:this.theme,parentWidget:this,currentFeatureIndex:this.currentFeatureIndex,domNode:this.domNode,closeZoomedDDWhenClickedOutside:!0,closeZoomedDDOnEsc:!0,
getInfographicJson:function(){return a._currentInfographicJson},onClose:function(){a._setViewMode({mode:d.VIEW_MAIN,showAnimation:!0})}});this.own(this.ddVisualizer);this.ddButtonsBuilder=new w({parentWidget:this});this._setViewMode({mode:d.VIEW_MAIN,skipVisualizer:!0})},_destroySections:function(){this.ddVisualizer.destroyContent();this.ddButtonsBuilder.destroyButtons();this.inherited(arguments)},_createSection:function(a,b,d,e,f,h,g){var c=this.inherited(arguments);this.allowDataDrilling&&this.viewModel.dynamicReportInfo&&
this.viewModel.enableDataDrilling&&!x.isDataDrillingView(this)&&g&&this._addDataDrillingHandlers(c,c.getTables()[g.variableIndex]);return c},_addDataDrillingHandlers:function(a,b){var c=this,e=r.getFieldInfo(b.getFirstCell()),f=(b=t.getDataDrilling(this._currentInfographicJson,e.templateName))&&b.sectionJson?b:null;f&&(n.add(this.domNode,"hasDataDrilling"),a.getTables().forEach(function(a){a.getFieldCells().forEach(function(a){q.setTooltipToNode(a.domNode,null)})}),this.ddButtonsBuilder.setDataDrillingButtonForSection(a,
function(a){c._setViewMode({mode:d.VIEW_DATA_DRILLING,showAnimation:!0,triggerButton:a,customSectionJson:f.sectionJson,fieldInfo:e})}))},_mode:null,_isAnimationRunning:!1,_setViewMode:function(a){var b=a.mode,c=a.showAnimation,e=a.triggerButton,f=a.customSectionJson,h=a.fieldInfo;a=a.skipVisualizer;if(this._mode!==b&&!this._isAnimationRunning){this._isAnimationRunning=!0;var g=b===d.VIEW_DATA_DRILLING;return l(!a&&this.ddVisualizer.play(g,c,e,f,h),function(){this._isAnimationRunning=!1;this._mode=
b;this.onViewModeChanged(b)}.bind(this))}},notifyPanelScaleChanged:function(a){this.ddButtonsBuilder.notifyPanelScaleChanged(a)},onViewModeChanged:function(a){}})});