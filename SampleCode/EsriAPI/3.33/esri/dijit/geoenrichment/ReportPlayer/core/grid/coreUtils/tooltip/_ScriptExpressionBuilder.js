// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.33/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/tooltip/_ScriptExpressionBuilder",["esri/dijit/geoenrichment/utils/ObjectUtil"],function(f){var h=/\s*/g,k=/(!.*?!|\+|\-|\*|\/|\(|\)|\^|\d+\.\d+|\d+)/g,e=/___.*?___/g,l=/___(.*?)___/g,m=/!/g,g=/\d+/;return{buildTooltipExpression:function(b,c){b=Array.isArray(b)?this._validateExpression(b,c):this._maskAndValidateExpressionText(b,c);if(!b||!b.length)return null;c="";for(var a=0,f=b.length;a<f;a++){var d=b[a],e=b[a+1];"*"!==d.operator&&
"/"!==d.operator||!e||"1"!==e.number?d.variableAlias?c+="\x3cdiv class\x3d'dijitInline'\x3e\x3cdiv class\x3d'esriGEAdjustableGrid_cellTooltip_expressionVariable'\x3e"+d.variableAlias+"\x3c/div\x3e\x3c/div\x3e":d.operator?c+="\x3cdiv class\x3d'dijitInline esriGEAdjustableGrid_cellTooltip_expressionOperator'\x3e"+d.operator+"\x3c/div\x3e":void 0!==d.number&&(c+="\x3cdiv class\x3d'dijitInline esriGEAdjustableGrid_cellTooltip_expressionNumber'\x3e"+d.number+"\x3c/div\x3e"):a++}return"\x3cdiv class\x3d'esriGEAdjustableGrid_cellTooltip_expression'\x3e"+
c+"\x3c/div\x3e"},_maskAndValidateExpressionText:function(b,c){b=b.replace(h,"");b=b.replace(k,"___$1___");return b.replace(e,"").length?null:b.match(e).map(function(a){a=a.replace(l,"$1");return 0===a.indexOf("!")?(a=c.get(a.replace(m,"")),{variableAlias:a&&a.alias||"N/A"}):a.match(g)?{number:f.formatNumber(Number(a))}:{operator:a}})},_validateExpression:function(b,c){return b.map(function(a){return a.variable?(a=c.get(a.variable.fullName),{variableAlias:a&&a.alias||"N/A"}):"number"===typeof a.name||
"string"===typeof a.name&&a.name.match(g)?{number:f.formatNumber(Number(a.name))}:{operator:a.name}})}}});