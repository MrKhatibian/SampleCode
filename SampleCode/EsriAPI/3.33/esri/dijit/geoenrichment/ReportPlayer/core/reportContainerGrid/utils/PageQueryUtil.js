// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.33/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/reportContainerGrid/utils/PageQueryUtil",["dojo/dom-geometry","../../../ReportPlayer","esri/dijit/geoenrichment/utils/ColorUtil","esri/dijit/geoenrichment/utils/DomUtil"],function(r,x,y,t){var w={getElementPageInfo:function(a){function d(a,k){a=r.position(a.domNode);k=r.position(k.domNode);c.x+=a.x-k.x;c.y+=a.y-k.y}function m(a){q||(a=a.getFullStyle().backgroundColor)&&!y.isTransparent(a)&&(q=a)}function g(b){if(b)if(b.parentGridCell&&m(b.parentGridCell),
b.parentElementInPageInfo)b=b.parentElementInPageInfo,e=b.reportContainer,q=q||b.panelBackgroundColor,c.x+=b.pos.x,c.y+=b.pos.y,n=b.pageGrid,l=b.gridContainer,p=b.pageIndex,h=b.layoutCell,u=b.isBackgroundFloatingPanel,k=b.isForegroundFloatingPanel,v=b.panelIndex;else{var f=b.parentWidget;f&&f.isReportContainerGrid?(e=f,b=w.getNodePositionOnPage(e,b.domNode),f=w.getNodePositionOnPage(e,a.domNode),b&&f&&(c.x+=b.x,c.y+=b.y,n=b.pageGrid,l=b.gridContainer,p=b.pageIndex,h=f.layoutCell,u=f.isBackgroundFloatingPanel,
k=f.isForegroundFloatingPanel,v=f.panelIndex)):(d(b,f),g(f))}}if(a&&a.parentWidget){var e,c={x:0,y:0},n,l,p,h,q,u,k,v;a.isValueField&&a.parentGrid&&a.rowId&&a.columnId?(m(a),d(a,a.parentGrid),g(a.parentGrid)):g(a);return e&&h?{reportContainer:e,documentOptions:e.documentOptions,pos:c,zoom:e.getZoomInfo().scale,pageGrid:n,gridContainer:l,pageIndex:p,layoutCell:h,panelBackgroundColor:q,isFloatingPanel:u||k,isBackgroundFloatingPanel:u,isForegroundFloatingPanel:k,panelIndex:v}:null}},getReportContainerPageNode:function(a){for(;a;){if(a.reportContainerPageNode)return a.reportContainerPageNode;
a=a.parentWidget||a.parentGrid}return null},getParentReportContainerGrid:function(a){if(a&&a.isReportContainerGrid)return a;for(;a;){if(a.parentWidget&&a.parentWidget.isReportContainerGrid)return a.parentWidget;if(a.parentElementInPageInfo)return a.parentElementInPageInfo.reportContainer;a=a.parentWidget||a.parentGrid}return null},getParentReportPlayer:function(a){if(a instanceof x)return a;for(;a;){if(a.parentWidget instanceof x)return a.parentWidget;a=a.parentWidget||a.parentGrid}return null},getNodePositionOnPage:function(a,
d){if(!d)return null;var m,g=-1,e,c,n,l;a.getGrids().some(function(a,h){if(a.domNode===d||t.isChildOf(d,a.domNode))return m=a,e=h,a.getFieldCells().some(function(a,c){if(a.domNode===d||t.isChildOf(d,a.domNode))return g=c,l=a,!0}),-1===g&&a.getBackgroundFloatingCells().some(function(a,e){if(a.domNode===d||t.isChildOf(d,a.domNode))return g=e,c=!0,l=a,!0}),-1===g&&a.getForegroundFloatingCells().some(function(a,c){if(a.domNode===d||t.isChildOf(d,a.domNode))return g=c,n=!0,l=a,!0}),!0});if(!m)return null;
a=a.getGridContainer(m);var p=r.position(a),h=r.position(d);return{x:h.x-p.x,y:h.y-p.y,pageGrid:m,gridContainer:a,pageIndex:e,layoutCell:l,isFloatingPanel:c||n,isBackgroundFloatingPanel:c,isForegroundFloatingPanel:n,panelIndex:g}}};return w});