// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.33/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/variables/PlayerVariableProvider",["dojo/_base/declare","dojo/_base/lang","dojo/string","dojo/i18n!esri/nls/jsapi"],function(c,h,g,e){e=e.geoenrichment.dijit.ReportPlayer.Variables;var k=c(null,{variable:null,constructor:function(a){this.variable=a},calculate:function(a){return 0},getCalcType:function(){return"n/"},getAliasWithType:function(){return this.variable.alias},getDescriptionWithType:function(){return this.variable.alias},
getDecimals:function(){return this.variable.precision||0}});return c(null,{isPlayerOnly:!0,_fieldNameToVariableCache:null,_templateNameToVariableCache:null,constructor:function(a){this._templateNameToVariableCache=a&&a.templateNameToVariableCache||{};this._fieldNameToVariableCache={};for(var b in this._templateNameToVariableCache)a=this._templateNameToVariableCache[b],this._fieldNameToVariableCache[a.fieldName]=a},get:function(a){return this._templateNameToVariableCache[a]||this._fieldNameToVariableCache[a]},
toCalculator:function(a){return(a=this.get(a))&&new k(a)},addVariable:function(a){this._fieldNameToVariableCache[a.fieldName]=a;this._templateNameToVariableCache[a.templateName]=a},addScriptVariable:function(a){this._fieldNameToVariableCache[a.fieldName]=a;this._templateNameToVariableCache[a.templateName]=a},getVariables:function(){return Object.keys(this._fieldNameToVariableCache).map(function(a){return this._fieldNameToVariableCache[a]},this)},getVariablesDataVintageDescription:function(a){var b=
{},f={},c={};this.getVariables().forEach(function(a){a.fullName&&(c[a.fullName.toLowerCase()]=a)});for(var d in a.usedVariablesCache)if(a=c[d.toLowerCase()])a.vintage&&(f[a.vintage]=1),a.source&&(b[a.source]=1);if(!Object.keys(b).length&&!Object.keys(f).length)return"";d=[];Object.keys(b).length&&d.push(g.substitute(e.sourcePattern,{source:Object.keys(b).join(", ")}));Object.keys(f).length&&d.push(g.substitute(e.vintagePattern,{vintage:Object.keys(f).join(", ")}));return d.join(" ")},toJson:function(){return{templateNameToVariableCache:h.clone(this._templateNameToVariableCache)}}})});