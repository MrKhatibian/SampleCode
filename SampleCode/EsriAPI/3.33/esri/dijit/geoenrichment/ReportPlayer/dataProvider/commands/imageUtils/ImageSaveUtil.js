// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.33/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/dataProvider/commands/imageUtils/ImageSaveUtil","esri/dijit/geoenrichment/when esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/utils/FileUtil esri/dijit/geoenrichment/utils/DataUtil esri/dijit/geoenrichment/utils/ImageUtil esri/dijit/geoenrichment/utils/async/AsyncQueue".split(" "),function(c,m,n,h,p,k){return{saveImages:function(e,b){if(e&&e.length){var q=1<e.length,f=0,d=[],a=new m,g={};c(k.executeFunctions(e.map(function(a){return function(){var l=
p.base64DataFromDataURL(a.dataURL||a),c=h.binaryStringToByteArray(atob(l)).buffer;d.push({name:function(){var a=b.reportTitle;q&&(a+="_"+b.analysisAreas[Math.floor(f/b.numPages)].name+"_Page "+(f%b.numPages+1),g[a]?a+=" ("+ ++g[a]+")":g[a]=1);return a+".png"}(),data:h.arrayBuffersToBlob([c],"image/png"),base64Data:l});f++}}),0),function(){1===d.length&&b.saveImageFunc?c(b.saveImageFunc(d[0]),a.resolve,a.reject):1<d.length&&b.saveMultipleImagesFunc?c(b.saveMultipleImagesFunc(d),a.resolve,a.reject):
c(k.executeFunctions(d.map(function(a){return function(){if(!b.skipSavingFile){var c=1===d.length&&b.fileName||a.name;return b.confirmSaveFile(c,function(){n.saveAs(a.data,c)})}}}),100),function(){a.resolve(d)},a.reject)});return a.promise}}}});