// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.33/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/AttachmentsStoreSerializer","esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all ./AttributesUtil ./NotesUtil ./CustomAttachmentsStore esri/dijit/geoenrichment/utils/ImageInfoUtil".split(" "),function(e,f,r,t,d,m){return{getAttachmentsStoreJson:function(a,g){function n(c){if(g.noCache)return c;b=b||{};for(var a in b)if(b[a]===c)return a;a="image_"+d++;b[a]=c;return a}function p(){return f([g.saveImages&&
a.getImages(),a.getAttributes(),a.getNotes()]).then(function(a){var c=a[0]||[],b=a[1]||[],d=a[2]||[];return f(c.map(function(a){return f([e(a.getThumbnail(),function(a){return m.ensureDataUrlForRemoveImage(a)}),e(a.getUrl(),function(a){return m.ensureDataUrlForRemoveImage(a)})]).then(function(q){a.__thumbnail=n(q[0]);a.__url=n(q[1])})})).then(function(){return{images:c.map(function(a){var c=a.__thumbnail,b=a.__url;delete a.__thumbnail;delete a.__url;return{description:a.description,thumbnail:c,url:b,
filename:a.filename,imageViewType:a.imageViewType}}),attributes:b.map(function(a){return r.attributeToJson(a)}),notes:d.map(function(a){return t.noteToJson(a)})}})})}if(!a)return null;var d=0,b,h=[],k=[];if(a.supportsMultipleAreas)for(var l=0;l<g.numAreas;l++)a.setCurrentAnalysisAreaIndex(l),k.push(e(p(),function(a){h.push(a)}));else k.push(e(p(),function(a){h.push(a)}));return f(k).then(function(){return{supportsMultipleAreas:a.supportsMultipleAreas,areaAttachments:h,imageDataCache:b}})},getAttachmentsStoreFromJson:function(a){return a&&
new d(a)}}});